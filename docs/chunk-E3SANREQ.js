import{b as we,d as be}from"./chunk-NDD7MLKR.js";import{a as Ie,b as Pe,c as Ce,d as Oe,e as Me,f as Ee,g as qe}from"./chunk-J267KXJP.js";import{b as De}from"./chunk-HLEASSE4.js";import{$ as v,Aa as Z,Ea as _e,Fb as ge,Gb as fe,Hb as ye,Ia as y,Ib as xe,J as H,Jb as he,Na as me,Oa as _,Pa as j,Qa as P,Ra as $,Rb as Se,Sa as r,Ta as a,Ua as D,Va as pe,Wa as ue,Xa as O,Ya as g,Za as c,_ as u,a as U,b as B,bb as ae,c as le,cb as l,db as q,eb as I,fb as T,gb as oe,hb as X,ib as ee,jb as te,l as R,nb as W,pb as G,qb as se,r as J,sb as ve,ua as Q,wa as o,x as re,y as de}from"./chunk-YEQZILZB.js";function $e(s,n){s&1&&(r(0,"p",23),l(1,"Loading Inventory..."),a())}function Ue(s,n){s&1&&(r(0,"p",23),l(1,"Loading Missing Parts..."),a())}function Fe(s,n){if(s&1&&(r(0,"div",17)(1,"div",18),D(2,"div",19),y(3,$e,2,0,"p",20)(4,Ue,2,0,"p",20),r(5,"p",21),l(6,"Loading large datasets may take a moment"),a(),r(7,"p",22),l(8,"Processing CSV files and building cache..."),a()()()),s&2){let e=c();o(3),_("ngIf",!e.isMissingPartsMode),o(),_("ngIf",e.isMissingPartsMode)}}function Ae(s,n){s&1&&(r(0,"div",24)(1,"h1",25),l(2,"Inventory Not Found"),a(),r(3,"p",26),l(4,"The inventory you're looking for does not exist or has been removed."),a(),r(5,"a",27),l(6," Back to Sets "),a()())}function Qe(s,n){s&1&&(r(0,"div",28)(1,"div",29)(2,"h1",30),l(3,"Missing Parts"),a(),r(4,"p",31),l(5,"You don't have any sets in your inventory yet."),a(),r(6,"a",27),l(7," Browse Sets "),a()()())}function je(s,n){s&1&&(r(0,"div",28)(1,"div",29)(2,"h1",30),l(3,"Missing Parts"),a(),r(4,"p",31),l(5,"You have all parts for your sets. Great job!"),a(),r(6,"a",27),l(7," View My Sets "),a()()())}function Be(s,n){if(s&1){let e=O();r(0,"div",54)(1,"div",55),g("click",function(){u(e);let i=c(3);return v(i.openImageOverlay((i.set==null?null:i.set.img_url)||"",(i.set==null?null:i.set.name)||"Set image"))}),r(2,"img",56),g("error",function(i){u(e);let d=c(3);return v(d.onImageError(i))}),a()(),r(3,"div",57)(4,"p",58),l(5," Image \xA9 "),r(6,"a",59),l(7,"Rebrickable"),a()()()()}if(s&2){let e=c(3);o(2),_("src",(e.set==null?null:e.set.img_url)||"",Q)("alt",(e.set==null?null:e.set.name)||"Set image")}}function Le(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(3);o(),I("Year: ",e.set==null?null:e.set.year,"")}}function ze(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(3);o(),I("Theme: ",e.theme==null?null:e.theme.name,"")}}function Ke(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(3);o(),I("Parts: ",e.set==null?null:e.set.num_parts,"")}}function Re(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(3);o(),I("Colors: ",e.uniqueColorsCount,"")}}function He(s,n){if(s&1&&(r(0,"div")(1,"div",60)(2,"span"),l(3,"Overall Progress"),a(),r(4,"span"),l(5),W(6,"number"),a()(),r(7,"div",61),D(8,"div",62),a()()),s&2){let e=c(3);o(5),oe("",e.totalPartsOwned+e.totalSparePartsOwned+e.totalMinifigsOwned," / ",e.totalPartsNeeded+e.totalSparePartsNeeded+e.totalMinifigsNeeded," items (",G(6,11,e.overallProgress,"1.1-1"),"%)"),o(3),j("width",e.overallProgress,"%"),P("bg-green-500",e.overallProgress>=100)("bg-yellow-500",e.overallProgress>0&&e.overallProgress<100)("bg-red-500",e.overallProgress===0)}}function We(s,n){if(s&1&&(r(0,"div")(1,"div",64)(2,"span"),l(3,"Spare Parts Progress"),a(),r(4,"span"),l(5),W(6,"number"),a()(),r(7,"div",65),D(8,"div",66),a()()),s&2){let e=c(4);o(5),oe("",e.totalSparePartsOwned," / ",e.totalSparePartsNeeded," items (",e.totalSparePartsNeeded>0?e.totalSparePartsOwned/e.totalSparePartsNeeded*100:G(6,11,0,"1.1-1"),"%)"),o(3),j("width",e.totalSparePartsNeeded>0?e.totalSparePartsOwned/e.totalSparePartsNeeded*100:0,"%"),P("bg-green-400",e.totalSparePartsOwned>=e.totalSparePartsNeeded)("bg-yellow-400",e.totalSparePartsOwned>0&&e.totalSparePartsOwned<e.totalSparePartsNeeded)("bg-red-400",e.totalSparePartsOwned===0)}}function Ge(s,n){if(s&1&&(r(0,"div")(1,"div",63)(2,"div")(3,"div",60)(4,"span"),l(5,"Main Progress (Parts + Minifigures)"),a(),r(6,"span"),l(7),W(8,"number"),a()(),r(9,"div",61),D(10,"div",62),a()(),y(11,We,9,14,"div",39),a()()),s&2){let e=c(3);o(7),oe("",e.totalPartsOwned+e.totalMinifigsOwned," / ",e.totalPartsNeeded+e.totalMinifigsNeeded," items (",G(8,12,e.overallProgress,"1.1-1"),"%)"),o(3),j("width",e.overallProgress,"%"),P("bg-green-500",e.overallProgress>=100)("bg-yellow-500",e.overallProgress>0&&e.overallProgress<100)("bg-red-500",e.overallProgress===0),o(),_("ngIf",e.totalSparePartsNeeded>0)}}function Ye(s,n){if(s&1&&(r(0,"div",41)(1,"div",42),y(2,Be,8,2,"div",43),r(3,"div",44)(4,"h1",45),l(5),a(),r(6,"p",46),l(7),a(),r(8,"p",46),l(9),a(),r(10,"div",47),y(11,Le,2,1,"span",39)(12,ze,2,1,"span",39)(13,Ke,2,1,"span",39)(14,Re,2,1,"span",39),a(),r(15,"p",48),l(16),W(17,"date"),a(),r(18,"div",49),y(19,He,9,14,"div",39)(20,Ge,12,15,"div",39),a()()(),r(21,"div",50)(22,"a",51)(23,"span",52),l(24,"\u{1F517}"),a(),l(25," View on Rebrickable "),a(),r(26,"a",53),l(27,"Back to Sets"),a()()()),s&2){let e=c(2);o(2),_("ngIf",e.set==null?null:e.set.img_url),o(3),q(e.userInventory==null?null:e.userInventory.name),o(2),I("Set #: ",e.userInventory==null?null:e.userInventory.set_num,""),o(2),I("Version: ",e.userInventory==null?null:e.userInventory.version,""),o(2),_("ngIf",e.set==null?null:e.set.year),o(),_("ngIf",e.theme==null?null:e.theme.name),o(),_("ngIf",e.set==null?null:e.set.num_parts),o(),_("ngIf",e.uniqueColorsCount>0),o(2),I("Last updated: ",G(17,12,e.userInventory==null?null:e.userInventory.lastUpdated,"medium"),""),o(3),_("ngIf",e.globalSettings.includeSparePartsInProgress),o(),_("ngIf",!e.globalSettings.includeSparePartsInProgress),o(2),_("href","https://rebrickable.com/sets/"+(e.userInventory==null?null:e.userInventory.set_num),Q)}}function Je(s,n){if(s&1&&(r(0,"div",67)(1,"div",68)(2,"div",44)(3,"h1",69),l(4,"Missing Parts"),a(),r(5,"p",70),l(6,"Track which parts and minifigures you still need for your building block sets"),a(),r(7,"p",71),l(8),a()(),r(9,"div",72)(10,"a",53),l(11,"Back to Sets"),a()()()()),s&2){let e=c(2);o(8),T("Showing missing items from ",e.userInventories.length," set",e.userInventories.length!==1?"s":"","")}}function Ze(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(2);o(),T("Parts (",e.totalPartsOwned,"/",e.totalPartsNeeded,")")}}function Xe(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(2);o(),I("Missing Parts (",e.parts.length,")")}}function et(s,n){if(s&1&&(r(0,"span",73),l(1),a()),s&2){let e=c(2);o(),I("",e.missingPartsCount," missing")}}function tt(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(2);o(),T("Spare Parts (",e.totalSparePartsOwned,"/",e.totalSparePartsNeeded,")")}}function it(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(2);o(),I("Missing Spare Parts (",e.spareParts.length,")")}}function nt(s,n){if(s&1&&(r(0,"span",73),l(1),a()),s&2){let e=c(2);o(),I("",e.missingSparePartsCount," missing")}}function rt(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(2);o(),T("Minifigures (",e.getTotalMinifigPartsProgress().owned,"/",e.getTotalMinifigPartsProgress().total,")")}}function at(s,n){if(s&1&&(r(0,"span"),l(1),a()),s&2){let e=c(2);o(),I("Missing Minifigures (",e.minifigs.length,")")}}function ot(s,n){if(s&1&&(r(0,"span",73),l(1),a()),s&2){let e=c(2);o(),I("",e.getTotalMinifigPartsProgress().missing," parts missing")}}function st(s,n){if(s&1&&(r(0,"option",101),l(1),a()),s&2){let e=n.$implicit,t=c().index,i=c(4);_("value",e.value)("disabled",i.isFieldDisabled("parts",e.value,t)),o(),I(" ",e.label," ")}}function lt(s,n){if(s&1){let e=O();r(0,"button",102),g("click",function(){u(e);let i=c().index,d=c(4);return v(d.removeSortOption("parts",i))}),l(1," \u2715 "),a()}}function dt(s,n){if(s&1){let e=O();r(0,"div",93)(1,"span",94),l(2),a(),r(3,"select",95),te("ngModelChange",function(i){let d=u(e).$implicit;return ee(d.field,i)||(d.field=i),v(i)}),g("ngModelChange",function(i){let d=u(e),m=d.$implicit,p=d.index,f=c(4);return v(f.updateSortOption("parts",p,i,m.direction))}),y(4,st,2,3,"option",96),a(),r(5,"select",97),g("change",function(i){let d=u(e),m=d.$implicit,p=d.index,f=c(4);return v(f.updateSortOption("parts",p,m.field,i.target.value))}),r(6,"option",98),l(7,"Ascending"),a(),r(8,"option",99),l(9,"Descending"),a()(),y(10,lt,2,0,"button",100),a()}if(s&2){let e=n.$implicit,t=n.index,i=c(4);o(2),I("",t+1,"."),o(),X("ngModel",e.field),o(),_("ngForOf",i.getAllFieldsForDropdown("parts")),o(),_("value",e.direction),o(5),_("ngIf",i.partsSortOptions.length>1)}}function ct(s,n){if(s&1){let e=O();r(0,"div",103)(1,"button",104),g("click",function(){u(e);let i=c(4);return v(i.addSortOption("parts"))}),l(2," + Add Sort Criteria "),a()()}}function _t(s,n){if(s&1){let e=O();r(0,"div",84)(1,"div",85)(2,"h3",86),l(3,"Sort Parts"),a(),r(4,"button",87),g("click",function(){u(e);let i=c(3);return v(i.resetToDefaultSort())}),l(5," Reset to Default "),a()(),r(6,"div",63),y(7,dt,11,5,"div",88)(8,ct,3,0,"div",89),a(),r(9,"div",90)(10,"button",91),g("click",function(){u(e);let i=c(3);return v(i.closeSortOptions())}),l(11," Cancel "),a(),r(12,"button",92),g("click",function(){u(e);let i=c(3);return v(i.applySortChanges())}),l(13," Apply Sort "),a()()()}if(s&2){let e=c(3);o(7),_("ngForOf",e.partsSortOptions),o(),_("ngIf",e.partsSortOptions.length<3)}}function mt(s,n){if(s&1&&(r(0,"p",114),l(1),a()),s&2){let e=c().$implicit;o(),I("Element ID: ",e.elementId,"")}}function pt(s,n){if(s&1&&(r(0,"p",128),l(1),a()),s&2){let e=c().$implicit;o(),T("From: ",e.setName," (",e.setNum,")")}}function ut(s,n){s&1&&(r(0,"span"),l(1,"\u2713 Complete"),a())}function vt(s,n){s&1&&(r(0,"span"),l(1,"\u26A0 Partial"),a())}function gt(s,n){s&1&&(r(0,"span"),l(1,"\u2717 Missing"),a())}function ft(s,n){if(s&1){let e=O();r(0,"div",109)(1,"div",110)(2,"div")(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),D(4,"img",112),a(),r(5,"div")(6,"h3",113),l(7),a(),r(8,"p",114),l(9),a(),r(10,"p",114),l(11),a(),y(12,mt,2,1,"p",115)(13,pt,2,2,"p",116),a()(),r(14,"div",117)(15,"div",60)(16,"span"),l(17,"Progress"),a(),r(18,"span"),l(19),a()(),r(20,"div",65),D(21,"div",66),a()(),r(22,"div",118)(23,"label",119),l(24,"Owned:"),a(),r(25,"div",120)(26,"button",121),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(27," - "),a(),r(28,"input",122),g("input",function(i){let d=u(e).$implicit,m=c(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(e),v(i.target.select())}),a(),r(29,"button",121),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(30," + "),a()(),r(31,"span",21),l(32),a()(),r(33,"div",123)(34,"button",124),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(35," \u2713 "),a(),r(36,"button",125),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,0))}),l(37," \u2717 "),a()(),r(38,"div",126)(39,"span",127),y(40,ut,2,0,"span",39)(41,vt,2,0,"span",39)(42,gt,2,0,"span",39),a()()()()}if(s&2){let e=n.$implicit,t=c(5);P("bg-green-50",e.quantityOwned>=e.quantityNeeded)("bg-yellow-50",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-50",e.quantityOwned===0),o(2),$(t.shouldUseVerticalLayout()?"flex flex-col items-center mb-4":"flex items-start mb-4"),o(),$(t.getImageSizeClasses()+(t.shouldUseVerticalLayout()?" mb-3 flex-shrink-0 cursor-pointer":" mr-4 flex-shrink-0 cursor-pointer")),o(),_("src",e.imageUrl,Q)("alt",e.part.name),o(),$(t.shouldUseVerticalLayout()?"flex-1 text-center":"flex-1"),o(2),q(e.part.name),o(2),I("Part #: ",e.part.part_num,""),o(2),I("Color: ",e.color.name,""),o(),_("ngIf",e.elementId),o(),_("ngIf",t.isMissingPartsMode&&e.setName),o(6),T("",e.quantityOwned," / ",e.quantityNeeded,""),o(2),j("width",e.quantityOwned/e.quantityNeeded*100,"%"),P("bg-green-500",e.quantityOwned>=e.quantityNeeded)("bg-yellow-500",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-500",e.quantityOwned===0),o(5),_("disabled",e.quantityOwned<=0),o(2),_("value",e.quantityOwned)("min",0)("max",e.quantityNeeded),o(),_("disabled",e.quantityOwned>=e.quantityNeeded),o(3),I("/ ",e.quantityNeeded,""),o(2),_("disabled",e.quantityOwned>=e.quantityNeeded),o(2),_("disabled",e.quantityOwned===0),o(3),P("text-green-600",e.quantityOwned>=e.quantityNeeded)("text-yellow-600",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("text-red-600",e.quantityOwned===0),o(),_("ngIf",e.quantityOwned>=e.quantityNeeded),o(),_("ngIf",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded),o(),_("ngIf",e.quantityOwned===0)}}function yt(s,n){if(s&1&&(r(0,"div",107),y(1,ft,43,46,"div",108),a()),s&2){let e=c(4);o(),_("ngForOf",e.filteredParts)("ngForTrackBy",e.trackByPartId)}}function xt(s,n){s&1&&(r(0,"th",136),l(1,"Set"),a())}function ht(s,n){if(s&1&&(r(0,"td",148)(1,"div",146),l(2),a()()),s&2){let e=c().$implicit;o(2),T("",e.setName," (",e.setNum,")")}}function wt(s,n){if(s&1){let e=O();r(0,"tr")(1,"td",141)(2,"div",142)(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),D(4,"img",112),a(),r(5,"div",143)(6,"div",144),l(7),a(),r(8,"div",21),l(9),a()()()(),r(10,"td",145)(11,"div",146),l(12),a()(),r(13,"td",145)(14,"div",146),l(15),a()(),y(16,ht,3,2,"td",147),r(17,"td",148)(18,"div",149),D(19,"div",150),a(),r(20,"div",151),l(21),a()(),r(22,"td",152)(23,"div",153)(24,"button",154),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(25," - "),a(),r(26,"input",155),g("input",function(i){let d=u(e).$implicit,m=c(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(e),v(i.target.select())}),a(),r(27,"button",154),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(28," + "),a()()(),r(29,"td",156)(30,"div",153)(31,"button",157),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(32," \u2713 "),a(),r(33,"button",158),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,0))}),l(34," \u2717 "),a()()()()}if(s&2){let e=n.$implicit,t=c(5);P("bg-green-50",e.quantityOwned>=e.quantityNeeded)("bg-yellow-50",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-50",e.quantityOwned===0),o(3),$(t.getListImageSizeClasses()+" mr-2 flex-shrink-0 cursor-pointer"),o(),_("src",e.imageUrl,Q)("alt",e.part.name),o(3),q(e.part.name),o(2),q(e.part.part_num),o(3),q(e.color.name),o(3),q(e.elementId),o(),_("ngIf",t.isMissingPartsMode),o(3),j("width",e.quantityOwned/e.quantityNeeded*100,"%"),P("bg-green-500",e.quantityOwned>=e.quantityNeeded)("bg-yellow-500",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-500",e.quantityOwned===0),o(2),T("",e.quantityOwned,"/",e.quantityNeeded," "),o(3),_("disabled",e.quantityOwned<=0),o(2),_("value",e.quantityOwned)("min",0)("max",e.quantityNeeded),o(),_("disabled",e.quantityOwned>=e.quantityNeeded),o(4),_("disabled",e.quantityOwned>=e.quantityNeeded),o(2),_("disabled",e.quantityOwned===0)}}function bt(s,n){if(s&1&&(r(0,"div",129)(1,"div",130)(2,"table",131)(3,"thead",132)(4,"tr")(5,"th",133),l(6,"Part "),a(),r(7,"th",134),l(8," Color"),a(),r(9,"th",134),l(10," Element ID"),a(),y(11,xt,2,0,"th",135),r(12,"th",136),l(13," Progress"),a(),r(14,"th",137),l(15," Quantity"),a(),r(16,"th",138),l(17," Actions"),a()()(),r(18,"tbody",139),y(19,wt,35,32,"tr",140),a()()()()),s&2){let e=c(4);o(11),_("ngIf",e.isMissingPartsMode),o(8),_("ngForOf",e.filteredParts)("ngForTrackBy",e.trackByPartId)}}function St(s,n){if(s&1&&(r(0,"div"),y(1,yt,2,2,"div",105)(2,bt,20,3,"div",106),a()),s&2){let e=c(3);o(),_("ngIf",e.partsViewType==="tiles"),o(),_("ngIf",e.partsViewType==="list")}}function It(s,n){if(s&1){let e=O();r(0,"button",162),g("click",function(){u(e);let i=c(4);return i.searchTerm="",v(i.filterParts())}),l(1," Clear Search "),a()}}function Pt(s,n){if(s&1&&(r(0,"div",159)(1,"p",160),l(2,"No parts found matching your search criteria."),a(),y(3,It,2,0,"button",161),a()),s&2){let e=c(3);o(3),_("ngIf",e.searchTerm)}}function Ct(s,n){if(s&1){let e=O();r(0,"div")(1,"div",74)(2,"div",44)(3,"input",75),te("ngModelChange",function(i){u(e);let d=c(2);return ee(d.searchTerm,i)||(d.searchTerm=i),v(i)}),g("ngModelChange",function(){u(e);let i=c(2);return v(i.filterParts())}),a()(),r(4,"div",76)(5,"div",77)(6,"button",78),g("click",function(){u(e);let i=c(2);return v(i.togglePartsView())}),r(7,"span",52),l(8,"\u229E"),a(),l(9," Tiles "),a(),r(10,"button",78),g("click",function(){u(e);let i=c(2);return v(i.togglePartsView())}),r(11,"span",52),l(12,"\u2630"),a(),l(13," List "),a()(),r(14,"button",79),g("click",function(){u(e);let i=c(2);return v(i.toggleSortOptions())}),r(15,"span",52),l(16,"\u2699\uFE0F"),a(),l(17," Sort "),a(),r(18,"button",80),g("click",function(){u(e);let i=c(2);return v(i.markAllPartsOwned(!0))}),l(19," Mark All Complete "),a(),r(20,"button",81),g("click",function(){u(e);let i=c(2);return v(i.markAllPartsOwned(!1))}),l(21," Mark All Missing "),a()()(),y(22,_t,14,2,"div",82)(23,St,3,2,"div",83)(24,Pt,4,1,"ng-template",null,0,se),a()}if(s&2){let e=ae(25),t=c(2);o(3),X("ngModel",t.searchTerm),o(3),P("bg-blue-600",t.partsViewType==="tiles")("text-white",t.partsViewType==="tiles")("bg-gray-200",t.partsViewType!=="tiles")("text-gray-700",t.partsViewType!=="tiles"),o(4),P("bg-blue-600",t.partsViewType==="list")("text-white",t.partsViewType==="list")("bg-gray-200",t.partsViewType!=="list")("text-gray-700",t.partsViewType!=="list"),o(12),_("ngIf",t.showPartsSortOptions),o(),_("ngIf",t.filteredParts.length>0)("ngIfElse",e)}}function Ot(s,n){if(s&1&&(r(0,"option",101),l(1),a()),s&2){let e=n.$implicit,t=c().index,i=c(4);_("value",e.value)("disabled",i.isFieldDisabled("spare-parts",e.value,t)),o(),I(" ",e.label," ")}}function Mt(s,n){if(s&1){let e=O();r(0,"button",102),g("click",function(){u(e);let i=c().index,d=c(4);return v(d.removeSortOption("spare-parts",i))}),l(1," \u2715 "),a()}}function Et(s,n){if(s&1){let e=O();r(0,"div",93)(1,"span",94),l(2),a(),r(3,"select",95),te("ngModelChange",function(i){let d=u(e).$implicit;return ee(d.field,i)||(d.field=i),v(i)}),g("ngModelChange",function(i){let d=u(e),m=d.$implicit,p=d.index,f=c(4);return v(f.updateSortOption("spare-parts",p,i,m.direction))}),y(4,Ot,2,3,"option",96),a(),r(5,"select",97),g("change",function(i){let d=u(e),m=d.$implicit,p=d.index,f=c(4);return v(f.updateSortOption("spare-parts",p,m.field,i.target.value))}),r(6,"option",98),l(7,"Ascending"),a(),r(8,"option",99),l(9,"Descending"),a()(),y(10,Mt,2,0,"button",100),a()}if(s&2){let e=n.$implicit,t=n.index,i=c(4);o(2),I("",t+1,"."),o(),X("ngModel",e.field),o(),_("ngForOf",i.getAllFieldsForDropdown("spare-parts")),o(),_("value",e.direction),o(5),_("ngIf",i.sparePartsSortOptions.length>1)}}function qt(s,n){if(s&1){let e=O();r(0,"div",103)(1,"button",104),g("click",function(){u(e);let i=c(4);return v(i.addSortOption("spare-parts"))}),l(2," + Add Sort Criteria "),a()()}}function Dt(s,n){if(s&1){let e=O();r(0,"div",84)(1,"div",85)(2,"h3",86),l(3,"Sort Spare Parts"),a(),r(4,"button",87),g("click",function(){u(e);let i=c(3);return v(i.resetToDefaultSort())}),l(5," Reset to Default "),a()(),r(6,"div",63),y(7,Et,11,5,"div",88)(8,qt,3,0,"div",89),a(),r(9,"div",90)(10,"button",91),g("click",function(){u(e);let i=c(3);return v(i.closeSortOptions())}),l(11," Cancel "),a(),r(12,"button",92),g("click",function(){u(e);let i=c(3);return v(i.applySortChanges())}),l(13," Apply Sort "),a()()()}if(s&2){let e=c(3);o(7),_("ngForOf",e.sparePartsSortOptions),o(),_("ngIf",e.sparePartsSortOptions.length<3)}}function Tt(s,n){if(s&1&&(r(0,"p",114),l(1),a()),s&2){let e=c().$implicit;o(),I("Element ID: ",e.elementId,"")}}function kt(s,n){s&1&&(r(0,"span"),l(1,"\u2713 Complete"),a())}function Vt(s,n){s&1&&(r(0,"span"),l(1,"\u26A0 Partial"),a())}function Nt(s,n){s&1&&(r(0,"span"),l(1,"\u2717 Missing"),a())}function $t(s,n){if(s&1){let e=O();r(0,"div",109)(1,"div",110)(2,"div")(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),D(4,"img",112),a(),r(5,"div")(6,"h3",113),l(7),a(),r(8,"p",114),l(9),a(),r(10,"p",114),l(11),a(),y(12,Tt,2,1,"p",115),r(13,"p",163),l(14,"Spare Part"),a()()(),r(15,"div",117)(16,"div",60)(17,"span"),l(18,"Progress"),a(),r(19,"span"),l(20),a()(),r(21,"div",65),D(22,"div",66),a()(),r(23,"div",118)(24,"label",119),l(25,"Owned:"),a(),r(26,"div",120)(27,"button",121),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(28," - "),a(),r(29,"input",122),g("input",function(i){let d=u(e).$implicit,m=c(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(e),v(i.target.select())}),a(),r(30,"button",121),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(31," + "),a()(),r(32,"span",21),l(33),a()(),r(34,"div",123)(35,"button",124),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(36," \u2713 "),a(),r(37,"button",125),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,0))}),l(38," \u2717 "),a()(),r(39,"div",126)(40,"span",127),y(41,kt,2,0,"span",39)(42,Vt,2,0,"span",39)(43,Nt,2,0,"span",39),a()()()()}if(s&2){let e=n.$implicit,t=c(5);P("bg-green-50",e.quantityOwned>=e.quantityNeeded)("bg-yellow-50",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-50",e.quantityOwned===0),o(2),$(t.shouldUseVerticalLayout()?"flex flex-col items-center mb-4":"flex items-start mb-4"),o(),$(t.getImageSizeClasses()+(t.shouldUseVerticalLayout()?" mb-3 flex-shrink-0 cursor-pointer":" mr-4 flex-shrink-0 cursor-pointer")),o(),_("src",e.imageUrl,Q)("alt",e.part.name),o(),$(t.shouldUseVerticalLayout()?"flex-1 text-center":"flex-1"),o(2),q(e.part.name),o(2),I("Part #: ",e.part.part_num,""),o(2),I("Color: ",e.color.name,""),o(),_("ngIf",e.elementId),o(8),T("",e.quantityOwned," / ",e.quantityNeeded,""),o(2),j("width",e.quantityOwned/e.quantityNeeded*100,"%"),P("bg-green-500",e.quantityOwned>=e.quantityNeeded)("bg-yellow-500",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-500",e.quantityOwned===0),o(5),_("disabled",e.quantityOwned<=0),o(2),_("value",e.quantityOwned)("min",0)("max",e.quantityNeeded),o(),_("disabled",e.quantityOwned>=e.quantityNeeded),o(3),I("/ ",e.quantityNeeded,""),o(2),_("disabled",e.quantityOwned>=e.quantityNeeded),o(2),_("disabled",e.quantityOwned===0),o(3),P("text-green-600",e.quantityOwned>=e.quantityNeeded)("text-yellow-600",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("text-red-600",e.quantityOwned===0),o(),_("ngIf",e.quantityOwned>=e.quantityNeeded),o(),_("ngIf",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded),o(),_("ngIf",e.quantityOwned===0)}}function Ut(s,n){if(s&1&&(r(0,"div",107),y(1,$t,44,45,"div",108),a()),s&2){let e=c(4);o(),_("ngForOf",e.spareParts)("ngForTrackBy",e.trackBySparePartId)}}function Ft(s,n){if(s&1){let e=O();r(0,"tr")(1,"td",141)(2,"div",142)(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),D(4,"img",112),a(),r(5,"div",143)(6,"div",144),l(7),a(),r(8,"div",21),l(9),a()()()(),r(10,"td",145)(11,"div",146),l(12),a()(),r(13,"td",145)(14,"div",146),l(15),a()(),r(16,"td",148)(17,"div",149),D(18,"div",150),a(),r(19,"div",151),l(20),a()(),r(21,"td",152)(22,"div",153)(23,"button",154),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(24," - "),a(),r(25,"input",155),g("input",function(i){let d=u(e).$implicit,m=c(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(e),v(i.target.select())}),a(),r(26,"button",154),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(27," + "),a()()(),r(28,"td",156)(29,"div",153)(30,"button",157),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(31," \u2713 "),a(),r(32,"button",158),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.updatePartQuantity(i,0))}),l(33," \u2717 "),a()()()()}if(s&2){let e=n.$implicit,t=c(5);P("bg-green-50",e.quantityOwned>=e.quantityNeeded)("bg-yellow-50",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-50",e.quantityOwned===0),o(3),$(t.getListImageSizeClasses()+" mr-2 flex-shrink-0 cursor-pointer"),o(),_("src",e.imageUrl,Q)("alt",e.part.name),o(3),q(e.part.name),o(2),q(e.part.part_num),o(3),q(e.color.name),o(3),q(e.elementId),o(3),j("width",e.quantityOwned/e.quantityNeeded*100,"%"),P("bg-green-500",e.quantityOwned>=e.quantityNeeded)("bg-yellow-500",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-500",e.quantityOwned===0),o(2),T("",e.quantityOwned,"/",e.quantityNeeded," "),o(3),_("disabled",e.quantityOwned<=0),o(2),_("value",e.quantityOwned)("min",0)("max",e.quantityNeeded),o(),_("disabled",e.quantityOwned>=e.quantityNeeded),o(4),_("disabled",e.quantityOwned>=e.quantityNeeded),o(2),_("disabled",e.quantityOwned===0)}}function At(s,n){if(s&1&&(r(0,"div",129)(1,"div",130)(2,"table",131)(3,"thead",132)(4,"tr")(5,"th",133),l(6,"Part "),a(),r(7,"th",134),l(8," Color"),a(),r(9,"th",134),l(10," Element ID"),a(),r(11,"th",136),l(12," Progress"),a(),r(13,"th",137),l(14," Quantity"),a(),r(15,"th",164),l(16," Actions"),a()()(),r(17,"tbody",139),y(18,Ft,34,31,"tr",140),a()()()()),s&2){let e=c(4);o(18),_("ngForOf",e.spareParts)("ngForTrackBy",e.trackBySparePartId)}}function Qt(s,n){if(s&1&&(r(0,"div"),y(1,Ut,2,2,"div",105)(2,At,19,2,"div",106),a()),s&2){let e=c(3);o(),_("ngIf",e.sparePartsViewType==="tiles"),o(),_("ngIf",e.sparePartsViewType==="list")}}function jt(s,n){s&1&&(r(0,"div",159)(1,"p",160),l(2,"No spare parts found for this set."),a()())}function Bt(s,n){if(s&1){let e=O();r(0,"div")(1,"div",74)(2,"div",44)(3,"h3",86),l(4),a()(),r(5,"div",76)(6,"div",77)(7,"button",78),g("click",function(){u(e);let i=c(2);return v(i.toggleSparePartsView())}),r(8,"span",52),l(9,"\u229E"),a(),l(10," Tiles "),a(),r(11,"button",78),g("click",function(){u(e);let i=c(2);return v(i.toggleSparePartsView())}),r(12,"span",52),l(13,"\u2630"),a(),l(14," List "),a()(),r(15,"button",79),g("click",function(){u(e);let i=c(2);return v(i.toggleSortOptions())}),r(16,"span",52),l(17,"\u2699\uFE0F"),a(),l(18," Sort "),a(),r(19,"button",80),g("click",function(){u(e);let i=c(2);return v(i.markAllSparePartsOwned(!0))}),l(20," Mark All Complete "),a(),r(21,"button",81),g("click",function(){u(e);let i=c(2);return v(i.markAllSparePartsOwned(!1))}),l(22," Mark All Missing "),a()()(),y(23,Dt,14,2,"div",82)(24,Qt,3,2,"div",83)(25,jt,3,0,"ng-template",null,1,se),a()}if(s&2){let e=ae(26),t=c(2);o(4),T("Spare Parts (",t.totalSparePartsOwned,"/",t.totalSparePartsNeeded,")"),o(3),P("bg-blue-600",t.sparePartsViewType==="tiles")("text-white",t.sparePartsViewType==="tiles")("bg-gray-200",t.sparePartsViewType!=="tiles")("text-gray-700",t.sparePartsViewType!=="tiles"),o(4),P("bg-blue-600",t.sparePartsViewType==="list")("text-white",t.sparePartsViewType==="list")("bg-gray-200",t.sparePartsViewType!=="list")("text-gray-700",t.sparePartsViewType!=="list"),o(12),_("ngIf",t.showSparePartsSortOptions),o(),_("ngIf",t.spareParts.length>0)("ngIfElse",e)}}function Lt(s,n){if(s&1&&(r(0,"option",101),l(1),a()),s&2){let e=n.$implicit,t=c().index,i=c(4);_("value",e.value)("disabled",i.isFieldDisabled("minifigs",e.value,t)),o(),I(" ",e.label," ")}}function zt(s,n){if(s&1){let e=O();r(0,"button",102),g("click",function(){u(e);let i=c().index,d=c(4);return v(d.removeSortOption("minifigs",i))}),l(1," \u2715 "),a()}}function Kt(s,n){if(s&1){let e=O();r(0,"div",93)(1,"span",94),l(2),a(),r(3,"select",95),te("ngModelChange",function(i){let d=u(e).$implicit;return ee(d.field,i)||(d.field=i),v(i)}),g("ngModelChange",function(i){let d=u(e),m=d.$implicit,p=d.index,f=c(4);return v(f.updateSortOption("minifigs",p,i,m.direction))}),y(4,Lt,2,3,"option",96),a(),r(5,"select",97),g("change",function(i){let d=u(e),m=d.$implicit,p=d.index,f=c(4);return v(f.updateSortOption("minifigs",p,m.field,i.target.value))}),r(6,"option",98),l(7,"Ascending"),a(),r(8,"option",99),l(9,"Descending"),a()(),y(10,zt,2,0,"button",100),a()}if(s&2){let e=n.$implicit,t=n.index,i=c(4);o(2),I("",t+1,"."),o(),X("ngModel",e.field),o(),_("ngForOf",i.getAllFieldsForDropdown("minifigs")),o(),_("value",e.direction),o(5),_("ngIf",i.minifigsSortOptions.length>1)}}function Rt(s,n){if(s&1){let e=O();r(0,"div",103)(1,"button",104),g("click",function(){u(e);let i=c(4);return v(i.addSortOption("minifigs"))}),l(2," + Add Sort Criteria "),a()()}}function Ht(s,n){if(s&1){let e=O();r(0,"div",84)(1,"div",85)(2,"h3",86),l(3,"Sort Minifigures"),a(),r(4,"button",87),g("click",function(){u(e);let i=c(3);return v(i.resetToDefaultSort())}),l(5," Reset to Default "),a()(),r(6,"div",63),y(7,Kt,11,5,"div",88)(8,Rt,3,0,"div",89),a(),r(9,"div",90)(10,"button",91),g("click",function(){u(e);let i=c(3);return v(i.closeSortOptions())}),l(11," Cancel "),a(),r(12,"button",92),g("click",function(){u(e);let i=c(3);return v(i.applySortChanges())}),l(13," Apply Sort "),a()()()}if(s&2){let e=c(3);o(7),_("ngForOf",e.minifigsSortOptions),o(),_("ngIf",e.minifigsSortOptions.length<3)}}function Wt(s,n){if(s&1&&(r(0,"p",128),l(1),a()),s&2){let e=c().$implicit;o(),T("From: ",e.setName," (",e.setNum,")")}}function Gt(s,n){s&1&&(r(0,"span"),l(1,"\u2713 Complete"),a())}function Yt(s,n){if(s&1&&(r(0,"span"),l(1),W(2,"number"),a()),s&2){let e=c().$implicit,t=c(5);o(),I("\u26A0 Partial (",G(2,1,t.getMinifigPartsProgress(e.minifig.fig_num).percentage,"1.0-0"),"%)")}}function Jt(s,n){s&1&&(r(0,"span"),l(1,"\u2717 Missing"),a())}function Zt(s,n){s&1&&(r(0,"span",52),l(1,"\u25B6"),a())}function Xt(s,n){s&1&&(r(0,"span",52),l(1,"\u25BC"),a())}function ei(s,n){s&1&&(r(0,"span"),l(1,"\u2713"),a())}function ti(s,n){s&1&&(r(0,"span"),l(1,"\u26A0"),a())}function ii(s,n){s&1&&(r(0,"span"),l(1,"\u2717"),a())}function ni(s,n){if(s&1){let e=O();r(0,"div",174)(1,"div",175)(2,"div",176)(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(7);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),D(4,"img",112),a(),r(5,"div",177)(6,"h5",178),l(7),a(),r(8,"p",179),l(9),a(),r(10,"p",179),l(11),a()()(),r(12,"div",180)(13,"div",181)(14,"span"),l(15,"Progress"),a(),r(16,"span"),l(17),a()(),r(18,"div",182),D(19,"div",150),a()(),r(20,"div",153)(21,"button",183),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned-1))}),l(22," - "),a(),r(23,"input",184),g("input",function(i){let d=u(e).$implicit,m=c(2).$implicit,p=c(5);return v(p.updateMinifigPartQuantity((p.userInventory==null?null:p.userInventory.set_num)||"",m.minifig.fig_num,d,+i.target.value))})("focus",function(i){return u(e),v(i.target.select())}),a(),r(24,"button",183),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned+1))}),l(25," + "),a()(),r(26,"div",185)(27,"span",186),y(28,ei,2,0,"span",39)(29,ti,2,0,"span",39)(30,ii,2,0,"span",39),a()(),r(31,"div",187)(32,"button",188),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityNeeded))}),l(33," \u2713 "),a(),r(34,"button",189),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,0))}),l(35," \u2717 "),a()()()()}if(s&2){let e=n.$implicit,t=c(7);P("bg-green-50",e.quantityOwned>=e.quantityNeeded)("bg-yellow-50",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-50",e.quantityOwned===0),o(3),$(t.getMinifigPartImageSizeClasses()+" bg-gray-100 rounded overflow-hidden mr-3 flex-shrink-0 cursor-pointer"),o(),_("src",e.imageUrl,Q)("alt",e.part.name),o(3),q(e.part.name),o(2),q(e.part.part_num),o(2),q(e.color.name),o(6),T("",e.quantityOwned," / ",e.quantityNeeded,""),o(2),j("width",e.quantityOwned/e.quantityNeeded*100,"%"),P("bg-green-500",e.quantityOwned>=e.quantityNeeded)("bg-yellow-500",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-500",e.quantityOwned===0),o(2),_("disabled",e.quantityOwned<=0),o(2),_("value",e.quantityOwned)("min",0)("max",e.quantityNeeded),o(),_("disabled",e.quantityOwned>=e.quantityNeeded),o(3),P("text-green-600",e.quantityOwned>=e.quantityNeeded)("text-yellow-600",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("text-red-600",e.quantityOwned===0),o(),_("ngIf",e.quantityOwned>=e.quantityNeeded),o(),_("ngIf",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded),o(),_("ngIf",e.quantityOwned===0),o(2),_("disabled",e.quantityOwned>=e.quantityNeeded),o(2),_("disabled",e.quantityOwned===0)}}function ri(s,n){if(s&1&&(r(0,"div",169)(1,"div",170)(2,"h4",171),l(3,"Minifigure Parts"),a(),r(4,"div",172),y(5,ni,36,39,"div",173),a()()()),s&2){let e=c().$implicit,t=c(5);o(5),_("ngForOf",t.getMinifigParts(e.minifig.fig_num))}}function ai(s,n){if(s&1){let e=O();r(0,"div",109)(1,"div",110)(2,"div")(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.openImageOverlay(i.imageUrl,i.minifig.name))}),D(4,"img",112),a(),r(5,"div")(6,"h3",113),l(7),a(),r(8,"p",114),l(9),a(),r(10,"p",114),l(11),a(),y(12,Wt,2,2,"p",116),a()(),r(13,"div",117)(14,"div",60)(15,"span"),l(16,"Parts Progress"),a(),r(17,"span"),l(18),a()(),r(19,"div",65),D(20,"div",66),a()(),r(21,"div",126)(22,"span",127),y(23,Gt,2,0,"span",39)(24,Yt,3,4,"span",39)(25,Jt,2,0,"span",39),a()(),r(26,"div",165)(27,"button",166),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.toggleMinifigParts(i.minifig.fig_num))}),y(28,Zt,2,0,"span",167)(29,Xt,2,0,"span",167),l(30),a()()(),y(31,ri,6,1,"div",168),a()}if(s&2){let e=n.$implicit,t=c(5);P("bg-green-50",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>=100)("bg-yellow-50",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>0&&t.getMinifigPartsProgress(e.minifig.fig_num).percentage<100)("bg-red-50",t.getMinifigPartsProgress(e.minifig.fig_num).percentage===0),o(2),$(t.shouldUseVerticalLayout()?"flex flex-col items-center mb-4":"flex items-start mb-4"),o(),$(t.getImageSizeClasses()+(t.shouldUseVerticalLayout()?" mb-3 flex-shrink-0 cursor-pointer":" mr-4 flex-shrink-0 cursor-pointer")),o(),_("src",e.imageUrl,Q)("alt",e.minifig.name),o(),$(t.shouldUseVerticalLayout()?"flex-1 text-center":"flex-1"),o(2),q(e.minifig.name),o(2),I("Fig #: ",e.minifig.fig_num,""),o(2),I("Parts: ",e.minifig.num_parts,""),o(),_("ngIf",t.isMissingPartsMode&&e.setName),o(6),T("",t.getMinifigPartsProgress(e.minifig.fig_num).owned," / ",t.getMinifigPartsProgress(e.minifig.fig_num).total,""),o(2),j("width",t.getMinifigPartsProgress(e.minifig.fig_num).percentage,"%"),P("bg-green-500",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>=100)("bg-yellow-500",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>0&&t.getMinifigPartsProgress(e.minifig.fig_num).percentage<100)("bg-red-500",t.getMinifigPartsProgress(e.minifig.fig_num).percentage===0),o(2),P("text-green-600",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>=100)("text-yellow-600",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>0&&t.getMinifigPartsProgress(e.minifig.fig_num).percentage<100)("text-red-600",t.getMinifigPartsProgress(e.minifig.fig_num).percentage===0),o(),_("ngIf",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>=100),o(),_("ngIf",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>0&&t.getMinifigPartsProgress(e.minifig.fig_num).percentage<100),o(),_("ngIf",t.getMinifigPartsProgress(e.minifig.fig_num).percentage===0),o(3),_("ngIf",!t.isMinifigPartsExpanded(e.minifig.fig_num)),o(),_("ngIf",t.isMinifigPartsExpanded(e.minifig.fig_num)),o(),I(" ",t.isMinifigPartsExpanded(e.minifig.fig_num)?"Hide Parts":"Show Parts"," "),o(),_("ngIf",t.isMinifigPartsExpanded(e.minifig.fig_num))}}function oi(s,n){if(s&1&&(r(0,"div",107),y(1,ai,32,41,"div",108),a()),s&2){let e=c(4);o(),_("ngForOf",e.minifigs)("ngForTrackBy",e.trackByMinifigId)}}function si(s,n){s&1&&(r(0,"th",136),l(1,"Set"),a())}function li(s,n){if(s&1&&(r(0,"td",148)(1,"div",146),l(2),a()()),s&2){let e=c().$implicit;o(2),T("",e.setName," (",e.setNum,")")}}function di(s,n){s&1&&(r(0,"span",52),l(1,"\u25B6"),a())}function ci(s,n){s&1&&(r(0,"span",52),l(1,"\u25BC"),a())}function _i(s,n){if(s&1){let e=O();r(0,"tr")(1,"td",202)(2,"div",142)(3,"div",111),g("click",function(){let i=u(e).$implicit,d=c(7);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),D(4,"img",112),a(),r(5,"div",143)(6,"div",203),l(7),a(),r(8,"div",204),l(9),a()()()(),r(10,"td",205)(11,"div",206),l(12),a()(),r(13,"td",205)(14,"div",207),D(15,"div",208),a(),r(16,"div",209),l(17),a()(),r(18,"td",205)(19,"div",153)(20,"button",210),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned-1))}),l(21," - "),a(),r(22,"input",211),g("input",function(i){let d=u(e).$implicit,m=c(2).$implicit,p=c(5);return v(p.updateMinifigPartQuantity((p.userInventory==null?null:p.userInventory.set_num)||"",m.minifig.fig_num,d,+i.target.value))})("focus",function(i){return u(e),v(i.target.select())}),a(),r(23,"button",210),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned+1))}),l(24," + "),a()()(),r(25,"td",212)(26,"div",153)(27,"button",213),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityNeeded))}),l(28," \u2713 "),a(),r(29,"button",214),g("click",function(){let i=u(e).$implicit,d=c(2).$implicit,m=c(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,0))}),l(30," \u2717 "),a()()()()}if(s&2){let e=n.$implicit,t=c(7);P("bg-green-50",e.quantityOwned>=e.quantityNeeded)("bg-yellow-50",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-50",e.quantityOwned===0),o(3),$(t.getMinifigPartListImageSizeClasses()+" bg-gray-100 rounded overflow-hidden mr-2 flex-shrink-0 cursor-pointer"),o(),_("src",e.imageUrl,Q)("alt",e.part.name),o(3),q(e.part.name),o(2),q(e.part.part_num),o(3),q(e.color.name),o(3),j("width",e.quantityOwned/e.quantityNeeded*100,"%"),P("bg-green-500",e.quantityOwned>=e.quantityNeeded)("bg-yellow-500",e.quantityOwned>0&&e.quantityOwned<e.quantityNeeded)("bg-red-500",e.quantityOwned===0),o(2),T("",e.quantityOwned,"/",e.quantityNeeded,""),o(3),_("disabled",e.quantityOwned<=0),o(2),_("value",e.quantityOwned)("min",0)("max",e.quantityNeeded),o(),_("disabled",e.quantityOwned>=e.quantityNeeded),o(4),_("disabled",e.quantityOwned>=e.quantityNeeded),o(2),_("disabled",e.quantityOwned===0)}}function mi(s,n){if(s&1&&(r(0,"tr",132)(1,"td",195)(2,"div",196)(3,"h4",171),l(4,"Minifigure Parts"),a(),r(5,"div",197)(6,"div",130)(7,"table",198)(8,"thead",199)(9,"tr")(10,"th",200),l(11,"Part"),a(),r(12,"th",200),l(13,"Color"),a(),r(14,"th",200),l(15,"Progress"),a(),r(16,"th",200),l(17,"Quantity"),a(),r(18,"th",200),l(19,"Actions"),a()()(),r(20,"tbody",139),y(21,_i,31,30,"tr",201),a()()()()()()()),s&2){let e=c().$implicit,t=c(5);o(),me("colspan",t.isMissingPartsMode?7:6),o(20),_("ngForOf",t.getMinifigParts(e.minifig.fig_num))}}function pi(s,n){if(s&1){let e=O();pe(0),r(1,"tr")(2,"td",141)(3,"div",142)(4,"div",111),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.openImageOverlay(i.imageUrl,i.minifig.name))}),D(5,"img",112),a(),r(6,"div",143)(7,"div",144),l(8),a(),r(9,"div",21),l(10),a()()()(),r(11,"td",191)(12,"div",192),l(13),a()(),y(14,li,3,2,"td",147),r(15,"td",148)(16,"div",149),D(17,"div",150),a(),r(18,"div",151),l(19),a()(),r(20,"td",156)(21,"button",193),g("click",function(){let i=u(e).$implicit,d=c(5);return v(d.toggleMinifigParts(i.minifig.fig_num))}),y(22,di,2,0,"span",167)(23,ci,2,0,"span",167),l(24),a()()(),y(25,mi,22,2,"tr",194),ue()}if(s&2){let e=n.$implicit,t=c(5);o(),P("bg-green-50",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>=100)("bg-yellow-50",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>0&&t.getMinifigPartsProgress(e.minifig.fig_num).percentage<100)("bg-red-50",t.getMinifigPartsProgress(e.minifig.fig_num).percentage===0),o(3),$(t.getListImageSizeClasses()+" mr-2 flex-shrink-0 cursor-pointer"),o(),_("src",e.imageUrl,Q)("alt",e.minifig.name),o(3),q(e.minifig.name),o(2),q(e.minifig.fig_num),o(3),q(e.minifig.num_parts),o(),_("ngIf",t.isMissingPartsMode),o(3),j("width",t.getMinifigPartsProgress(e.minifig.fig_num).percentage,"%"),P("bg-green-500",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>=100)("bg-yellow-500",t.getMinifigPartsProgress(e.minifig.fig_num).percentage>0&&t.getMinifigPartsProgress(e.minifig.fig_num).percentage<100)("bg-red-500",t.getMinifigPartsProgress(e.minifig.fig_num).percentage===0),o(2),T("",t.getMinifigPartsProgress(e.minifig.fig_num).owned,"/",t.getMinifigPartsProgress(e.minifig.fig_num).total,""),o(3),_("ngIf",!t.isMinifigPartsExpanded(e.minifig.fig_num)),o(),_("ngIf",t.isMinifigPartsExpanded(e.minifig.fig_num)),o(),I(" ",t.isMinifigPartsExpanded(e.minifig.fig_num)?"Hide":"Show"," "),o(),_("ngIf",t.isMinifigPartsExpanded(e.minifig.fig_num))}}function ui(s,n){if(s&1&&(r(0,"div",129)(1,"div",130)(2,"table",131)(3,"thead",132)(4,"tr")(5,"th",133),l(6," Minifigure"),a(),r(7,"th",138),l(8," Parts"),a(),y(9,si,2,0,"th",135),r(10,"th",136),l(11," Parts Progress"),a(),r(12,"th",138),l(13," Show Parts"),a()()(),r(14,"tbody",139),y(15,pi,26,28,"ng-container",190),a()()()()),s&2){let e=c(4);o(9),_("ngIf",e.isMissingPartsMode),o(6),_("ngForOf",e.minifigs)("ngForTrackBy",e.trackByMinifigId)}}function vi(s,n){if(s&1&&(r(0,"div"),y(1,oi,2,2,"div",105)(2,ui,16,3,"div",106),a()),s&2){let e=c(3);o(),_("ngIf",e.minifigsViewType==="tiles"),o(),_("ngIf",e.minifigsViewType==="list")}}function gi(s,n){s&1&&(r(0,"div",159)(1,"p",160),l(2,"No minifigures found for this set."),a()())}function fi(s,n){if(s&1){let e=O();r(0,"div")(1,"div",74)(2,"div",44)(3,"h3",86),l(4),a()(),r(5,"div",76)(6,"div",77)(7,"button",78),g("click",function(){u(e);let i=c(2);return v(i.toggleMinifigsView())}),r(8,"span",52),l(9,"\u229E"),a(),l(10," Tiles "),a(),r(11,"button",78),g("click",function(){u(e);let i=c(2);return v(i.toggleMinifigsView())}),r(12,"span",52),l(13,"\u2630"),a(),l(14," List "),a()(),r(15,"button",79),g("click",function(){u(e);let i=c(2);return v(i.toggleSortOptions())}),r(16,"span",52),l(17,"\u2699\uFE0F"),a(),l(18," Sort "),a(),r(19,"button",80),g("click",function(){u(e);let i=c(2);return v(i.markAllMinifigsOwned(!0))}),l(20," Mark All Complete "),a(),r(21,"button",81),g("click",function(){u(e);let i=c(2);return v(i.markAllMinifigsOwned(!1))}),l(22," Mark All Missing "),a()()(),y(23,Ht,14,2,"div",82)(24,vi,3,2,"div",83)(25,gi,3,0,"ng-template",null,2,se),a()}if(s&2){let e=ae(26),t=c(2);o(4),T("Minifigures (",t.getTotalMinifigPartsProgress().owned,"/",t.getTotalMinifigPartsProgress().total,")"),o(3),P("bg-blue-600",t.minifigsViewType==="tiles")("text-white",t.minifigsViewType==="tiles")("bg-gray-200",t.minifigsViewType!=="tiles")("text-gray-700",t.minifigsViewType!=="tiles"),o(4),P("bg-blue-600",t.minifigsViewType==="list")("text-white",t.minifigsViewType==="list")("bg-gray-200",t.minifigsViewType!=="list")("text-gray-700",t.minifigsViewType!=="list"),o(12),_("ngIf",t.showMinifigsSortOptions),o(),_("ngIf",t.minifigs.length>0)("ngIfElse",e)}}function yi(s,n){if(s&1){let e=O();r(0,"div",32)(1,"div",33),y(2,Ye,28,15,"div",34)(3,Je,12,2,"div",35),r(4,"div",36)(5,"nav",37)(6,"button",38),g("click",function(){u(e);let i=c();return v(i.switchToTab("parts"))}),y(7,Ze,2,2,"span",39)(8,Xe,2,1,"span",39)(9,et,2,1,"span",40),a(),r(10,"button",38),g("click",function(){u(e);let i=c();return v(i.switchToTab("spare-parts"))}),y(11,tt,2,2,"span",39)(12,it,2,1,"span",39)(13,nt,2,1,"span",40),a(),r(14,"button",38),g("click",function(){u(e);let i=c();return v(i.switchToTab("minifigs"))}),y(15,rt,2,2,"span",39)(16,at,2,1,"span",39)(17,ot,2,1,"span",40),a()()(),y(18,Ct,26,20,"div",39)(19,Bt,27,21,"div",39)(20,fi,27,21,"div",39),a()()}if(s&2){let e=c();o(2),_("ngIf",!e.isMissingPartsMode),o(),_("ngIf",e.isMissingPartsMode),o(3),P("text-blue-600",e.activeTab==="parts")("border-blue-600",e.activeTab==="parts")("border-transparent",e.activeTab!=="parts"),o(),_("ngIf",!e.isMissingPartsMode),o(),_("ngIf",e.isMissingPartsMode),o(),_("ngIf",e.missingPartsCount>0&&!e.isMissingPartsMode),o(),P("text-blue-600",e.activeTab==="spare-parts")("border-blue-600",e.activeTab==="spare-parts")("border-transparent",e.activeTab!=="spare-parts"),o(),_("ngIf",!e.isMissingPartsMode),o(),_("ngIf",e.isMissingPartsMode),o(),_("ngIf",e.missingSparePartsCount>0&&!e.isMissingPartsMode),o(),P("text-blue-600",e.activeTab==="minifigs")("border-blue-600",e.activeTab==="minifigs")("border-transparent",e.activeTab!=="minifigs"),o(),_("ngIf",!e.isMissingPartsMode),o(),_("ngIf",e.isMissingPartsMode),o(),_("ngIf",e.getTotalMinifigPartsProgress().missing>0&&!e.isMissingPartsMode),o(),_("ngIf",e.activeTab==="parts"),o(),_("ngIf",e.activeTab==="spare-parts"),o(),_("ngIf",e.activeTab==="minifigs")}}function xi(s,n){if(s&1){let e=O();r(0,"div",215),g("click",function(i){u(e);let d=c();return v(d.onOverlayClick(i))}),r(1,"div",216)(2,"button",217),g("click",function(){u(e);let i=c();return v(i.closeImageOverlay())}),l(3," \xD7 "),a(),D(4,"img",218),r(5,"div",219)(6,"p",18),l(7," Image \xA9 "),r(8,"a",220),l(9,"Rebrickable"),a()()()()()}if(s&2){let e=c();o(4),_("src",e.getLargeImageUrl(e.overlayImageUrl),Q)("alt",e.overlayImageAlt)}}function hi(s,n){if(s&1){let e=O();r(0,"button",221),g("click",function(){u(e);let i=c();return v(i.performUndo())}),r(1,"span",11),l(2,"\u27F2"),a()()}if(s&2){let e=c();_("disabled",!e.canUndo)("title",e.canUndo?"Undo last action (Cmd/Ctrl+Z) - "+((e.userInventory==null||e.userInventory.undoHistory==null?null:e.userInventory.undoHistory.length)||0)+" actions available":"No actions to undo")}}function wi(s,n){if(s&1&&(r(0,"span",222),l(1),a()),s&2){let e=c();o(),I(" ",e.userInventory==null||e.userInventory.undoHistory==null?null:e.userInventory.undoHistory.length," ")}}function bi(s,n){if(s&1&&(r(0,"div",223)(1,"div",118)(2,"span",11),l(3,"\u2713"),a(),r(4,"span"),l(5),a()()()),s&2){let e=c();o(5),q(e.undoNotificationMessage)}}var Te=class s{constructor(n,e,t,i){this.route=n;this.dataService=e;this.storageService=t;this.changeDetectorRef=i;this.initializeDefaultSorting()}userInventory=null;inventory=null;set=null;parts=[];minifigs=[];spareParts=[];loading=!0;searchTerm="";filteredParts=[];activeTab="parts";missingPartsCount=0;missingMinifigsCount=0;missingSparePartsCount=0;isMissingPartsMode=!1;userInventories=[];theme=null;uniqueColorsCount=0;totalPartsNeeded=0;totalPartsOwned=0;totalMinifigsNeeded=0;totalMinifigsOwned=0;totalSparePartsNeeded=0;totalSparePartsOwned=0;overallProgress=0;showSortOptions=!1;partsSortOptions=[];minifigsSortOptions=[];sparePartsSortOptions=[];showPartsSortOptions=!1;showSparePartsSortOptions=!1;showMinifigsSortOptions=!1;partsViewType="tiles";minifigsViewType="tiles";sparePartsViewType="tiles";showImageOverlay=!1;overlayImageUrl="";overlayImageAlt="";maxUndoHistory=100;canUndo=!1;showUndoNotification=!1;undoNotificationMessage="";partSortFields=[{value:"completion",label:"Completion Status"},{value:"color",label:"Color"},{value:"partNumber",label:"Part Number"},{value:"partName",label:"Part Name"},{value:"elementId",label:"Element ID"},{value:"quantityMissing",label:"Quantity Missing"},{value:"quantityNeeded",label:"Quantity Needed"}];minifigSortFields=[{value:"completion",label:"Completion Status"},{value:"figNumber",label:"Figure Number"},{value:"figName",label:"Figure Name"},{value:"quantityMissing",label:"Quantity Missing"},{value:"quantityNeeded",label:"Quantity Needed"}];globalSettings={imagePreviewSize:"1x",includeSparePartsInProgress:!0};collapsedMinifigParts=[];minifigPartsCache=new Map;_totalMinifigPartsProgress={owned:0,total:0,missing:0,percentage:0};getPartStorageKey(n,e,t){let i=`${n}_${e}`;return t?`spare_${i}`:i}getMinifigPartStorageKey(n,e,t,i){return`${n}_${e}_${t}_${i}`}toggleMinifigParts(n){let e=this.collapsedMinifigParts.indexOf(n);e>-1?this.collapsedMinifigParts.splice(e,1):this.collapsedMinifigParts.push(n),this.saveMinifigPartsState()}isMinifigPartsExpanded(n){return!this.collapsedMinifigParts.includes(n)}saveMinifigPartsState(){if(this.isMissingPartsMode||!this.userInventory)return;let n=B(U({},this.userInventory),{collapsedMinifigParts:[...this.collapsedMinifigParts],lastUpdated:Date.now()});this.userInventory=n,this.storageService.updateUserInventory(n)}loadMinifigPartsState(){this.isMissingPartsMode?this.collapsedMinifigParts=[]:this.userInventory?.collapsedMinifigParts?this.collapsedMinifigParts=[...this.userInventory.collapsedMinifigParts]:this.collapsedMinifigParts=[]}getMinifigParts(n){if(this.minifigPartsCache.has(n)){let i=this.minifigPartsCache.get(n);return this.sortMinifigParts([...i])}let t=this.dataService.getCurrentInventories().find(i=>i.set_num===n);return t?(this.loadMinifigPartsAsync(n,t.id),[]):(this.minifigPartsCache.set(n,[]),[])}loadMinifigPartsAsync(n,e){let t=this.dataService.getCurrentParts(),i=this.dataService.getCurrentColors(),d=this.dataService.getCurrentElements(),m=new Map(t.map(w=>[w.part_num,w])),p=new Map(i.map(w=>[w.id,w])),f=new Map(d.map(w=>[`${w.part_num}_${w.color_id}`,w.element_id]));this.dataService.getInventoryPartsFromCache(e).subscribe(w=>{let h=[];for(let C of w){let S=m.get(C.part_num),k=p.get(C.color_id);if(S&&k){let V=f.get(`${C.part_num}_${C.color_id}`),E=this.getMinifigPartStorageKey(this.userInventory?.set_num||"",n,C.part_num,C.color_id),N=this.userInventory?.minifigPartsOwned?.[E]||0,F={inventoryPart:C,part:S,color:k,imageUrl:C.img_url,quantityNeeded:C.quantity,quantityOwned:N,elementId:V};h.push(F)}}let x=this.sortMinifigParts(h);this.minifigPartsCache.set(n,x),this.updateTotalMinifigPartsProgress()})}sortMinifigParts(n){try{return n.sort((e,t)=>{let i=e.quantityOwned>=e.quantityNeeded,d=t.quantityOwned>=t.quantityNeeded;if(i!==d)return i?1:-1;let m=String(e.color?.name||""),p=String(t.color?.name||""),f=m.localeCompare(p);if(f!==0)return f;let w=String(e.part?.part_num||""),h=String(t.part?.part_num||"");return w.localeCompare(h)})}catch(e){return console.error("Error sorting minifigure parts:",e),n}}getMinifigPartsProgress(n){let e=this.getMinifigParts(n),t=e.reduce((m,p)=>m+p.quantityOwned,0),i=e.reduce((m,p)=>m+p.quantityNeeded,0),d=i>0?Math.round(t/i*100):0;return{owned:t,total:i,percentage:d}}getTotalMinifigPartsProgress(){return this._totalMinifigPartsProgress}updateTotalMinifigPartsProgress(){let n=0,e=0;this.minifigs.forEach(d=>{let m=d.minifig.fig_num,p=this.minifigPartsCache.get(m);if(p&&p.length>0){let f=p.reduce((h,x)=>h+x.quantityOwned,0),w=p.reduce((h,x)=>h+x.quantityNeeded,0);n+=f,e+=w}});let t=e-n,i=e>0?Math.round(n/e*100):0;this._totalMinifigPartsProgress={owned:n,total:e,missing:t,percentage:i}}updateCounts(){this.missingPartsCount=this.parts.reduce((t,i)=>t+Math.max(0,i.quantityNeeded-i.quantityOwned),0),this.missingMinifigsCount=this.minifigs.reduce((t,i)=>t+Math.max(0,i.quantityNeeded-i.quantityOwned),0),this.missingSparePartsCount=this.spareParts.reduce((t,i)=>t+Math.max(0,i.quantityNeeded-i.quantityOwned),0),this.totalPartsNeeded=this.parts.reduce((t,i)=>t+i.quantityNeeded,0),this.totalPartsOwned=this.parts.reduce((t,i)=>t+i.quantityOwned,0),this.totalMinifigsNeeded=this.minifigs.reduce((t,i)=>t+i.quantityNeeded,0),this.totalMinifigsOwned=this.minifigs.reduce((t,i)=>t+i.quantityOwned,0),this.totalSparePartsNeeded=this.spareParts.reduce((t,i)=>t+i.quantityNeeded,0),this.totalSparePartsOwned=this.spareParts.reduce((t,i)=>t+i.quantityOwned,0);let n,e;this.globalSettings.includeSparePartsInProgress?(n=this.totalPartsNeeded+this.totalMinifigsNeeded+this.totalSparePartsNeeded,e=this.totalPartsOwned+this.totalMinifigsOwned+this.totalSparePartsOwned):(n=this.totalPartsNeeded+this.totalMinifigsNeeded,e=this.totalPartsOwned+this.totalMinifigsOwned),this.overallProgress=n>0?e/n*100:0,this.updateTotalMinifigPartsProgress()}filterParts(){if(!this.searchTerm){this.filteredParts=[...this.parts];return}let n=this.searchTerm.toLowerCase(),e=this.parts.filter(t=>t.part.name.toLowerCase().includes(n)||t.part.part_num.toLowerCase().includes(n)||t.color.name.toLowerCase().includes(n));this.filteredParts=this.sortParts(e)}updatePartQuantity(n,e){if(!this.userInventory)return;let t=this.spareParts.includes(n),i=this.getPartStorageKey(n.inventoryPart.part_num,n.inventoryPart.color_id,t),d=n.quantityOwned,m=Math.max(0,Math.min(e,n.quantityNeeded));if(m===d)return;n.quantityOwned=m;let p={};for(let[h,x]of Object.entries(this.userInventory.partsOwned))p[h]=typeof x=="number"?x:x?1:0;p[i]=m;let f=B(U({},this.userInventory),{partsOwned:p,lastUpdated:Date.now()});this.userInventory=f,this.storageService.updateUserInventory(f),this.updateCounts();let w={type:"part",key:i,previousQuantity:d,newQuantity:m,timestamp:Date.now(),description:`Changed ${n.part.name} quantity from ${d} to ${m}`};this.addUndoAction(w)}updateMinifigQuantity(n,e){if(!this.userInventory)return;let t=n.inventoryMinifig.fig_num,i=n.quantityOwned,d=Math.max(0,Math.min(e,n.quantityNeeded));if(d===i)return;n.quantityOwned=d;let m={};for(let[w,h]of Object.entries(this.userInventory.minifigsOwned))m[w]=typeof h=="number"?h:h?1:0;m[n.inventoryMinifig.fig_num]=d;let p=B(U({},this.userInventory),{minifigsOwned:m,lastUpdated:Date.now()});this.userInventory=p,this.storageService.updateUserInventory(p),this.updateCounts();let f={type:"minifig",key:t,previousQuantity:i,newQuantity:d,timestamp:Date.now(),description:`Changed ${n.minifig.name} quantity from ${i} to ${d}`};this.addUndoAction(f)}updateMinifigPartQuantity(n,e,t,i){if(!this.userInventory)return;let d=this.getMinifigPartStorageKey(n,e,t.inventoryPart.part_num,t.inventoryPart.color_id),m=t.quantityOwned,p=Math.max(0,Math.min(i,t.quantityNeeded));if(p===m)return;t.quantityOwned=p,this.userInventory.minifigPartsOwned||(this.userInventory.minifigPartsOwned={}),this.userInventory.minifigPartsOwned[d]=p;let f=this.minifigPartsCache.get(e);if(f){let x=f.find(C=>C.inventoryPart.part_num===t.inventoryPart.part_num&&C.inventoryPart.color_id===t.inventoryPart.color_id);x&&(x.quantityOwned=p)}this.checkAndUpdateMinifigCompletion(e);let w=B(U({},this.userInventory),{lastUpdated:Date.now()});this.userInventory=w,this.storageService.updateUserInventory(w),this.updateCounts();let h={type:"minifig-part",key:d,previousQuantity:m,newQuantity:p,timestamp:Date.now(),description:`Changed ${t.part.name} (${e}) quantity from ${m} to ${p}`};this.addUndoAction(h)}checkAndUpdateMinifigCompletion(n){if(!this.userInventory)return;let e=this.minifigs.find(p=>p.minifig.fig_num===n);if(!e)return;let t=this.getMinifigParts(n);if(!t||t.length===0)return;let i=t.every(p=>p.quantityOwned>=p.quantityNeeded),d=t.some(p=>p.quantityOwned<p.quantityNeeded),m;i?m=e.quantityNeeded:d&&e.quantityOwned===e.quantityNeeded?m=0:m=e.quantityOwned,e.quantityOwned!==m&&(e.quantityOwned=m,this.userInventory.minifigsOwned||(this.userInventory.minifigsOwned={}),this.userInventory.minifigsOwned[n]=m,console.log(`Auto-updated minifigure ${n} quantity to ${m} (all parts complete: ${i})`))}getPartImageUrl(n,e,t){return`https://cdn.rebrickable.com/media/thumbs/parts/elements/${t}.jpg/800x800p.jpg?`+Date.now()%1e6}getMinifigImageUrl(n){return`assets/images/placeholder.svg?fig=${n}`}markAllPartsOwned(n){if(!this.userInventory)return;let t=`Are you sure you want to ${n?"mark all parts as complete":"mark all parts as missing"}? This will update the quantities for all ${this.parts.length} parts in this set.`;if(!confirm(t))return;let i={};for(let[p,f]of Object.entries(this.userInventory.partsOwned))i[p]=typeof f=="number"?f:f?1:0;for(let p of this.parts){let f=this.getPartStorageKey(p.inventoryPart.part_num,p.inventoryPart.color_id,!1);i[f]=n?p.quantityNeeded:0,p.quantityOwned=i[f]}let d={};for(let[p,f]of Object.entries(this.userInventory.minifigsOwned))d[p]=typeof f=="number"?f:f?1:0;let m=B(U({},this.userInventory),{partsOwned:i,minifigsOwned:d,lastUpdated:Date.now()});this.storageService.updateUserInventory(m),this.userInventory=m,this.updateCounts()}markAllMinifigsOwned(n){if(!this.userInventory)return;let t=`Are you sure you want to ${n?"mark all minifigures as complete":"mark all minifigures as missing"}? This will update the quantities for all ${this.minifigs.length} minifigures and their individual parts in this set.`;if(!confirm(t))return;let i={};for(let[p,f]of Object.entries(this.userInventory.partsOwned))i[p]=typeof f=="number"?f:f?1:0;let d={};for(let[p,f]of Object.entries(this.userInventory.minifigsOwned))d[p]=typeof f=="number"?f:f?1:0;this.userInventory.minifigPartsOwned||(this.userInventory.minifigPartsOwned={});let m=[];for(let p of this.minifigs){d[p.inventoryMinifig.fig_num]=n?p.quantityNeeded:0,p.quantityOwned=d[p.inventoryMinifig.fig_num];let f=this.updateMinifigPartsAsync(p.minifig.fig_num,n);m.push(f)}Promise.all(m).then(()=>{let p=B(U({},this.userInventory),{partsOwned:i,minifigsOwned:d,minifigPartsOwned:this.userInventory.minifigPartsOwned,lastUpdated:Date.now()});this.storageService.updateUserInventory(p),this.userInventory=p,this.updateCounts()}).catch(p=>{console.error("Error updating minifigure parts:",p)})}updateMinifigPartsAsync(n,e){return le(this,null,function*(){return new Promise((t,i)=>{let m=this.dataService.getCurrentInventories().find(S=>S.set_num===n);if(!m){t();return}let p=this.dataService.getCurrentParts(),f=this.dataService.getCurrentColors(),w=this.dataService.getCurrentElements(),h=new Map(p.map(S=>[S.part_num,S])),x=new Map(f.map(S=>[S.id,S])),C=new Map(w.map(S=>[`${S.part_num}_${S.color_id}`,S.element_id]));this.dataService.getInventoryPartsFromCache(m.id).subscribe({next:S=>{let k=[];for(let E of S){let N=h.get(E.part_num),F=x.get(E.color_id);if(N&&F){let M=C.get(`${E.part_num}_${E.color_id}`),L=this.getMinifigPartStorageKey(this.userInventory.set_num,n,E.part_num,E.color_id),A=e?E.quantity:0;this.userInventory.minifigPartsOwned[L]=A;let z={inventoryPart:E,part:N,color:F,imageUrl:E.img_url,quantityNeeded:E.quantity,quantityOwned:A,elementId:M};k.push(z)}}let V=this.sortMinifigParts(k);this.minifigPartsCache.set(n,V),t()},error:S=>{console.error(`Error loading parts for minifigure ${n}:`,S),i(S)}})})})}markAllSparePartsOwned(n){if(!this.userInventory)return;let t=`Are you sure you want to ${n?"mark all spare parts as complete":"mark all spare parts as missing"}? This will update the quantities for all ${this.spareParts.length} spare parts in this set.`;if(!confirm(t))return;let i={};for(let[p,f]of Object.entries(this.userInventory.partsOwned))i[p]=typeof f=="number"?f:f?1:0;for(let p of this.spareParts){let f=this.getPartStorageKey(p.inventoryPart.part_num,p.inventoryPart.color_id,!0);i[f]=n?p.quantityNeeded:0,p.quantityOwned=i[f]}let d={};for(let[p,f]of Object.entries(this.userInventory.minifigsOwned))d[p]=typeof f=="number"?f:f?1:0;let m=B(U({},this.userInventory),{partsOwned:i,minifigsOwned:d,lastUpdated:Date.now()});this.storageService.updateUserInventory(m),this.userInventory=m,this.updateCounts()}initializeDefaultSorting(){this.partsSortOptions=[{field:"completion",direction:"asc"},{field:"color",direction:"asc"},{field:"partNumber",direction:"asc"}],this.minifigsSortOptions=[{field:"completion",direction:"asc"},{field:"figNumber",direction:"asc"},{field:"figName",direction:"asc"}],this.sparePartsSortOptions=[{field:"completion",direction:"asc"},{field:"color",direction:"asc"},{field:"partNumber",direction:"asc"}]}loadSortPreferences(){this.userInventory?.sortPreferences&&(this.userInventory.sortPreferences.parts.length>0&&(this.partsSortOptions=[...this.userInventory.sortPreferences.parts]),this.userInventory.sortPreferences.minifigs.length>0&&(this.minifigsSortOptions=[...this.userInventory.sortPreferences.minifigs]),this.userInventory.sortPreferences.spareParts&&this.userInventory.sortPreferences.spareParts.length>0&&(this.sparePartsSortOptions=[...this.userInventory.sortPreferences.spareParts]))}loadViewPreferences(){this.userInventory?.viewPreferences&&(this.partsViewType=this.userInventory.viewPreferences.parts||"tiles",this.minifigsViewType=this.userInventory.viewPreferences.minifigs||"tiles",this.sparePartsViewType=this.userInventory.viewPreferences.spareParts||"tiles")}saveSortPreferences(){if(!this.userInventory)return;let n=B(U({},this.userInventory),{sortPreferences:{parts:[...this.partsSortOptions],minifigs:[...this.minifigsSortOptions],spareParts:[...this.sparePartsSortOptions]},lastUpdated:Date.now()});this.userInventory=n,this.storageService.updateUserInventory(n)}saveViewPreferences(){if(!this.userInventory)return;let n=B(U({},this.userInventory),{viewPreferences:{parts:this.partsViewType,minifigs:this.minifigsViewType,spareParts:this.sparePartsViewType},lastUpdated:Date.now()});this.userInventory=n,this.storageService.updateUserInventory(n)}applySorting(){this.parts=this.sortParts([...this.parts]),this.minifigs=this.sortMinifigs([...this.minifigs]),this.spareParts=this.sortSpareParts([...this.spareParts]),this.filterParts()}sortParts(n){try{return n.sort((e,t)=>{for(let i of this.partsSortOptions){let d=this.comparePartsByField(e,t,i.field);if(d!==0)return i.direction==="asc"?d:-d}return 0})}catch(e){return console.error("Error sorting parts:",e),n}}sortMinifigs(n){try{return n.sort((e,t)=>{for(let i of this.minifigsSortOptions){let d=this.compareMinifigsByField(e,t,i.field);if(d!==0)return i.direction==="asc"?d:-d}return 0})}catch(e){return console.error("Error sorting minifigs:",e),n}}sortSpareParts(n){try{return n.sort((e,t)=>{for(let i of this.sparePartsSortOptions){let d=this.compareSparePartsByField(e,t,i.field);if(d!==0)return i.direction==="asc"?d:-d}return 0})}catch(e){return console.error("Error sorting spare parts:",e),n}}comparePartsByField(n,e,t){switch(t){case"completion":let i=n.quantityOwned>=n.quantityNeeded,d=e.quantityOwned>=e.quantityNeeded;return i===d?0:i?1:-1;case"color":let m=String(n.color?.name||""),p=String(e.color?.name||"");return m.localeCompare(p);case"partNumber":let f=String(n.part?.part_num||""),w=String(e.part?.part_num||"");return f.localeCompare(w);case"partName":let h=String(n.part?.name||""),x=String(e.part?.name||"");return h.localeCompare(x);case"elementId":let C=String(n.elementId||""),S=String(e.elementId||"");return C.localeCompare(S);case"quantityMissing":let k=Math.max(0,n.quantityNeeded-n.quantityOwned),V=Math.max(0,e.quantityNeeded-e.quantityOwned);return k-V;case"quantityNeeded":return n.quantityNeeded-e.quantityNeeded;case"setNumber":let E=String(n.setNum||""),N=String(e.setNum||"");return E.localeCompare(N);case"setName":let F=String(n.setName||""),M=String(e.setName||"");return F.localeCompare(M);default:return 0}}compareMinifigsByField(n,e,t){switch(t){case"completion":let i=n.quantityOwned>=n.quantityNeeded,d=e.quantityOwned>=e.quantityNeeded;return i===d?0:i?1:-1;case"figNumber":let m=String(n.minifig?.fig_num||""),p=String(e.minifig?.fig_num||"");return m.localeCompare(p);case"figName":let f=String(n.minifig?.name||""),w=String(e.minifig?.name||"");return f.localeCompare(w);case"quantityMissing":let h=Math.max(0,n.quantityNeeded-n.quantityOwned),x=Math.max(0,e.quantityNeeded-e.quantityOwned);return h-x;case"quantityNeeded":return n.quantityNeeded-e.quantityNeeded;case"setNumber":let C=String(n.setNum||""),S=String(e.setNum||"");return C.localeCompare(S);case"setName":let k=String(n.setName||""),V=String(e.setName||"");return k.localeCompare(V);default:return 0}}compareSparePartsByField(n,e,t){switch(t){case"completion":let i=n.quantityOwned>=n.quantityNeeded,d=e.quantityOwned>=e.quantityNeeded;return i===d?0:i?1:-1;case"color":let m=String(n.color?.name||""),p=String(e.color?.name||"");return m.localeCompare(p);case"partNumber":let f=String(n.part?.part_num||""),w=String(e.part?.part_num||"");return f.localeCompare(w);case"partName":let h=String(n.part?.name||""),x=String(e.part?.name||"");return h.localeCompare(x);case"elementId":let C=String(n.elementId||""),S=String(e.elementId||"");return C.localeCompare(S);case"quantityMissing":let k=Math.max(0,n.quantityNeeded-n.quantityOwned),V=Math.max(0,e.quantityNeeded-e.quantityOwned);return k-V;case"quantityNeeded":return n.quantityNeeded-e.quantityNeeded;case"setNumber":let E=String(n.setNum||""),N=String(e.setNum||"");return E.localeCompare(N);case"setName":let F=String(n.setName||""),M=String(e.setName||"");return F.localeCompare(M);default:return 0}}addSortOption(n){let e=n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions;if(e.length<3){let t=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields,i=e.map(m=>m.field),d=t.find(m=>!i.includes(m.value));if(d){let m={field:d.value,direction:"asc"};n==="parts"?this.partsSortOptions.push(m):n==="minifigs"?this.minifigsSortOptions.push(m):this.sparePartsSortOptions.push(m)}}}removeSortOption(n,e){n==="parts"?this.partsSortOptions.splice(e,1):n==="minifigs"?this.minifigsSortOptions.splice(e,1):this.sparePartsSortOptions.splice(e,1)}updateSortOption(n,e,t,i){let d=n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions;d[e]&&(d[e]={field:t,direction:i})}applySortChanges(){this.applySorting(),this.saveSortPreferences(),this.closeSortOptions()}resetToDefaultSort(){this.initializeDefaultSorting(),this.applySorting(),this.saveSortPreferences()}getAvailableFields(n,e){let t=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields;if(this.isMissingPartsMode){let p=[{value:"setNumber",label:"Set Number"},{value:"setName",label:"Set Name"}];t=[...t,...p]}let i=n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions,d=i[e]?.field,m=i.map((p,f)=>f!==e?p.field:null).filter(p=>p!==null);return t.filter(p=>{let f=p.value;return!m.includes(f)||f===d})}getAllFieldsForDropdown(n){let e=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields;if(this.isMissingPartsMode){let t=[{value:"setNumber",label:"Set Number"},{value:"setName",label:"Set Name"}];e=[...e,...t]}return e}isFieldDisabled(n,e,t){return(n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions).some((d,m)=>m!==t&&d.field===e)}getFieldLabel(n,e){let t=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields;if(this.isMissingPartsMode){let d=[{value:"setNumber",label:"Set Number"},{value:"setName",label:"Set Name"}];t=[...t,...d]}let i=t.find(d=>d.value===e);return i?i.label:e}togglePartsView(){this.partsViewType=this.partsViewType==="tiles"?"list":"tiles",this.saveViewPreferences()}toggleMinifigsView(){this.minifigsViewType=this.minifigsViewType==="tiles"?"list":"tiles",this.saveViewPreferences()}toggleSparePartsView(){this.sparePartsViewType=this.sparePartsViewType==="tiles"?"list":"tiles",this.saveViewPreferences()}openImageOverlay(n,e){this.overlayImageUrl=n,this.overlayImageAlt=e,this.showImageOverlay=!0,document.body.style.overflow="hidden"}closeImageOverlay(){this.showImageOverlay=!1,this.overlayImageUrl="",this.overlayImageAlt="",document.body.style.overflow="auto"}onOverlayClick(n){n.target===n.currentTarget&&this.closeImageOverlay()}getImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-32 h-32";case"4x":return"w-64 h-64";default:return"w-16 h-16"}}getListImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-16 h-16";case"4x":return"w-32 h-32";default:return"w-8 h-8"}}shouldUseVerticalLayout(){return this.globalSettings.imagePreviewSize==="4x"}getMinifigPartImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-16 h-16";case"4x":return"w-24 h-24";default:return"w-12 h-12"}}getMinifigPartListImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-12 h-12";case"4x":return"w-16 h-16";default:return"w-8 h-8"}}getLargeImageUrl(n){return n.includes("https://cdn.rebrickable.com/media/")&&!n.includes("https://cdn.rebrickable.com/media/thumbs/")?n.replace("https://cdn.rebrickable.com/media/","https://cdn.rebrickable.com/media/thumbs/")+"/800x800p.jpg?"+Date.now():n}onImageError(n){let e=n.target;e.style.display="none"}trackByPartId(n,e){return`${e.part.part_num}_${e.color.id}_${e.inventoryId||"default"}`}trackByMinifigId(n,e){return`${e.minifig.fig_num}_${e.inventoryId||"default"}`}trackBySparePartId(n,e){return`${e.inventoryPart.part_num}_${e.inventoryPart.color_id}`}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}scrollToBottom(){window.scrollTo(0,document.body.scrollHeight)}switchToTab(n){this.activeTab=n,this.showSortOptions=!1,setTimeout(()=>{this.updateSortPanelVisibility()},0)}toggleSortOptions(){this.showSortOptions=!this.showSortOptions,setTimeout(()=>{this.updateSortPanelVisibility()},0)}closeSortOptions(){this.showSortOptions=!1,setTimeout(()=>{this.updateSortPanelVisibility()},0)}updateSortPanelVisibility(){this.showPartsSortOptions=this.showSortOptions&&this.activeTab==="parts",this.showSparePartsSortOptions=this.showSortOptions&&this.activeTab==="spare-parts",this.showMinifigsSortOptions=this.showSortOptions&&this.activeTab==="minifigs"}migrateSparePartsData(n,e){if(!n.partsOwned)return n;let t=!1,i=U({},n.partsOwned);if(e.forEach(d=>{if(d.is_spare){let m=`${d.part_num}_${d.color_id}`,p=this.getPartStorageKey(d.part_num,d.color_id,!0);m in i&&!(p in i)&&(i[p]=i[m],t=!0)}}),t){let d=B(U({},n),{partsOwned:i,lastUpdated:Date.now()});return this.storageService.updateUserInventory(d),d}return n}preloadAllMinifigParts(){if(!this.minifigs||this.minifigs.length===0)return;let n=this.dataService.getCurrentInventories();this.minifigs.forEach(e=>{let t=e.minifig.fig_num;if(this.minifigPartsCache.has(t))return;let i=n.find(d=>d.set_num===t);i&&this.loadMinifigPartsAsync(t,i.id)})}loadStandardInventoryData(){this.route.paramMap.pipe(H(n=>{let e=n.get("id");return e?this.storageService.getState().pipe(J(t=>(this.globalSettings=U({},t.globalSettings),t.userInventories.find(d=>d.id===e)||null))):R(null)}),H(n=>n?(this.userInventory=n,this.updateCounts(),this.applySorting(),this.filterParts(),this.updateCanUndo(),this.userInventory.minifigPartsOwned||(this.userInventory.minifigPartsOwned={}),this.loadMinifigPartsState(),this.dataService.isDataLoaded().pipe(de(e=>e===!0),H(()=>this.loadInventoryData(n)))):(this.loading=!1,R(null)))).subscribe({next:n=>{n&&(this.parts=n.parts,this.spareParts=n.spareParts,this.minifigs=n.minifigs,this.filteredParts=this.parts,this.set=n.set,this.loadSortPreferences(),this.loadViewPreferences(),this.applySorting(),this.updateCounts(),this.preloadAllMinifigParts()),this.loading=!1},error:n=>{console.error("Error loading inventory details:",n),this.loading=!1}})}loadMissingPartsData(){this.storageService.getState().pipe(H(n=>(this.globalSettings=U({},n.globalSettings),this.userInventories=n.userInventories,this.userInventories.length===0?(this.loading=!1,R(null)):this.dataService.isDataLoaded().pipe(de(e=>e===!0),H(()=>this.loadAllMissingItemsData()))))).subscribe({next:n=>{n&&(this.parts=n.parts,this.spareParts=n.spareParts,this.minifigs=n.minifigs,this.filteredParts=this.parts,this.loadDefaultPreferencesForMissingMode(),this.applySorting(),this.updateCounts(),this.loadMinifigPartsState(),this.preloadAllMinifigParts()),this.loading=!1},error:n=>{console.error("Error loading missing parts data:",n),this.loading=!1}})}loadInventoryData(n){let e=this.dataService.getCurrentInventories(),t=e.filter(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()),i=this.dataService.getCurrentInventories().find(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()&&Number(h.version)===Number(n.version));if(!i)return console.error("InventoryDetailComponent: No inventory found for",n.set_num,"version",n.version),R(null);this.inventory=i;let d=this.dataService.getCurrentSets().find(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()),m=this.dataService.getCurrentInventoryParts(),p=e.filter(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()),f=i,w=m.filter(h=>h.inventory_id===i.id).length;return w===0&&(p.forEach(h=>{let x=m.filter(C=>C.inventory_id===h.id).length;x>w&&(w=x,f=h)}),f.id!==i.id&&(console.log(`Switching from version ${i.version} (${i.id}) to version ${f.version} (${f.id}) which has ${w} parts`),this.inventory=f)),re({inventoryParts:this.dataService.getInventoryPartsFromCache(f.id),inventoryMinifigs:this.dataService.getInventoryMinifigsFromCache(f.id)}).pipe(J(h=>{let{inventoryParts:x,inventoryMinifigs:C}=h;n=this.migrateSparePartsData(n,x);let S=this.dataService.getCurrentParts(),k=this.dataService.getCurrentColors(),V=this.dataService.getCurrentElements(),E=this.dataService.getCurrentMinifigs(),N=new Map(S.map(b=>[b.part_num,b])),F=new Map(k.map(b=>[b.id,b])),M=new Map(V.map(b=>[`${b.part_num}_${b.color_id}`,b.element_id])),L=new Map(E.map(b=>[b.fig_num,b])),A=[],z=[];for(let b of x){let K=N.get(b.part_num),ne=F.get(b.color_id);if(K&&ne){let ke=this.getPartStorageKey(b.part_num,b.color_id,b.is_spare),Ve=n.partsOwned[ke]||0,Ne=M.get(`${b.part_num}_${b.color_id}`),ce={inventoryPart:b,part:K,color:ne,imageUrl:b.img_url,quantityNeeded:b.quantity,quantityOwned:Ve,elementId:Ne,setName:d?.name,setNum:d?.set_num,inventoryId:i.id.toString()};b.is_spare===!0?z.push(ce):A.push(ce)}}let Y=[];for(let b of C){let K=L.get(b.fig_num);if(K){let ne=n.minifigsOwned[b.fig_num]||0;Y.push({inventoryMinifig:b,minifig:K,imageUrl:K.img_url,quantityNeeded:b.quantity,quantityOwned:ne,setName:d?.name,setNum:d?.set_num,inventoryId:i.id.toString()})}}let ie=new Set;if([...A,...z].forEach(b=>{ie.add(b.color.id)}),d){let b=this.dataService.getCurrentThemes();this.theme=b.find(K=>K.id===d.theme_id)||null}return this.uniqueColorsCount=ie.size,{parts:A,spareParts:z,minifigs:Y,set:d||null}}))}loadAllMissingItemsData(){let n=this.dataService.getCurrentInventories(),e=this.dataService.getCurrentParts(),t=this.dataService.getCurrentColors(),i=this.dataService.getCurrentElements(),d=this.dataService.getCurrentMinifigs(),m=new Map(e.map(x=>[x.part_num,x])),p=new Map(t.map(x=>[x.id,x])),f=new Map(i.map(x=>[`${x.part_num}_${x.color_id}`,x.element_id])),w=new Map(d.map(x=>[x.fig_num,x])),h=this.userInventories.map(x=>{let C=n.find(S=>S.set_num===x.set_num&&Number(S.version)===Number(x.version));return C?re({inventoryParts:this.dataService.getInventoryPartsFromCache(C.id),inventoryMinifigs:this.dataService.getInventoryMinifigsFromCache(C.id)}).pipe(J(S=>{let{inventoryParts:k,inventoryMinifigs:V}=S,E=[],N=[];for(let M of k){let L=this.getPartStorageKey(M.part_num,M.color_id,M.is_spare),A=x.partsOwned[L]||0;if(A<M.quantity){let z=m.get(M.part_num),Y=p.get(M.color_id);if(z&&Y){let ie=f.get(`${M.part_num}_${M.color_id}`),b={inventoryPart:M,part:z,color:Y,imageUrl:M.img_url,quantityNeeded:M.quantity,quantityOwned:A,elementId:ie,setName:x.name,setNum:x.set_num,inventoryId:x.id};M.is_spare===!0?N.push(b):E.push(b)}}}let F=[];for(let M of V){let L=x.minifigsOwned[M.fig_num]||0;if(L<M.quantity){let A=w.get(M.fig_num);A&&F.push({inventoryMinifig:M,minifig:A,imageUrl:A.img_url,quantityNeeded:M.quantity,quantityOwned:L,setName:x.name,setNum:x.set_num,inventoryId:x.id})}}return{parts:E,spareParts:N,minifigs:F}})):R({parts:[],spareParts:[],minifigs:[]})});return re(h).pipe(J(x=>{let C=[],S=[],k=[];return x.forEach(({parts:V,spareParts:E,minifigs:N})=>{C.push(...V),S.push(...E),k.push(...N)}),{parts:C,spareParts:S,minifigs:k,set:null}}))}loadDefaultPreferencesForMissingMode(){this.initializeDefaultSorting(),this.partsViewType="tiles",this.minifigsViewType="tiles",this.sparePartsViewType="tiles"}ngOnInit(){return le(this,null,function*(){try{let n=this.route.snapshot,e=n.paramMap.get("id");this.isMissingPartsMode=n.url.some(t=>t.path==="missing-parts"),setTimeout(()=>{this.updateSortPanelVisibility()},0),this.isMissingPartsMode?yield this.loadMissingPartsData():e&&(yield this.loadStandardInventoryData()),this.setupKeyboardListeners()}catch(n){console.error("Error in ngOnInit:",n)}finally{this.loading=!1}})}setupKeyboardListeners(){document.addEventListener("keydown",this.handleKeyDown.bind(this))}ngOnDestroy(){document.removeEventListener("keydown",this.handleKeyDown.bind(this))}handleKeyDown(n){n.key==="z"&&(n.metaKey||n.ctrlKey)&&!n.shiftKey&&(n.preventDefault(),this.performUndo())}addUndoAction(n){this.userInventory&&(this.userInventory.undoHistory||(this.userInventory.undoHistory=[]),this.userInventory.undoHistory.unshift(n),this.userInventory.undoHistory.length>this.maxUndoHistory&&(this.userInventory.undoHistory=this.userInventory.undoHistory.slice(0,this.maxUndoHistory)),this.updateCanUndo(),this.saveUserInventory())}updateCanUndo(){this.canUndo=this.userInventory?.undoHistory&&this.userInventory.undoHistory.length>0||!1}performUndo(){if(!this.userInventory?.undoHistory||this.userInventory.undoHistory.length===0)return;let n=this.userInventory.undoHistory.shift();n&&(n.type==="part"?this.updatePartQuantityInternal(n.key,n.previousQuantity):n.type==="minifig"?this.updateMinifigQuantityInternal(n.key,n.previousQuantity):n.type==="minifig-part"&&this.updateMinifigPartQuantityInternal(n.key,n.previousQuantity),this.updateCanUndo(),this.saveUserInventory(),this.showUndoNotificationMessage(`Undone: ${n.description}`))}showUndoNotificationMessage(n){this.undoNotificationMessage=n,this.showUndoNotification=!0,setTimeout(()=>{this.showUndoNotification=!1},3e3)}saveUserInventory(){this.userInventory&&this.storageService.updateUserInventory(this.userInventory)}updatePartQuantityInternal(n,e){if(!this.userInventory)return;this.userInventory.partsOwned[n]=e;let t=this.parts.find(d=>this.getPartStorageKey(d.inventoryPart.part_num,d.inventoryPart.color_id,d.inventoryPart.is_spare)===n);t&&(t.quantityOwned=e);let i=this.spareParts.find(d=>this.getPartStorageKey(d.inventoryPart.part_num,d.inventoryPart.color_id,d.inventoryPart.is_spare)===n);i&&(i.quantityOwned=e),this.updateCounts(),this.filterParts()}updateMinifigQuantityInternal(n,e){if(!this.userInventory)return;this.userInventory.minifigsOwned[n]=e;let t=this.minifigs.find(i=>i.inventoryMinifig.fig_num===n);t&&(t.quantityOwned=e),this.updateCounts()}updateMinifigPartQuantityInternal(n,e){if(!this.userInventory)return;this.userInventory.minifigPartsOwned[n]=e;let t=n.split("_");if(t.length>=4){let i=t[1],d=t[2],m=Number(t[3]),p=this.minifigPartsCache.get(i);if(p){let f=p.find(w=>w.inventoryPart.part_num===d&&w.inventoryPart.color_id===m);f&&(f.quantityOwned=e,this.minifigPartsCache.set(i,this.sortMinifigParts([...p])))}}this.updateCounts()}static \u0275fac=function(e){return new(e||s)(Z(we),Z(De),Z(Se),Z(ve))};static \u0275cmp=_e({type:s,selectors:[["app-inventory-detail"]],decls:18,vars:9,consts:[["noPartsFound",""],["noSpareParts",""],["noMinifigs",""],[2,"width","100%","max-width","none","display","block"],["class","flex items-center justify-center py-16 px-4 min-h-screen bg-gray-50",4,"ngIf"],["class","bg-white shadow-md rounded-lg p-6 max-w-4xl mx-auto my-8",4,"ngIf"],["class","bg-white py-8 w-full min-h-screen","style","min-width: 600px;",4,"ngIf"],["class","bg-white py-8 w-full min-h-screen","style","min-width: 600px; width: 100%; max-width: none;",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",3,"click",4,"ngIf"],[1,"fixed","bottom-6","right-6","flex","flex-col","space-y-3","z-40"],["title","Scroll to top",1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","duration-200","hover:scale-110",3,"click"],[1,"text-lg"],["title","Scroll to bottom",1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","duration-200","hover:scale-110",3,"click"],[1,"relative"],["class","w-12 h-12 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-100 disabled:hover:scale-100",3,"disabled","title","click",4,"ngIf"],["class","absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",4,"ngIf"],["class","fixed top-20 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",4,"ngIf"],[1,"flex","items-center","justify-center","py-16","px-4","min-h-screen","bg-gray-50"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto","mb-4"],["class","text-gray-600 mb-2",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-gray-400","mt-2"],[1,"text-gray-600","mb-2"],[1,"bg-white","shadow-md","rounded-lg","p-6","max-w-4xl","mx-auto","my-8"],[1,"text-2xl","font-bold","text-gray-800","mb-4"],[1,"text-gray-600","mb-6"],["routerLink","/sets",1,"bg-blue-600","text-white","px-4","py-2","rounded-md","hover:bg-blue-700","transition"],[1,"bg-white","py-8","w-full","min-h-screen",2,"min-width","600px"],[1,"px-1","sm:px-2","text-center","py-8"],[1,"text-3xl","font-bold","text-gray-800","mb-4"],[1,"text-lg","text-gray-600","mb-4"],[1,"bg-white","py-8","w-full","min-h-screen",2,"min-width","600px","width","100%","max-width","none"],[1,"px-1","sm:px-2"],["class","mb-6 flex flex-col md:flex-row md:items-center md:justify-between",4,"ngIf"],["class","mb-6",4,"ngIf"],[1,"border-b","border-gray-200","mb-6"],[1,"flex","space-x-8"],[1,"py-4","px-1","border-b-2","font-medium","text-sm","focus:outline-none",3,"click"],[4,"ngIf"],["class","ml-1 text-red-500",4,"ngIf"],[1,"mb-6","flex","flex-col","md:flex-row","md:items-center","md:justify-between"],[1,"flex","items-start","space-x-4"],["class","flex-shrink-0",4,"ngIf"],[1,"flex-1"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600","mt-1"],[1,"flex","flex-wrap","gap-4","mt-2","text-sm","text-gray-600"],[1,"text-gray-500","text-sm","mt-1"],[1,"mt-4"],[1,"mt-4","md:mt-0","flex","flex-col","md:flex-row","md:items-center","space-y-2","md:space-y-0","md:space-x-4"],["target","_blank","rel","noopener noreferrer",1,"text-green-600","hover:underline","flex","items-center",3,"href"],[1,"mr-1"],["routerLink","/sets",1,"text-blue-600","hover:underline"],[1,"flex-shrink-0"],[1,"w-24","h-24","bg-gray-100","rounded-lg","overflow-hidden","flex","items-center","justify-center","cursor-pointer",3,"click"],[1,"w-full","h-full","object-contain","hover:opacity-80","transition-opacity",3,"error","src","alt"],[1,"text-center","mt-1"],[1,"text-xs","text-gray-400"],["href","https://rebrickable.com","target","_blank","rel","noopener noreferrer",1,"text-blue-500","hover:text-blue-400"],[1,"flex","justify-between","text-sm","text-gray-600","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-3"],[1,"h-3","rounded-full","transition-all","duration-300"],[1,"space-y-3"],[1,"flex","justify-between","text-sm","text-gray-500","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"h-2","rounded-full","transition-all","duration-300"],[1,"mb-6"],[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between"],[1,"text-3xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600"],[1,"text-sm","text-gray-500","mt-2"],[1,"mt-4","md:mt-0"],[1,"ml-1","text-red-500"],[1,"flex","flex-col","md:flex-row","md:items-center","mb-6","space-y-4","md:space-y-0","md:space-x-4"],["type","text","placeholder","Search parts...",1,"px-4","py-2","border","rounded-md","w-full","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","space-x-2"],[1,"flex","border","rounded-md","overflow-hidden"],[1,"px-3","py-2","text-sm","transition",3,"click"],[1,"bg-gray-600","text-white","px-3","py-2","rounded-md","hover:bg-gray-700","transition","text-sm",3,"click"],[1,"bg-green-600","text-white","px-3","py-2","rounded-md","hover:bg-green-700","transition","text-sm",3,"click"],[1,"bg-red-600","text-white","px-3","py-2","rounded-md","hover:bg-red-700","transition","text-sm",3,"click"],["class","bg-gray-50 border rounded-lg p-4 mb-6",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"bg-gray-50","border","rounded-lg","p-4","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-medium","text-gray-800"],[1,"text-sm","text-blue-600","hover:underline",3,"click"],["class","flex items-center space-x-3",4,"ngFor","ngForOf"],["class","flex justify-start",4,"ngIf"],[1,"flex","justify-end","space-x-2","mt-4"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","text-sm",3,"click"],[1,"bg-blue-600","text-white","px-4","py-2","rounded","hover:bg-blue-700","transition","text-sm",3,"click"],[1,"flex","items-center","space-x-3"],[1,"text-sm","font-medium","text-gray-700","w-8"],[1,"flex-1","px-3","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm",3,"ngModelChange","ngModel"],[3,"value","disabled",4,"ngFor","ngForOf"],[1,"px-3","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm",3,"change","value"],["value","asc"],["value","desc"],["class","text-red-600 hover:text-red-800 text-sm px-2 py-1",3,"click",4,"ngIf"],[3,"value","disabled"],[1,"text-red-600","hover:text-red-800","text-sm","px-2","py-1",3,"click"],[1,"flex","justify-start"],[1,"text-blue-600","hover:text-blue-800","text-sm",3,"click"],["class","grid gap-2 sm:gap-3 md:gap-4","style","grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));",4,"ngIf"],["class","bg-white border rounded-lg overflow-hidden w-full",4,"ngIf"],[1,"grid","gap-2","sm:gap-3","md:gap-4",2,"grid-template-columns","repeat(auto-fill, minmax(240px, 1fr))"],["class","border rounded-lg overflow-hidden",3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border","rounded-lg","overflow-hidden"],[1,"p-4"],[3,"click"],[1,"w-full","h-full","object-contain","hover:opacity-80","transition-opacity",3,"src","alt"],[1,"font-medium","text-gray-800"],[1,"text-sm","text-gray-600"],["class","text-sm text-gray-600",4,"ngIf"],["class","text-sm text-blue-600 font-medium",4,"ngIf"],[1,"mb-3"],[1,"flex","items-center","space-x-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","items-center","space-x-1"],[1,"w-8","h-8","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-sm","font-bold",3,"click","disabled"],["type","number",1,"w-16","px-2","py-1","text-center","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm",3,"input","focus","value","min","max"],[1,"flex","items-center","justify-center","space-x-2","mt-2"],["title","Mark as complete",1,"w-8","h-6","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-8","h-6","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[1,"mt-3","text-center"],[1,"text-sm","font-medium"],[1,"text-sm","text-blue-600","font-medium"],[1,"bg-white","border","rounded-lg","overflow-hidden","w-full"],[1,"overflow-x-auto"],[1,"w-full","divide-y","divide-gray-200","table-auto"],[1,"bg-gray-50"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-48"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-28"],["class","px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider w-32",4,"ngIf"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-32"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-36"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-24"],[1,"bg-white","divide-y","divide-gray-200"],[3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"px-2","py-2","w-48"],[1,"flex","items-center"],[1,"min-w-0","flex-1"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-2","py-2","whitespace-nowrap","w-28"],[1,"text-sm","text-gray-900","truncate"],["class","px-2 py-2 whitespace-nowrap w-32",4,"ngIf"],[1,"px-2","py-2","whitespace-nowrap","w-32"],[1,"w-full","bg-gray-200","rounded-full","h-1.5","mb-1"],[1,"h-1.5","rounded-full","transition-all","duration-300"],[1,"text-sm","text-gray-500","text-center"],[1,"px-2","py-2","whitespace-nowrap","w-36"],[1,"flex","items-center","justify-center","space-x-1"],[1,"w-6","h-6","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-sm","font-bold","border","flex-shrink-0",3,"click","disabled"],["type","number",1,"w-10","px-1","py-0.5","text-center","border","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-sm","flex-shrink-0",3,"input","focus","value","min","max"],[1,"px-2","py-2","whitespace-nowrap","w-24","text-center"],["title","Mark as complete",1,"w-6","h-5","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-6","h-5","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[1,"text-center","py-8","bg-gray-50","rounded-lg"],[1,"text-lg","text-gray-600"],["class","mt-4 text-blue-600 hover:underline",3,"click",4,"ngIf"],[1,"mt-4","text-blue-600","hover:underline",3,"click"],[1,"text-sm","text-orange-600"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-20"],[1,"mt-4","text-center"],[1,"bg-blue-600","text-white","px-3","py-2","rounded-md","hover:bg-blue-700","transition","text-sm","flex","items-center","mx-auto",3,"click"],["class","mr-1",4,"ngIf"],["class","border-t border-gray-200 mt-2",4,"ngIf"],[1,"border-t","border-gray-200","mt-2"],[1,"p-4","bg-gray-50"],[1,"text-sm","font-medium","text-gray-800","mb-3"],[1,"grid","gap-2",2,"grid-template-columns","repeat(auto-fill, minmax(180px, 1fr))"],["class","border rounded-lg overflow-hidden bg-white",3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf"],[1,"border","rounded-lg","overflow-hidden","bg-white"],[1,"p-3"],[1,"flex","items-start","mb-3"],[1,"flex-1","min-w-0"],[1,"text-xs","font-medium","text-gray-800","truncate"],[1,"text-xs","text-gray-600","truncate"],[1,"mb-2"],[1,"flex","justify-between","text-xs","text-gray-600","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"w-6","h-6","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-xs","font-bold",3,"click","disabled"],["type","number",1,"w-12","px-1","py-0.5","text-center","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-xs",3,"input","focus","value","min","max"],[1,"mt-2","text-center"],[1,"text-xs","font-medium"],[1,"flex","items-center","justify-center","space-x-1","mt-2"],["title","Mark as complete",1,"w-6","h-4","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-6","h-4","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"px-2","py-2","whitespace-nowrap","w-24"],[1,"text-sm","text-gray-900"],[1,"bg-blue-600","text-white","px-2","py-1","rounded","text-xs","hover:bg-blue-700","transition","flex","items-center",3,"click"],["class","bg-gray-50",4,"ngIf"],[1,"px-2","py-4"],[1,"pl-6"],[1,"bg-white","border","rounded","overflow-hidden"],[1,"w-full","divide-y","divide-gray-200"],[1,"bg-gray-100"],[1,"px-2","py-2","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf"],[1,"px-2","py-2"],[1,"text-xs","font-medium","text-gray-900","truncate"],[1,"text-xs","text-gray-500","truncate"],[1,"px-2","py-2","whitespace-nowrap"],[1,"text-xs","text-gray-900","truncate"],[1,"w-full","bg-gray-200","rounded-full","h-1","mb-1"],[1,"h-1","rounded-full","transition-all","duration-300"],[1,"text-xs","text-gray-500","text-center"],[1,"w-5","h-5","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-xs","font-bold",3,"click","disabled"],["type","number",1,"w-8","px-1","py-0.5","text-center","border","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-xs",3,"input","focus","value","min","max"],[1,"px-2","py-2","whitespace-nowrap","text-center"],["title","Mark as complete",1,"w-5","h-4","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-5","h-4","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[1,"fixed","inset-0","bg-black","bg-opacity-75","flex","items-center","justify-center","z-50",3,"click"],[1,"relative","max-w-4xl","max-h-4xl","p-4"],[1,"absolute","top-2","right-2","text-white","hover:text-gray-300","text-2xl","font-bold","z-10","bg-black","bg-opacity-50","rounded-full","w-8","h-8","flex","items-center","justify-center",3,"click"],[1,"max-w-full","max-h-full","object-contain",2,"max-width","800px","max-height","800px",3,"src","alt"],[1,"absolute","bottom-2","left-2","right-2","bg-black","bg-opacity-75","text-white","text-xs","p-2","rounded"],["href","https://rebrickable.com","target","_blank","rel","noopener noreferrer",1,"text-blue-300","hover:text-blue-100","underline"],[1,"w-12","h-12","bg-orange-600","hover:bg-orange-700","disabled:bg-gray-400","disabled:cursor-not-allowed","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","duration-200","hover:scale-100","disabled:hover:scale-100",3,"click","disabled","title"],[1,"absolute","-top-1","-right-1","bg-red-500","text-white","text-xs","rounded-full","w-5","h-5","flex","items-center","justify-center","font-bold"],[1,"fixed","top-20","left-1/2","transform","-translate-x-1/2","bg-green-600","text-white","px-6","py-3","rounded-lg","shadow-lg","z-50","transition-all","duration-300"]],template:function(e,t){e&1&&(r(0,"div",3),y(1,Fe,9,2,"div",4)(2,Ae,7,0,"div",5)(3,Qe,8,0,"div",6)(4,je,8,0,"div",6)(5,yi,21,32,"div",7)(6,xi,10,2,"div",8),r(7,"div",9)(8,"button",10),g("click",function(){return t.scrollToTop()}),r(9,"span",11),l(10,"\u2191"),a()(),r(11,"button",12),g("click",function(){return t.scrollToBottom()}),r(12,"span",11),l(13,"\u2193"),a()(),r(14,"div",13),y(15,hi,3,2,"button",14)(16,wi,2,1,"span",15),a()(),y(17,bi,6,1,"div",16),a()),e&2&&(o(),_("ngIf",t.loading),o(),_("ngIf",!t.loading&&!t.userInventory&&!t.isMissingPartsMode),o(),_("ngIf",!t.loading&&t.isMissingPartsMode&&t.userInventories.length===0),o(),_("ngIf",!t.loading&&t.isMissingPartsMode&&t.userInventories.length>0&&t.parts.length===0&&t.spareParts.length===0&&t.minifigs.length===0),o(),_("ngIf",!t.loading&&(!t.isMissingPartsMode&&t.userInventory||t.isMissingPartsMode&&t.userInventories.length>0&&(t.parts.length>0||t.spareParts.length>0||t.minifigs.length>0))),o(),_("ngIf",t.showImageOverlay),o(9),_("ngIf",!t.isMissingPartsMode),o(),_("ngIf",!t.isMissingPartsMode&&t.canUndo&&((t.userInventory==null||t.userInventory.undoHistory==null?null:t.userInventory.undoHistory.length)||0)>0),o(),_("ngIf",t.showUndoNotification))},dependencies:[he,ge,fe,xe,ye,be,qe,Me,Ee,Ie,Oe,Pe,Ce],encapsulation:2})};export{Te as InventoryDetailComponent};
