import{b as wt,d as bt}from"./chunk-NDD7MLKR.js";import{a as It,b as Pt,c as Ct,d as Ot,e as Mt,f as Et,g as Dt}from"./chunk-J267KXJP.js";import{b as qt}from"./chunk-HLEASSE4.js";import{$ as v,Aa as Z,Ea as ct,Fb as gt,Gb as ft,Hb as yt,Ia as y,Ib as xt,J as H,Jb as ht,Na as mt,Oa as c,Pa as j,Qa as P,Ra as $,Rb as St,Sa as r,Ta as a,Ua as q,Va as pt,Wa as ut,Xa as O,Ya as g,Za as _,_ as u,a as U,b as B,bb as at,c as lt,cb as l,db as D,eb as I,fb as T,gb as ot,hb as X,ib as tt,jb as et,l as R,nb as W,pb as G,qb as st,r as J,sb as vt,ua as Q,wa as s,x as rt,y as dt}from"./chunk-YEQZILZB.js";function $t(o,n){o&1&&(r(0,"p",23),l(1,"Loading Inventory..."),a())}function Ut(o,n){o&1&&(r(0,"p",23),l(1,"Loading Missing Parts..."),a())}function Ft(o,n){if(o&1&&(r(0,"div",17)(1,"div",18),q(2,"div",19),y(3,$t,2,0,"p",20)(4,Ut,2,0,"p",20),r(5,"p",21),l(6,"Loading large datasets may take a moment"),a(),r(7,"p",22),l(8,"Processing CSV files and building cache..."),a()()()),o&2){let t=_();s(3),c("ngIf",!t.isMissingPartsMode),s(),c("ngIf",t.isMissingPartsMode)}}function At(o,n){o&1&&(r(0,"div",24)(1,"h1",25),l(2,"Inventory Not Found"),a(),r(3,"p",26),l(4,"The inventory you're looking for does not exist or has been removed."),a(),r(5,"a",27),l(6," Back to Sets "),a()())}function Qt(o,n){o&1&&(r(0,"div",28)(1,"div",29)(2,"h1",30),l(3,"Missing Parts"),a(),r(4,"p",31),l(5,"You don't have any sets in your inventory yet."),a(),r(6,"a",27),l(7," Browse Sets "),a()()())}function jt(o,n){o&1&&(r(0,"div",28)(1,"div",29)(2,"h1",30),l(3,"Missing Parts"),a(),r(4,"p",31),l(5,"You have all parts for your sets. Great job!"),a(),r(6,"a",27),l(7," View My Sets "),a()()())}function Bt(o,n){if(o&1){let t=O();r(0,"div",54)(1,"div",55),g("click",function(){u(t);let i=_(3);return v(i.openImageOverlay((i.set==null?null:i.set.img_url)||"",(i.set==null?null:i.set.name)||"Set image"))}),r(2,"img",56),g("error",function(i){u(t);let d=_(3);return v(d.onImageError(i))}),a()(),r(3,"div",57)(4,"p",58),l(5," Image \xA9 "),r(6,"a",59),l(7,"Rebrickable"),a()()()()}if(o&2){let t=_(3);s(2),c("src",(t.set==null?null:t.set.img_url)||"",Q)("alt",(t.set==null?null:t.set.name)||"Set image")}}function Lt(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(3);s(),I("Year: ",t.set==null?null:t.set.year,"")}}function zt(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(3);s(),I("Theme: ",t.theme==null?null:t.theme.name,"")}}function Kt(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(3);s(),I("Parts: ",t.set==null?null:t.set.num_parts,"")}}function Rt(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(3);s(),I("Colors: ",t.uniqueColorsCount,"")}}function Ht(o,n){if(o&1&&(r(0,"div")(1,"div",60)(2,"span"),l(3,"Overall Progress"),a(),r(4,"span"),l(5),W(6,"number"),a()(),r(7,"div",61),q(8,"div",62),a()()),o&2){let t=_(3);s(5),ot("",t.totalPartsOwned+t.totalSparePartsOwned+t.totalMinifigsOwned," / ",t.totalPartsNeeded+t.totalSparePartsNeeded+t.totalMinifigsNeeded," items (",G(6,11,t.overallProgress,"1.1-1"),"%)"),s(3),j("width",t.overallProgress,"%"),P("bg-green-500",t.overallProgress>=100)("bg-yellow-500",t.overallProgress>0&&t.overallProgress<100)("bg-red-500",t.overallProgress===0)}}function Wt(o,n){if(o&1&&(r(0,"div")(1,"div",64)(2,"span"),l(3,"Spare Parts Progress"),a(),r(4,"span"),l(5),W(6,"number"),a()(),r(7,"div",65),q(8,"div",66),a()()),o&2){let t=_(4);s(5),ot("",t.totalSparePartsOwned," / ",t.totalSparePartsNeeded," items (",t.totalSparePartsNeeded>0?t.totalSparePartsOwned/t.totalSparePartsNeeded*100:G(6,11,0,"1.1-1"),"%)"),s(3),j("width",t.totalSparePartsNeeded>0?t.totalSparePartsOwned/t.totalSparePartsNeeded*100:0,"%"),P("bg-green-400",t.totalSparePartsOwned>=t.totalSparePartsNeeded)("bg-yellow-400",t.totalSparePartsOwned>0&&t.totalSparePartsOwned<t.totalSparePartsNeeded)("bg-red-400",t.totalSparePartsOwned===0)}}function Gt(o,n){if(o&1&&(r(0,"div")(1,"div",63)(2,"div")(3,"div",60)(4,"span"),l(5,"Main Progress (Parts + Minifigures)"),a(),r(6,"span"),l(7),W(8,"number"),a()(),r(9,"div",61),q(10,"div",62),a()(),y(11,Wt,9,14,"div",39),a()()),o&2){let t=_(3);s(7),ot("",t.totalPartsOwned+t.totalMinifigsOwned," / ",t.totalPartsNeeded+t.totalMinifigsNeeded," items (",G(8,12,t.overallProgress,"1.1-1"),"%)"),s(3),j("width",t.overallProgress,"%"),P("bg-green-500",t.overallProgress>=100)("bg-yellow-500",t.overallProgress>0&&t.overallProgress<100)("bg-red-500",t.overallProgress===0),s(),c("ngIf",t.totalSparePartsNeeded>0)}}function Yt(o,n){if(o&1&&(r(0,"div",41)(1,"div",42),y(2,Bt,8,2,"div",43),r(3,"div",44)(4,"h1",45),l(5),a(),r(6,"p",46),l(7),a(),r(8,"p",46),l(9),a(),r(10,"div",47),y(11,Lt,2,1,"span",39)(12,zt,2,1,"span",39)(13,Kt,2,1,"span",39)(14,Rt,2,1,"span",39),a(),r(15,"p",48),l(16),W(17,"date"),a(),r(18,"div",49),y(19,Ht,9,14,"div",39)(20,Gt,12,15,"div",39),a()()(),r(21,"div",50)(22,"a",51)(23,"span",52),l(24,"\u{1F517}"),a(),l(25," View on Rebrickable "),a(),r(26,"a",53),l(27,"Back to Sets"),a()()()),o&2){let t=_(2);s(2),c("ngIf",t.set==null?null:t.set.img_url),s(3),D(t.userInventory==null?null:t.userInventory.name),s(2),I("Set #: ",t.userInventory==null?null:t.userInventory.set_num,""),s(2),I("Version: ",t.userInventory==null?null:t.userInventory.version,""),s(2),c("ngIf",t.set==null?null:t.set.year),s(),c("ngIf",t.theme==null?null:t.theme.name),s(),c("ngIf",t.set==null?null:t.set.num_parts),s(),c("ngIf",t.uniqueColorsCount>0),s(2),I("Last updated: ",G(17,12,t.userInventory==null?null:t.userInventory.lastUpdated,"medium"),""),s(3),c("ngIf",t.globalSettings.includeSparePartsInProgress),s(),c("ngIf",!t.globalSettings.includeSparePartsInProgress),s(2),c("href","https://rebrickable.com/sets/"+(t.userInventory==null?null:t.userInventory.set_num),Q)}}function Jt(o,n){if(o&1&&(r(0,"div",67)(1,"div",68)(2,"div",44)(3,"h1",69),l(4,"Missing Parts"),a(),r(5,"p",70),l(6,"Track which parts and minifigures you still need for your building block sets"),a(),r(7,"p",71),l(8),a()(),r(9,"div",72)(10,"a",53),l(11,"Back to Sets"),a()()()()),o&2){let t=_(2);s(8),T("Showing missing items from ",t.userInventories.length," set",t.userInventories.length!==1?"s":"","")}}function Zt(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(2);s(),T("Parts (",t.totalPartsOwned,"/",t.totalPartsNeeded,")")}}function Xt(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(2);s(),I("Missing Parts (",t.parts.length,")")}}function te(o,n){if(o&1&&(r(0,"span",73),l(1),a()),o&2){let t=_(2);s(),I("",t.missingPartsCount," missing")}}function ee(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(2);s(),T("Spare Parts (",t.totalSparePartsOwned,"/",t.totalSparePartsNeeded,")")}}function ie(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(2);s(),I("Missing Spare Parts (",t.spareParts.length,")")}}function ne(o,n){if(o&1&&(r(0,"span",73),l(1),a()),o&2){let t=_(2);s(),I("",t.missingSparePartsCount," missing")}}function re(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(2);s(),T("Minifigures (",t.getTotalMinifigPartsProgress().owned,"/",t.getTotalMinifigPartsProgress().total,")")}}function ae(o,n){if(o&1&&(r(0,"span"),l(1),a()),o&2){let t=_(2);s(),I("Missing Minifigures (",t.minifigs.length,")")}}function oe(o,n){if(o&1&&(r(0,"span",73),l(1),a()),o&2){let t=_(2);s(),I("",t.getTotalMinifigPartsProgress().missing," parts missing")}}function se(o,n){if(o&1&&(r(0,"option",101),l(1),a()),o&2){let t=n.$implicit,e=_().index,i=_(4);c("value",t.value)("disabled",i.isFieldDisabled("parts",t.value,e)),s(),I(" ",t.label," ")}}function le(o,n){if(o&1){let t=O();r(0,"button",102),g("click",function(){u(t);let i=_().index,d=_(4);return v(d.removeSortOption("parts",i))}),l(1," \u2715 "),a()}}function de(o,n){if(o&1){let t=O();r(0,"div",93)(1,"span",94),l(2),a(),r(3,"select",95),et("ngModelChange",function(i){let d=u(t).$implicit;return tt(d.field,i)||(d.field=i),v(i)}),g("ngModelChange",function(i){let d=u(t),m=d.$implicit,p=d.index,f=_(4);return v(f.updateSortOption("parts",p,i,m.direction))}),y(4,se,2,3,"option",96),a(),r(5,"select",97),g("change",function(i){let d=u(t),m=d.$implicit,p=d.index,f=_(4);return v(f.updateSortOption("parts",p,m.field,i.target.value))}),r(6,"option",98),l(7,"Ascending"),a(),r(8,"option",99),l(9,"Descending"),a()(),y(10,le,2,0,"button",100),a()}if(o&2){let t=n.$implicit,e=n.index,i=_(4);s(2),I("",e+1,"."),s(),X("ngModel",t.field),s(),c("ngForOf",i.getAllFieldsForDropdown("parts")),s(),c("value",t.direction),s(5),c("ngIf",i.partsSortOptions.length>1)}}function _e(o,n){if(o&1){let t=O();r(0,"div",103)(1,"button",104),g("click",function(){u(t);let i=_(4);return v(i.addSortOption("parts"))}),l(2," + Add Sort Criteria "),a()()}}function ce(o,n){if(o&1){let t=O();r(0,"div",84)(1,"div",85)(2,"h3",86),l(3,"Sort Parts"),a(),r(4,"button",87),g("click",function(){u(t);let i=_(3);return v(i.resetToDefaultSort())}),l(5," Reset to Default "),a()(),r(6,"div",63),y(7,de,11,5,"div",88)(8,_e,3,0,"div",89),a(),r(9,"div",90)(10,"button",91),g("click",function(){u(t);let i=_(3);return v(i.closeSortOptions())}),l(11," Cancel "),a(),r(12,"button",92),g("click",function(){u(t);let i=_(3);return v(i.applySortChanges())}),l(13," Apply Sort "),a()()()}if(o&2){let t=_(3);s(7),c("ngForOf",t.partsSortOptions),s(),c("ngIf",t.partsSortOptions.length<3)}}function me(o,n){if(o&1&&(r(0,"p",114),l(1),a()),o&2){let t=_().$implicit;s(),I("Element ID: ",t.elementId,"")}}function pe(o,n){if(o&1&&(r(0,"p",128),l(1),a()),o&2){let t=_().$implicit;s(),T("From: ",t.setName," (",t.setNum,")")}}function ue(o,n){o&1&&(r(0,"span"),l(1,"\u2713 Complete"),a())}function ve(o,n){o&1&&(r(0,"span"),l(1,"\u26A0 Partial"),a())}function ge(o,n){o&1&&(r(0,"span"),l(1,"\u2717 Missing"),a())}function fe(o,n){if(o&1){let t=O();r(0,"div",109)(1,"div",110)(2,"div")(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),q(4,"img",112),a(),r(5,"div")(6,"h3",113),l(7),a(),r(8,"p",114),l(9),a(),r(10,"p",114),l(11),a(),y(12,me,2,1,"p",115)(13,pe,2,2,"p",116),a()(),r(14,"div",117)(15,"div",60)(16,"span"),l(17,"Progress"),a(),r(18,"span"),l(19),a()(),r(20,"div",65),q(21,"div",66),a()(),r(22,"div",118)(23,"label",119),l(24,"Owned:"),a(),r(25,"div",120)(26,"button",121),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(27," - "),a(),r(28,"input",122),g("input",function(i){let d=u(t).$implicit,m=_(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(t),v(i.target.select())}),a(),r(29,"button",121),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(30," + "),a()(),r(31,"span",21),l(32),a()(),r(33,"div",123)(34,"button",124),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(35," \u2713 "),a(),r(36,"button",125),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,0))}),l(37," \u2717 "),a()(),r(38,"div",126)(39,"span",127),y(40,ue,2,0,"span",39)(41,ve,2,0,"span",39)(42,ge,2,0,"span",39),a()()()()}if(o&2){let t=n.$implicit,e=_(5);P("bg-green-50",t.quantityOwned>=t.quantityNeeded)("bg-yellow-50",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-50",t.quantityOwned===0),s(2),$(e.shouldUseVerticalLayout()?"flex flex-col items-center mb-4":"flex items-start mb-4"),s(),$(e.getImageSizeClasses()+(e.shouldUseVerticalLayout()?" mb-3 flex-shrink-0 cursor-pointer":" mr-4 flex-shrink-0 cursor-pointer")),s(),c("src",t.imageUrl,Q)("alt",t.part.name),s(),$(e.shouldUseVerticalLayout()?"flex-1 text-center":"flex-1"),s(2),D(t.part.name),s(2),I("Part #: ",t.part.part_num,""),s(2),I("Color: ",t.color.name,""),s(),c("ngIf",t.elementId),s(),c("ngIf",e.isMissingPartsMode&&t.setName),s(6),T("",t.quantityOwned," / ",t.quantityNeeded,""),s(2),j("width",t.quantityOwned/t.quantityNeeded*100,"%"),P("bg-green-500",t.quantityOwned>=t.quantityNeeded)("bg-yellow-500",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-500",t.quantityOwned===0),s(5),c("disabled",t.quantityOwned<=0),s(2),c("value",t.quantityOwned)("min",0)("max",t.quantityNeeded),s(),c("disabled",t.quantityOwned>=t.quantityNeeded),s(3),I("/ ",t.quantityNeeded,""),s(2),c("disabled",t.quantityOwned>=t.quantityNeeded),s(2),c("disabled",t.quantityOwned===0),s(3),P("text-green-600",t.quantityOwned>=t.quantityNeeded)("text-yellow-600",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("text-red-600",t.quantityOwned===0),s(),c("ngIf",t.quantityOwned>=t.quantityNeeded),s(),c("ngIf",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded),s(),c("ngIf",t.quantityOwned===0)}}function ye(o,n){if(o&1&&(r(0,"div",107),y(1,fe,43,46,"div",108),a()),o&2){let t=_(4);s(),c("ngForOf",t.filteredParts)("ngForTrackBy",t.trackByPartId)}}function xe(o,n){o&1&&(r(0,"th",136),l(1,"Set"),a())}function he(o,n){if(o&1&&(r(0,"td",148)(1,"div",146),l(2),a()()),o&2){let t=_().$implicit;s(2),T("",t.setName," (",t.setNum,")")}}function we(o,n){if(o&1){let t=O();r(0,"tr")(1,"td",141)(2,"div",142)(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),q(4,"img",112),a(),r(5,"div",143)(6,"div",144),l(7),a(),r(8,"div",21),l(9),a()()()(),r(10,"td",145)(11,"div",146),l(12),a()(),r(13,"td",145)(14,"div",146),l(15),a()(),y(16,he,3,2,"td",147),r(17,"td",148)(18,"div",149),q(19,"div",150),a(),r(20,"div",151),l(21),a()(),r(22,"td",152)(23,"div",153)(24,"button",154),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(25," - "),a(),r(26,"input",155),g("input",function(i){let d=u(t).$implicit,m=_(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(t),v(i.target.select())}),a(),r(27,"button",154),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(28," + "),a()()(),r(29,"td",156)(30,"div",153)(31,"button",157),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(32," \u2713 "),a(),r(33,"button",158),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,0))}),l(34," \u2717 "),a()()()()}if(o&2){let t=n.$implicit,e=_(5);P("bg-green-50",t.quantityOwned>=t.quantityNeeded)("bg-yellow-50",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-50",t.quantityOwned===0),s(3),$(e.getListImageSizeClasses()+" mr-2 flex-shrink-0 cursor-pointer"),s(),c("src",t.imageUrl,Q)("alt",t.part.name),s(3),D(t.part.name),s(2),D(t.part.part_num),s(3),D(t.color.name),s(3),D(t.elementId),s(),c("ngIf",e.isMissingPartsMode),s(3),j("width",t.quantityOwned/t.quantityNeeded*100,"%"),P("bg-green-500",t.quantityOwned>=t.quantityNeeded)("bg-yellow-500",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-500",t.quantityOwned===0),s(2),T("",t.quantityOwned,"/",t.quantityNeeded," "),s(3),c("disabled",t.quantityOwned<=0),s(2),c("value",t.quantityOwned)("min",0)("max",t.quantityNeeded),s(),c("disabled",t.quantityOwned>=t.quantityNeeded),s(4),c("disabled",t.quantityOwned>=t.quantityNeeded),s(2),c("disabled",t.quantityOwned===0)}}function be(o,n){if(o&1&&(r(0,"div",129)(1,"div",130)(2,"table",131)(3,"thead",132)(4,"tr")(5,"th",133),l(6,"Part "),a(),r(7,"th",134),l(8," Color"),a(),r(9,"th",134),l(10," Element ID"),a(),y(11,xe,2,0,"th",135),r(12,"th",136),l(13," Progress"),a(),r(14,"th",137),l(15," Quantity"),a(),r(16,"th",138),l(17," Actions"),a()()(),r(18,"tbody",139),y(19,we,35,32,"tr",140),a()()()()),o&2){let t=_(4);s(11),c("ngIf",t.isMissingPartsMode),s(8),c("ngForOf",t.filteredParts)("ngForTrackBy",t.trackByPartId)}}function Se(o,n){if(o&1&&(r(0,"div"),y(1,ye,2,2,"div",105)(2,be,20,3,"div",106),a()),o&2){let t=_(3);s(),c("ngIf",t.partsViewType==="tiles"),s(),c("ngIf",t.partsViewType==="list")}}function Ie(o,n){if(o&1){let t=O();r(0,"button",162),g("click",function(){u(t);let i=_(4);return i.searchTerm="",v(i.filterParts())}),l(1," Clear Search "),a()}}function Pe(o,n){if(o&1&&(r(0,"div",159)(1,"p",160),l(2,"No parts found matching your search criteria."),a(),y(3,Ie,2,0,"button",161),a()),o&2){let t=_(3);s(3),c("ngIf",t.searchTerm)}}function Ce(o,n){if(o&1){let t=O();r(0,"div")(1,"div",74)(2,"div",44)(3,"input",75),et("ngModelChange",function(i){u(t);let d=_(2);return tt(d.searchTerm,i)||(d.searchTerm=i),v(i)}),g("ngModelChange",function(){u(t);let i=_(2);return v(i.filterParts())}),a()(),r(4,"div",76)(5,"div",77)(6,"button",78),g("click",function(){u(t);let i=_(2);return v(i.togglePartsView())}),r(7,"span",52),l(8,"\u229E"),a(),l(9," Tiles "),a(),r(10,"button",78),g("click",function(){u(t);let i=_(2);return v(i.togglePartsView())}),r(11,"span",52),l(12,"\u2630"),a(),l(13," List "),a()(),r(14,"button",79),g("click",function(){u(t);let i=_(2);return v(i.toggleSortOptions())}),r(15,"span",52),l(16,"\u2699\uFE0F"),a(),l(17," Sort "),a(),r(18,"button",80),g("click",function(){u(t);let i=_(2);return v(i.markAllPartsOwned(!0))}),l(19," Mark All Complete "),a(),r(20,"button",81),g("click",function(){u(t);let i=_(2);return v(i.markAllPartsOwned(!1))}),l(21," Mark All Missing "),a()()(),y(22,ce,14,2,"div",82)(23,Se,3,2,"div",83)(24,Pe,4,1,"ng-template",null,0,st),a()}if(o&2){let t=at(25),e=_(2);s(3),X("ngModel",e.searchTerm),s(3),P("bg-blue-600",e.partsViewType==="tiles")("text-white",e.partsViewType==="tiles")("bg-gray-200",e.partsViewType!=="tiles")("text-gray-700",e.partsViewType!=="tiles"),s(4),P("bg-blue-600",e.partsViewType==="list")("text-white",e.partsViewType==="list")("bg-gray-200",e.partsViewType!=="list")("text-gray-700",e.partsViewType!=="list"),s(12),c("ngIf",e.showPartsSortOptions),s(),c("ngIf",e.filteredParts.length>0)("ngIfElse",t)}}function Oe(o,n){if(o&1&&(r(0,"option",101),l(1),a()),o&2){let t=n.$implicit,e=_().index,i=_(4);c("value",t.value)("disabled",i.isFieldDisabled("spare-parts",t.value,e)),s(),I(" ",t.label," ")}}function Me(o,n){if(o&1){let t=O();r(0,"button",102),g("click",function(){u(t);let i=_().index,d=_(4);return v(d.removeSortOption("spare-parts",i))}),l(1," \u2715 "),a()}}function Ee(o,n){if(o&1){let t=O();r(0,"div",93)(1,"span",94),l(2),a(),r(3,"select",95),et("ngModelChange",function(i){let d=u(t).$implicit;return tt(d.field,i)||(d.field=i),v(i)}),g("ngModelChange",function(i){let d=u(t),m=d.$implicit,p=d.index,f=_(4);return v(f.updateSortOption("spare-parts",p,i,m.direction))}),y(4,Oe,2,3,"option",96),a(),r(5,"select",97),g("change",function(i){let d=u(t),m=d.$implicit,p=d.index,f=_(4);return v(f.updateSortOption("spare-parts",p,m.field,i.target.value))}),r(6,"option",98),l(7,"Ascending"),a(),r(8,"option",99),l(9,"Descending"),a()(),y(10,Me,2,0,"button",100),a()}if(o&2){let t=n.$implicit,e=n.index,i=_(4);s(2),I("",e+1,"."),s(),X("ngModel",t.field),s(),c("ngForOf",i.getAllFieldsForDropdown("spare-parts")),s(),c("value",t.direction),s(5),c("ngIf",i.sparePartsSortOptions.length>1)}}function De(o,n){if(o&1){let t=O();r(0,"div",103)(1,"button",104),g("click",function(){u(t);let i=_(4);return v(i.addSortOption("spare-parts"))}),l(2," + Add Sort Criteria "),a()()}}function qe(o,n){if(o&1){let t=O();r(0,"div",84)(1,"div",85)(2,"h3",86),l(3,"Sort Spare Parts"),a(),r(4,"button",87),g("click",function(){u(t);let i=_(3);return v(i.resetToDefaultSort())}),l(5," Reset to Default "),a()(),r(6,"div",63),y(7,Ee,11,5,"div",88)(8,De,3,0,"div",89),a(),r(9,"div",90)(10,"button",91),g("click",function(){u(t);let i=_(3);return v(i.closeSortOptions())}),l(11," Cancel "),a(),r(12,"button",92),g("click",function(){u(t);let i=_(3);return v(i.applySortChanges())}),l(13," Apply Sort "),a()()()}if(o&2){let t=_(3);s(7),c("ngForOf",t.sparePartsSortOptions),s(),c("ngIf",t.sparePartsSortOptions.length<3)}}function Te(o,n){if(o&1&&(r(0,"p",114),l(1),a()),o&2){let t=_().$implicit;s(),I("Element ID: ",t.elementId,"")}}function ke(o,n){if(o&1&&(r(0,"p",128),l(1),a()),o&2){let t=_().$implicit;s(),T("From: ",t.setName," (",t.setNum,")")}}function Ve(o,n){o&1&&(r(0,"span"),l(1,"\u2713 Complete"),a())}function Ne(o,n){o&1&&(r(0,"span"),l(1,"\u26A0 Partial"),a())}function $e(o,n){o&1&&(r(0,"span"),l(1,"\u2717 Missing"),a())}function Ue(o,n){if(o&1){let t=O();r(0,"div",109)(1,"div",110)(2,"div")(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),q(4,"img",112),a(),r(5,"div")(6,"h3",113),l(7),a(),r(8,"p",114),l(9),a(),r(10,"p",114),l(11),a(),y(12,Te,2,1,"p",115)(13,ke,2,2,"p",116),r(14,"p",163),l(15,"Spare Part"),a()()(),r(16,"div",117)(17,"div",60)(18,"span"),l(19,"Progress"),a(),r(20,"span"),l(21),a()(),r(22,"div",65),q(23,"div",66),a()(),r(24,"div",118)(25,"label",119),l(26,"Owned:"),a(),r(27,"div",120)(28,"button",121),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(29," - "),a(),r(30,"input",122),g("input",function(i){let d=u(t).$implicit,m=_(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(t),v(i.target.select())}),a(),r(31,"button",121),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(32," + "),a()(),r(33,"span",21),l(34),a()(),r(35,"div",123)(36,"button",124),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(37," \u2713 "),a(),r(38,"button",125),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,0))}),l(39," \u2717 "),a()(),r(40,"div",126)(41,"span",127),y(42,Ve,2,0,"span",39)(43,Ne,2,0,"span",39)(44,$e,2,0,"span",39),a()()()()}if(o&2){let t=n.$implicit,e=_(5);P("bg-green-50",t.quantityOwned>=t.quantityNeeded)("bg-yellow-50",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-50",t.quantityOwned===0),s(2),$(e.shouldUseVerticalLayout()?"flex flex-col items-center mb-4":"flex items-start mb-4"),s(),$(e.getImageSizeClasses()+(e.shouldUseVerticalLayout()?" mb-3 flex-shrink-0 cursor-pointer":" mr-4 flex-shrink-0 cursor-pointer")),s(),c("src",t.imageUrl,Q)("alt",t.part.name),s(),$(e.shouldUseVerticalLayout()?"flex-1 text-center":"flex-1"),s(2),D(t.part.name),s(2),I("Part #: ",t.part.part_num,""),s(2),I("Color: ",t.color.name,""),s(),c("ngIf",t.elementId),s(),c("ngIf",e.isMissingPartsMode&&t.setName),s(8),T("",t.quantityOwned," / ",t.quantityNeeded,""),s(2),j("width",t.quantityOwned/t.quantityNeeded*100,"%"),P("bg-green-500",t.quantityOwned>=t.quantityNeeded)("bg-yellow-500",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-500",t.quantityOwned===0),s(5),c("disabled",t.quantityOwned<=0),s(2),c("value",t.quantityOwned)("min",0)("max",t.quantityNeeded),s(),c("disabled",t.quantityOwned>=t.quantityNeeded),s(3),I("/ ",t.quantityNeeded,""),s(2),c("disabled",t.quantityOwned>=t.quantityNeeded),s(2),c("disabled",t.quantityOwned===0),s(3),P("text-green-600",t.quantityOwned>=t.quantityNeeded)("text-yellow-600",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("text-red-600",t.quantityOwned===0),s(),c("ngIf",t.quantityOwned>=t.quantityNeeded),s(),c("ngIf",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded),s(),c("ngIf",t.quantityOwned===0)}}function Fe(o,n){if(o&1&&(r(0,"div",107),y(1,Ue,45,46,"div",108),a()),o&2){let t=_(4);s(),c("ngForOf",t.spareParts)("ngForTrackBy",t.trackBySparePartId)}}function Ae(o,n){o&1&&(r(0,"th",136),l(1,"Set"),a())}function Qe(o,n){if(o&1&&(r(0,"td",148)(1,"div",146),l(2),a()()),o&2){let t=_().$implicit;s(2),T("",t.setName," (",t.setNum,")")}}function je(o,n){if(o&1){let t=O();r(0,"tr")(1,"td",141)(2,"div",142)(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),q(4,"img",112),a(),r(5,"div",143)(6,"div",144),l(7),a(),r(8,"div",21),l(9),a()()()(),r(10,"td",145)(11,"div",146),l(12),a()(),r(13,"td",145)(14,"div",146),l(15),a()(),y(16,Qe,3,2,"td",147),r(17,"td",148)(18,"div",149),q(19,"div",150),a(),r(20,"div",151),l(21),a()(),r(22,"td",152)(23,"div",153)(24,"button",154),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned-1))}),l(25," - "),a(),r(26,"input",155),g("input",function(i){let d=u(t).$implicit,m=_(5);return v(m.updatePartQuantity(d,+i.target.value))})("focus",function(i){return u(t),v(i.target.select())}),a(),r(27,"button",154),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityOwned+1))}),l(28," + "),a()()(),r(29,"td",156)(30,"div",153)(31,"button",157),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,i.quantityNeeded))}),l(32," \u2713 "),a(),r(33,"button",158),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.updatePartQuantity(i,0))}),l(34," \u2717 "),a()()()()}if(o&2){let t=n.$implicit,e=_(5);P("bg-green-50",t.quantityOwned>=t.quantityNeeded)("bg-yellow-50",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-50",t.quantityOwned===0),s(3),$(e.getListImageSizeClasses()+" mr-2 flex-shrink-0 cursor-pointer"),s(),c("src",t.imageUrl,Q)("alt",t.part.name),s(3),D(t.part.name),s(2),D(t.part.part_num),s(3),D(t.color.name),s(3),D(t.elementId),s(),c("ngIf",e.isMissingPartsMode),s(3),j("width",t.quantityOwned/t.quantityNeeded*100,"%"),P("bg-green-500",t.quantityOwned>=t.quantityNeeded)("bg-yellow-500",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-500",t.quantityOwned===0),s(2),T("",t.quantityOwned,"/",t.quantityNeeded," "),s(3),c("disabled",t.quantityOwned<=0),s(2),c("value",t.quantityOwned)("min",0)("max",t.quantityNeeded),s(),c("disabled",t.quantityOwned>=t.quantityNeeded),s(4),c("disabled",t.quantityOwned>=t.quantityNeeded),s(2),c("disabled",t.quantityOwned===0)}}function Be(o,n){if(o&1&&(r(0,"div",129)(1,"div",130)(2,"table",131)(3,"thead",132)(4,"tr")(5,"th",133),l(6,"Part "),a(),r(7,"th",134),l(8," Color"),a(),r(9,"th",134),l(10," Element ID"),a(),y(11,Ae,2,0,"th",135),r(12,"th",136),l(13," Progress"),a(),r(14,"th",137),l(15," Quantity"),a(),r(16,"th",164),l(17," Actions"),a()()(),r(18,"tbody",139),y(19,je,35,32,"tr",140),a()()()()),o&2){let t=_(4);s(11),c("ngIf",t.isMissingPartsMode),s(8),c("ngForOf",t.spareParts)("ngForTrackBy",t.trackBySparePartId)}}function Le(o,n){if(o&1&&(r(0,"div"),y(1,Fe,2,2,"div",105)(2,Be,20,3,"div",106),a()),o&2){let t=_(3);s(),c("ngIf",t.sparePartsViewType==="tiles"),s(),c("ngIf",t.sparePartsViewType==="list")}}function ze(o,n){o&1&&(r(0,"div",159)(1,"p",160),l(2,"No spare parts found for this set."),a()())}function Ke(o,n){if(o&1){let t=O();r(0,"div")(1,"div",74)(2,"div",44)(3,"h3",86),l(4),a()(),r(5,"div",76)(6,"div",77)(7,"button",78),g("click",function(){u(t);let i=_(2);return v(i.toggleSparePartsView())}),r(8,"span",52),l(9,"\u229E"),a(),l(10," Tiles "),a(),r(11,"button",78),g("click",function(){u(t);let i=_(2);return v(i.toggleSparePartsView())}),r(12,"span",52),l(13,"\u2630"),a(),l(14," List "),a()(),r(15,"button",79),g("click",function(){u(t);let i=_(2);return v(i.toggleSortOptions())}),r(16,"span",52),l(17,"\u2699\uFE0F"),a(),l(18," Sort "),a(),r(19,"button",80),g("click",function(){u(t);let i=_(2);return v(i.markAllSparePartsOwned(!0))}),l(20," Mark All Complete "),a(),r(21,"button",81),g("click",function(){u(t);let i=_(2);return v(i.markAllSparePartsOwned(!1))}),l(22," Mark All Missing "),a()()(),y(23,qe,14,2,"div",82)(24,Le,3,2,"div",83)(25,ze,3,0,"ng-template",null,1,st),a()}if(o&2){let t=at(26),e=_(2);s(4),T("Spare Parts (",e.totalSparePartsOwned,"/",e.totalSparePartsNeeded,")"),s(3),P("bg-blue-600",e.sparePartsViewType==="tiles")("text-white",e.sparePartsViewType==="tiles")("bg-gray-200",e.sparePartsViewType!=="tiles")("text-gray-700",e.sparePartsViewType!=="tiles"),s(4),P("bg-blue-600",e.sparePartsViewType==="list")("text-white",e.sparePartsViewType==="list")("bg-gray-200",e.sparePartsViewType!=="list")("text-gray-700",e.sparePartsViewType!=="list"),s(12),c("ngIf",e.showSparePartsSortOptions),s(),c("ngIf",e.spareParts.length>0)("ngIfElse",t)}}function Re(o,n){if(o&1&&(r(0,"option",101),l(1),a()),o&2){let t=n.$implicit,e=_().index,i=_(4);c("value",t.value)("disabled",i.isFieldDisabled("minifigs",t.value,e)),s(),I(" ",t.label," ")}}function He(o,n){if(o&1){let t=O();r(0,"button",102),g("click",function(){u(t);let i=_().index,d=_(4);return v(d.removeSortOption("minifigs",i))}),l(1," \u2715 "),a()}}function We(o,n){if(o&1){let t=O();r(0,"div",93)(1,"span",94),l(2),a(),r(3,"select",95),et("ngModelChange",function(i){let d=u(t).$implicit;return tt(d.field,i)||(d.field=i),v(i)}),g("ngModelChange",function(i){let d=u(t),m=d.$implicit,p=d.index,f=_(4);return v(f.updateSortOption("minifigs",p,i,m.direction))}),y(4,Re,2,3,"option",96),a(),r(5,"select",97),g("change",function(i){let d=u(t),m=d.$implicit,p=d.index,f=_(4);return v(f.updateSortOption("minifigs",p,m.field,i.target.value))}),r(6,"option",98),l(7,"Ascending"),a(),r(8,"option",99),l(9,"Descending"),a()(),y(10,He,2,0,"button",100),a()}if(o&2){let t=n.$implicit,e=n.index,i=_(4);s(2),I("",e+1,"."),s(),X("ngModel",t.field),s(),c("ngForOf",i.getAllFieldsForDropdown("minifigs")),s(),c("value",t.direction),s(5),c("ngIf",i.minifigsSortOptions.length>1)}}function Ge(o,n){if(o&1){let t=O();r(0,"div",103)(1,"button",104),g("click",function(){u(t);let i=_(4);return v(i.addSortOption("minifigs"))}),l(2," + Add Sort Criteria "),a()()}}function Ye(o,n){if(o&1){let t=O();r(0,"div",84)(1,"div",85)(2,"h3",86),l(3,"Sort Minifigures"),a(),r(4,"button",87),g("click",function(){u(t);let i=_(3);return v(i.resetToDefaultSort())}),l(5," Reset to Default "),a()(),r(6,"div",63),y(7,We,11,5,"div",88)(8,Ge,3,0,"div",89),a(),r(9,"div",90)(10,"button",91),g("click",function(){u(t);let i=_(3);return v(i.closeSortOptions())}),l(11," Cancel "),a(),r(12,"button",92),g("click",function(){u(t);let i=_(3);return v(i.applySortChanges())}),l(13," Apply Sort "),a()()()}if(o&2){let t=_(3);s(7),c("ngForOf",t.minifigsSortOptions),s(),c("ngIf",t.minifigsSortOptions.length<3)}}function Je(o,n){if(o&1&&(r(0,"p",128),l(1),a()),o&2){let t=_().$implicit;s(),T("From: ",t.setName," (",t.setNum,")")}}function Ze(o,n){o&1&&(r(0,"span"),l(1,"\u2713 Complete"),a())}function Xe(o,n){if(o&1&&(r(0,"span"),l(1),W(2,"number"),a()),o&2){let t=_().$implicit,e=_(5);s(),I("\u26A0 Partial (",G(2,1,e.getMinifigPartsProgress(t.minifig.fig_num).percentage,"1.0-0"),"%)")}}function ti(o,n){o&1&&(r(0,"span"),l(1,"\u2717 Missing"),a())}function ei(o,n){o&1&&(r(0,"span",52),l(1,"\u25B6"),a())}function ii(o,n){o&1&&(r(0,"span",52),l(1,"\u25BC"),a())}function ni(o,n){o&1&&(r(0,"span"),l(1,"\u2713"),a())}function ri(o,n){o&1&&(r(0,"span"),l(1,"\u26A0"),a())}function ai(o,n){o&1&&(r(0,"span"),l(1,"\u2717"),a())}function oi(o,n){if(o&1){let t=O();r(0,"div",174)(1,"div",175)(2,"div",176)(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(7);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),q(4,"img",112),a(),r(5,"div",177)(6,"h5",178),l(7),a(),r(8,"p",179),l(9),a(),r(10,"p",179),l(11),a()()(),r(12,"div",180)(13,"div",181)(14,"span"),l(15,"Progress"),a(),r(16,"span"),l(17),a()(),r(18,"div",182),q(19,"div",150),a()(),r(20,"div",153)(21,"button",183),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned-1))}),l(22," - "),a(),r(23,"input",184),g("input",function(i){let d=u(t).$implicit,m=_(2).$implicit,p=_(5);return v(p.updateMinifigPartQuantity((p.userInventory==null?null:p.userInventory.set_num)||"",m.minifig.fig_num,d,+i.target.value))})("focus",function(i){return u(t),v(i.target.select())}),a(),r(24,"button",183),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned+1))}),l(25," + "),a()(),r(26,"div",185)(27,"span",186),y(28,ni,2,0,"span",39)(29,ri,2,0,"span",39)(30,ai,2,0,"span",39),a()(),r(31,"div",187)(32,"button",188),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityNeeded))}),l(33," \u2713 "),a(),r(34,"button",189),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,0))}),l(35," \u2717 "),a()()()()}if(o&2){let t=n.$implicit,e=_(7);P("bg-green-50",t.quantityOwned>=t.quantityNeeded)("bg-yellow-50",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-50",t.quantityOwned===0),s(3),$(e.getMinifigPartImageSizeClasses()+" bg-gray-100 rounded overflow-hidden mr-3 flex-shrink-0 cursor-pointer"),s(),c("src",t.imageUrl,Q)("alt",t.part.name),s(3),D(t.part.name),s(2),D(t.part.part_num),s(2),D(t.color.name),s(6),T("",t.quantityOwned," / ",t.quantityNeeded,""),s(2),j("width",t.quantityOwned/t.quantityNeeded*100,"%"),P("bg-green-500",t.quantityOwned>=t.quantityNeeded)("bg-yellow-500",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-500",t.quantityOwned===0),s(2),c("disabled",t.quantityOwned<=0),s(2),c("value",t.quantityOwned)("min",0)("max",t.quantityNeeded),s(),c("disabled",t.quantityOwned>=t.quantityNeeded),s(3),P("text-green-600",t.quantityOwned>=t.quantityNeeded)("text-yellow-600",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("text-red-600",t.quantityOwned===0),s(),c("ngIf",t.quantityOwned>=t.quantityNeeded),s(),c("ngIf",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded),s(),c("ngIf",t.quantityOwned===0),s(2),c("disabled",t.quantityOwned>=t.quantityNeeded),s(2),c("disabled",t.quantityOwned===0)}}function si(o,n){if(o&1&&(r(0,"div",169)(1,"div",170)(2,"h4",171),l(3,"Minifigure Parts"),a(),r(4,"div",172),y(5,oi,36,39,"div",173),a()()()),o&2){let t=_().$implicit,e=_(5);s(5),c("ngForOf",e.getMinifigParts(t.minifig.fig_num))}}function li(o,n){if(o&1){let t=O();r(0,"div",109)(1,"div",110)(2,"div")(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.openImageOverlay(i.imageUrl,i.minifig.name))}),q(4,"img",112),a(),r(5,"div")(6,"h3",113),l(7),a(),r(8,"p",114),l(9),a(),r(10,"p",114),l(11),a(),y(12,Je,2,2,"p",116),a()(),r(13,"div",117)(14,"div",60)(15,"span"),l(16,"Parts Progress"),a(),r(17,"span"),l(18),a()(),r(19,"div",65),q(20,"div",66),a()(),r(21,"div",126)(22,"span",127),y(23,Ze,2,0,"span",39)(24,Xe,3,4,"span",39)(25,ti,2,0,"span",39),a()(),r(26,"div",165)(27,"button",166),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.toggleMinifigParts(i.minifig.fig_num))}),y(28,ei,2,0,"span",167)(29,ii,2,0,"span",167),l(30),a()()(),y(31,si,6,1,"div",168),a()}if(o&2){let t=n.$implicit,e=_(5);P("bg-green-50",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>=100)("bg-yellow-50",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>0&&e.getMinifigPartsProgress(t.minifig.fig_num).percentage<100)("bg-red-50",e.getMinifigPartsProgress(t.minifig.fig_num).percentage===0),s(2),$(e.shouldUseVerticalLayout()?"flex flex-col items-center mb-4":"flex items-start mb-4"),s(),$(e.getImageSizeClasses()+(e.shouldUseVerticalLayout()?" mb-3 flex-shrink-0 cursor-pointer":" mr-4 flex-shrink-0 cursor-pointer")),s(),c("src",t.imageUrl,Q)("alt",t.minifig.name),s(),$(e.shouldUseVerticalLayout()?"flex-1 text-center":"flex-1"),s(2),D(t.minifig.name),s(2),I("Fig #: ",t.minifig.fig_num,""),s(2),I("Parts: ",t.minifig.num_parts,""),s(),c("ngIf",e.isMissingPartsMode&&t.setName),s(6),T("",e.getMinifigPartsProgress(t.minifig.fig_num).owned," / ",e.getMinifigPartsProgress(t.minifig.fig_num).total,""),s(2),j("width",e.getMinifigPartsProgress(t.minifig.fig_num).percentage,"%"),P("bg-green-500",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>=100)("bg-yellow-500",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>0&&e.getMinifigPartsProgress(t.minifig.fig_num).percentage<100)("bg-red-500",e.getMinifigPartsProgress(t.minifig.fig_num).percentage===0),s(2),P("text-green-600",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>=100)("text-yellow-600",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>0&&e.getMinifigPartsProgress(t.minifig.fig_num).percentage<100)("text-red-600",e.getMinifigPartsProgress(t.minifig.fig_num).percentage===0),s(),c("ngIf",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>=100),s(),c("ngIf",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>0&&e.getMinifigPartsProgress(t.minifig.fig_num).percentage<100),s(),c("ngIf",e.getMinifigPartsProgress(t.minifig.fig_num).percentage===0),s(3),c("ngIf",!e.isMinifigPartsExpanded(t.minifig.fig_num)),s(),c("ngIf",e.isMinifigPartsExpanded(t.minifig.fig_num)),s(),I(" ",e.isMinifigPartsExpanded(t.minifig.fig_num)?"Hide Parts":"Show Parts"," "),s(),c("ngIf",e.isMinifigPartsExpanded(t.minifig.fig_num))}}function di(o,n){if(o&1&&(r(0,"div",107),y(1,li,32,41,"div",108),a()),o&2){let t=_(4);s(),c("ngForOf",t.minifigs)("ngForTrackBy",t.trackByMinifigId)}}function _i(o,n){o&1&&(r(0,"th",136),l(1,"Set"),a())}function ci(o,n){if(o&1&&(r(0,"td",148)(1,"div",146),l(2),a()()),o&2){let t=_().$implicit;s(2),T("",t.setName," (",t.setNum,")")}}function mi(o,n){o&1&&(r(0,"span",52),l(1,"\u25B6"),a())}function pi(o,n){o&1&&(r(0,"span",52),l(1,"\u25BC"),a())}function ui(o,n){if(o&1){let t=O();r(0,"tr")(1,"td",202)(2,"div",142)(3,"div",111),g("click",function(){let i=u(t).$implicit,d=_(7);return v(d.openImageOverlay(i.imageUrl,i.part.name))}),q(4,"img",112),a(),r(5,"div",143)(6,"div",203),l(7),a(),r(8,"div",204),l(9),a()()()(),r(10,"td",205)(11,"div",206),l(12),a()(),r(13,"td",205)(14,"div",207),q(15,"div",208),a(),r(16,"div",209),l(17),a()(),r(18,"td",205)(19,"div",153)(20,"button",210),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned-1))}),l(21," - "),a(),r(22,"input",211),g("input",function(i){let d=u(t).$implicit,m=_(2).$implicit,p=_(5);return v(p.updateMinifigPartQuantity((p.userInventory==null?null:p.userInventory.set_num)||"",m.minifig.fig_num,d,+i.target.value))})("focus",function(i){return u(t),v(i.target.select())}),a(),r(23,"button",210),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityOwned+1))}),l(24," + "),a()()(),r(25,"td",212)(26,"div",153)(27,"button",213),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,i.quantityNeeded))}),l(28," \u2713 "),a(),r(29,"button",214),g("click",function(){let i=u(t).$implicit,d=_(2).$implicit,m=_(5);return v(m.updateMinifigPartQuantity((m.userInventory==null?null:m.userInventory.set_num)||"",d.minifig.fig_num,i,0))}),l(30," \u2717 "),a()()()()}if(o&2){let t=n.$implicit,e=_(7);P("bg-green-50",t.quantityOwned>=t.quantityNeeded)("bg-yellow-50",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-50",t.quantityOwned===0),s(3),$(e.getMinifigPartListImageSizeClasses()+" bg-gray-100 rounded overflow-hidden mr-2 flex-shrink-0 cursor-pointer"),s(),c("src",t.imageUrl,Q)("alt",t.part.name),s(3),D(t.part.name),s(2),D(t.part.part_num),s(3),D(t.color.name),s(3),j("width",t.quantityOwned/t.quantityNeeded*100,"%"),P("bg-green-500",t.quantityOwned>=t.quantityNeeded)("bg-yellow-500",t.quantityOwned>0&&t.quantityOwned<t.quantityNeeded)("bg-red-500",t.quantityOwned===0),s(2),T("",t.quantityOwned,"/",t.quantityNeeded,""),s(3),c("disabled",t.quantityOwned<=0),s(2),c("value",t.quantityOwned)("min",0)("max",t.quantityNeeded),s(),c("disabled",t.quantityOwned>=t.quantityNeeded),s(4),c("disabled",t.quantityOwned>=t.quantityNeeded),s(2),c("disabled",t.quantityOwned===0)}}function vi(o,n){if(o&1&&(r(0,"tr",132)(1,"td",195)(2,"div",196)(3,"h4",171),l(4,"Minifigure Parts"),a(),r(5,"div",197)(6,"div",130)(7,"table",198)(8,"thead",199)(9,"tr")(10,"th",200),l(11,"Part"),a(),r(12,"th",200),l(13,"Color"),a(),r(14,"th",200),l(15,"Progress"),a(),r(16,"th",200),l(17,"Quantity"),a(),r(18,"th",200),l(19,"Actions"),a()()(),r(20,"tbody",139),y(21,ui,31,30,"tr",201),a()()()()()()()),o&2){let t=_().$implicit,e=_(5);s(),mt("colspan",e.isMissingPartsMode?7:6),s(20),c("ngForOf",e.getMinifigParts(t.minifig.fig_num))}}function gi(o,n){if(o&1){let t=O();pt(0),r(1,"tr")(2,"td",141)(3,"div",142)(4,"div",111),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.openImageOverlay(i.imageUrl,i.minifig.name))}),q(5,"img",112),a(),r(6,"div",143)(7,"div",144),l(8),a(),r(9,"div",21),l(10),a()()()(),r(11,"td",191)(12,"div",192),l(13),a()(),y(14,ci,3,2,"td",147),r(15,"td",148)(16,"div",149),q(17,"div",150),a(),r(18,"div",151),l(19),a()(),r(20,"td",156)(21,"button",193),g("click",function(){let i=u(t).$implicit,d=_(5);return v(d.toggleMinifigParts(i.minifig.fig_num))}),y(22,mi,2,0,"span",167)(23,pi,2,0,"span",167),l(24),a()()(),y(25,vi,22,2,"tr",194),ut()}if(o&2){let t=n.$implicit,e=_(5);s(),P("bg-green-50",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>=100)("bg-yellow-50",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>0&&e.getMinifigPartsProgress(t.minifig.fig_num).percentage<100)("bg-red-50",e.getMinifigPartsProgress(t.minifig.fig_num).percentage===0),s(3),$(e.getListImageSizeClasses()+" mr-2 flex-shrink-0 cursor-pointer"),s(),c("src",t.imageUrl,Q)("alt",t.minifig.name),s(3),D(t.minifig.name),s(2),D(t.minifig.fig_num),s(3),D(t.minifig.num_parts),s(),c("ngIf",e.isMissingPartsMode),s(3),j("width",e.getMinifigPartsProgress(t.minifig.fig_num).percentage,"%"),P("bg-green-500",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>=100)("bg-yellow-500",e.getMinifigPartsProgress(t.minifig.fig_num).percentage>0&&e.getMinifigPartsProgress(t.minifig.fig_num).percentage<100)("bg-red-500",e.getMinifigPartsProgress(t.minifig.fig_num).percentage===0),s(2),T("",e.getMinifigPartsProgress(t.minifig.fig_num).owned,"/",e.getMinifigPartsProgress(t.minifig.fig_num).total,""),s(3),c("ngIf",!e.isMinifigPartsExpanded(t.minifig.fig_num)),s(),c("ngIf",e.isMinifigPartsExpanded(t.minifig.fig_num)),s(),I(" ",e.isMinifigPartsExpanded(t.minifig.fig_num)?"Hide":"Show"," "),s(),c("ngIf",e.isMinifigPartsExpanded(t.minifig.fig_num))}}function fi(o,n){if(o&1&&(r(0,"div",129)(1,"div",130)(2,"table",131)(3,"thead",132)(4,"tr")(5,"th",133),l(6," Minifigure"),a(),r(7,"th",138),l(8," Parts"),a(),y(9,_i,2,0,"th",135),r(10,"th",136),l(11," Parts Progress"),a(),r(12,"th",138),l(13," Show Parts"),a()()(),r(14,"tbody",139),y(15,gi,26,28,"ng-container",190),a()()()()),o&2){let t=_(4);s(9),c("ngIf",t.isMissingPartsMode),s(6),c("ngForOf",t.minifigs)("ngForTrackBy",t.trackByMinifigId)}}function yi(o,n){if(o&1&&(r(0,"div"),y(1,di,2,2,"div",105)(2,fi,16,3,"div",106),a()),o&2){let t=_(3);s(),c("ngIf",t.minifigsViewType==="tiles"),s(),c("ngIf",t.minifigsViewType==="list")}}function xi(o,n){o&1&&(r(0,"div",159)(1,"p",160),l(2,"No minifigures found for this set."),a()())}function hi(o,n){if(o&1){let t=O();r(0,"div")(1,"div",74)(2,"div",44)(3,"h3",86),l(4),a()(),r(5,"div",76)(6,"div",77)(7,"button",78),g("click",function(){u(t);let i=_(2);return v(i.toggleMinifigsView())}),r(8,"span",52),l(9,"\u229E"),a(),l(10," Tiles "),a(),r(11,"button",78),g("click",function(){u(t);let i=_(2);return v(i.toggleMinifigsView())}),r(12,"span",52),l(13,"\u2630"),a(),l(14," List "),a()(),r(15,"button",79),g("click",function(){u(t);let i=_(2);return v(i.toggleSortOptions())}),r(16,"span",52),l(17,"\u2699\uFE0F"),a(),l(18," Sort "),a(),r(19,"button",80),g("click",function(){u(t);let i=_(2);return v(i.markAllMinifigsOwned(!0))}),l(20," Mark All Complete "),a(),r(21,"button",81),g("click",function(){u(t);let i=_(2);return v(i.markAllMinifigsOwned(!1))}),l(22," Mark All Missing "),a()()(),y(23,Ye,14,2,"div",82)(24,yi,3,2,"div",83)(25,xi,3,0,"ng-template",null,2,st),a()}if(o&2){let t=at(26),e=_(2);s(4),T("Minifigures (",e.getTotalMinifigPartsProgress().owned,"/",e.getTotalMinifigPartsProgress().total,")"),s(3),P("bg-blue-600",e.minifigsViewType==="tiles")("text-white",e.minifigsViewType==="tiles")("bg-gray-200",e.minifigsViewType!=="tiles")("text-gray-700",e.minifigsViewType!=="tiles"),s(4),P("bg-blue-600",e.minifigsViewType==="list")("text-white",e.minifigsViewType==="list")("bg-gray-200",e.minifigsViewType!=="list")("text-gray-700",e.minifigsViewType!=="list"),s(12),c("ngIf",e.showMinifigsSortOptions),s(),c("ngIf",e.minifigs.length>0)("ngIfElse",t)}}function wi(o,n){if(o&1){let t=O();r(0,"div",32)(1,"div",33),y(2,Yt,28,15,"div",34)(3,Jt,12,2,"div",35),r(4,"div",36)(5,"nav",37)(6,"button",38),g("click",function(){u(t);let i=_();return v(i.switchToTab("parts"))}),y(7,Zt,2,2,"span",39)(8,Xt,2,1,"span",39)(9,te,2,1,"span",40),a(),r(10,"button",38),g("click",function(){u(t);let i=_();return v(i.switchToTab("spare-parts"))}),y(11,ee,2,2,"span",39)(12,ie,2,1,"span",39)(13,ne,2,1,"span",40),a(),r(14,"button",38),g("click",function(){u(t);let i=_();return v(i.switchToTab("minifigs"))}),y(15,re,2,2,"span",39)(16,ae,2,1,"span",39)(17,oe,2,1,"span",40),a()()(),y(18,Ce,26,20,"div",39)(19,Ke,27,21,"div",39)(20,hi,27,21,"div",39),a()()}if(o&2){let t=_();s(2),c("ngIf",!t.isMissingPartsMode),s(),c("ngIf",t.isMissingPartsMode),s(3),P("text-blue-600",t.activeTab==="parts")("border-blue-600",t.activeTab==="parts")("border-transparent",t.activeTab!=="parts"),s(),c("ngIf",!t.isMissingPartsMode),s(),c("ngIf",t.isMissingPartsMode),s(),c("ngIf",t.missingPartsCount>0&&!t.isMissingPartsMode),s(),P("text-blue-600",t.activeTab==="spare-parts")("border-blue-600",t.activeTab==="spare-parts")("border-transparent",t.activeTab!=="spare-parts"),s(),c("ngIf",!t.isMissingPartsMode),s(),c("ngIf",t.isMissingPartsMode),s(),c("ngIf",t.missingSparePartsCount>0&&!t.isMissingPartsMode),s(),P("text-blue-600",t.activeTab==="minifigs")("border-blue-600",t.activeTab==="minifigs")("border-transparent",t.activeTab!=="minifigs"),s(),c("ngIf",!t.isMissingPartsMode),s(),c("ngIf",t.isMissingPartsMode),s(),c("ngIf",t.getTotalMinifigPartsProgress().missing>0&&!t.isMissingPartsMode),s(),c("ngIf",t.activeTab==="parts"),s(),c("ngIf",t.activeTab==="spare-parts"),s(),c("ngIf",t.activeTab==="minifigs")}}function bi(o,n){if(o&1){let t=O();r(0,"div",215),g("click",function(i){u(t);let d=_();return v(d.onOverlayClick(i))}),r(1,"div",216)(2,"button",217),g("click",function(){u(t);let i=_();return v(i.closeImageOverlay())}),l(3," \xD7 "),a(),q(4,"img",218),r(5,"div",219)(6,"p",18),l(7," Image \xA9 "),r(8,"a",220),l(9,"Rebrickable"),a()()()()()}if(o&2){let t=_();s(4),c("src",t.getLargeImageUrl(t.overlayImageUrl),Q)("alt",t.overlayImageAlt)}}function Si(o,n){if(o&1){let t=O();r(0,"button",221),g("click",function(){u(t);let i=_();return v(i.performUndo())}),r(1,"span",11),l(2,"\u27F2"),a()()}if(o&2){let t=_();c("disabled",!t.canUndo)("title",t.canUndo?"Undo last action (Cmd/Ctrl+Z) - "+((t.userInventory==null||t.userInventory.undoHistory==null?null:t.userInventory.undoHistory.length)||0)+" actions available":"No actions to undo")}}function Ii(o,n){if(o&1&&(r(0,"span",222),l(1),a()),o&2){let t=_();s(),I(" ",t.userInventory==null||t.userInventory.undoHistory==null?null:t.userInventory.undoHistory.length," ")}}function Pi(o,n){if(o&1&&(r(0,"div",223)(1,"div",118)(2,"span",11),l(3,"\u2713"),a(),r(4,"span"),l(5),a()()()),o&2){let t=_();s(5),D(t.undoNotificationMessage)}}var Tt=class o{constructor(n,t,e,i){this.route=n;this.dataService=t;this.storageService=e;this.changeDetectorRef=i;this.initializeDefaultSorting()}userInventory=null;inventory=null;set=null;parts=[];minifigs=[];spareParts=[];loading=!0;searchTerm="";filteredParts=[];activeTab="parts";missingPartsCount=0;missingMinifigsCount=0;missingSparePartsCount=0;isMissingPartsMode=!1;userInventories=[];theme=null;uniqueColorsCount=0;totalPartsNeeded=0;totalPartsOwned=0;totalMinifigsNeeded=0;totalMinifigsOwned=0;totalSparePartsNeeded=0;totalSparePartsOwned=0;overallProgress=0;showSortOptions=!1;partsSortOptions=[];minifigsSortOptions=[];sparePartsSortOptions=[];showPartsSortOptions=!1;showSparePartsSortOptions=!1;showMinifigsSortOptions=!1;partsViewType="tiles";minifigsViewType="tiles";sparePartsViewType="tiles";showImageOverlay=!1;overlayImageUrl="";overlayImageAlt="";maxUndoHistory=100;canUndo=!1;showUndoNotification=!1;undoNotificationMessage="";partSortFields=[{value:"completion",label:"Completion Status"},{value:"color",label:"Color"},{value:"partNumber",label:"Part Number"},{value:"partName",label:"Part Name"},{value:"elementId",label:"Element ID"},{value:"quantityMissing",label:"Quantity Missing"},{value:"quantityNeeded",label:"Quantity Needed"}];minifigSortFields=[{value:"completion",label:"Completion Status"},{value:"figNumber",label:"Figure Number"},{value:"figName",label:"Figure Name"},{value:"quantityMissing",label:"Quantity Missing"},{value:"quantityNeeded",label:"Quantity Needed"}];globalSettings={imagePreviewSize:"1x",includeSparePartsInProgress:!0};collapsedMinifigParts=[];minifigPartsCache=new Map;_totalMinifigPartsProgress={owned:0,total:0,missing:0,percentage:0};getPartStorageKey(n,t,e){let i=`${n}_${t}`;return e?`spare_${i}`:i}getMinifigPartStorageKey(n,t,e,i){return`${n}_${t}_${e}_${i}`}toggleMinifigParts(n){let t=this.collapsedMinifigParts.indexOf(n);t>-1?this.collapsedMinifigParts.splice(t,1):this.collapsedMinifigParts.push(n),this.saveMinifigPartsState()}isMinifigPartsExpanded(n){return!this.collapsedMinifigParts.includes(n)}saveMinifigPartsState(){if(this.isMissingPartsMode||!this.userInventory)return;let n=B(U({},this.userInventory),{collapsedMinifigParts:[...this.collapsedMinifigParts],lastUpdated:Date.now()});this.userInventory=n,this.storageService.updateUserInventory(n)}loadMinifigPartsState(){this.isMissingPartsMode?this.collapsedMinifigParts=[]:this.userInventory?.collapsedMinifigParts?this.collapsedMinifigParts=[...this.userInventory.collapsedMinifigParts]:this.collapsedMinifigParts=[]}getMinifigParts(n){if(this.minifigPartsCache.has(n)){let i=this.minifigPartsCache.get(n);return this.sortMinifigParts([...i])}let e=this.dataService.getCurrentInventories().find(i=>i.set_num===n);return e?(this.loadMinifigPartsAsync(n,e.id),[]):(this.minifigPartsCache.set(n,[]),[])}loadMinifigPartsAsync(n,t){let e=this.dataService.getCurrentParts(),i=this.dataService.getCurrentColors(),d=this.dataService.getCurrentElements(),m=new Map(e.map(w=>[w.part_num,w])),p=new Map(i.map(w=>[w.id,w])),f=new Map(d.map(w=>[`${w.part_num}_${w.color_id}`,w.element_id]));this.dataService.getInventoryPartsFromCache(t).subscribe(w=>{let h=[];for(let C of w){let S=m.get(C.part_num),k=p.get(C.color_id);if(S&&k){let V=f.get(`${C.part_num}_${C.color_id}`),E=this.getMinifigPartStorageKey(this.userInventory?.set_num||"",n,C.part_num,C.color_id),N=this.userInventory?.minifigPartsOwned?.[E]||0,F={inventoryPart:C,part:S,color:k,imageUrl:C.img_url,quantityNeeded:C.quantity,quantityOwned:N,elementId:V};h.push(F)}}let x=this.sortMinifigParts(h);this.minifigPartsCache.set(n,x),this.updateTotalMinifigPartsProgress()})}sortMinifigParts(n){try{return n.sort((t,e)=>{let i=t.quantityOwned>=t.quantityNeeded,d=e.quantityOwned>=e.quantityNeeded;if(i!==d)return i?1:-1;let m=String(t.color?.name||""),p=String(e.color?.name||""),f=m.localeCompare(p);if(f!==0)return f;let w=String(t.part?.part_num||""),h=String(e.part?.part_num||"");return w.localeCompare(h)})}catch(t){return console.error("Error sorting minifigure parts:",t),n}}getMinifigPartsProgress(n){let t=this.getMinifigParts(n),e=t.reduce((m,p)=>m+p.quantityOwned,0),i=t.reduce((m,p)=>m+p.quantityNeeded,0),d=i>0?Math.round(e/i*100):0;return{owned:e,total:i,percentage:d}}getTotalMinifigPartsProgress(){return this._totalMinifigPartsProgress}updateTotalMinifigPartsProgress(){let n=0,t=0;this.minifigs.forEach(d=>{let m=d.minifig.fig_num,p=this.minifigPartsCache.get(m);if(p&&p.length>0){let f=p.reduce((h,x)=>h+x.quantityOwned,0),w=p.reduce((h,x)=>h+x.quantityNeeded,0);n+=f,t+=w}});let e=t-n,i=t>0?Math.round(n/t*100):0;this._totalMinifigPartsProgress={owned:n,total:t,missing:e,percentage:i}}updateCounts(){this.missingPartsCount=this.parts.reduce((e,i)=>e+Math.max(0,i.quantityNeeded-i.quantityOwned),0),this.missingMinifigsCount=this.minifigs.reduce((e,i)=>e+Math.max(0,i.quantityNeeded-i.quantityOwned),0),this.missingSparePartsCount=this.spareParts.reduce((e,i)=>e+Math.max(0,i.quantityNeeded-i.quantityOwned),0),this.totalPartsNeeded=this.parts.reduce((e,i)=>e+i.quantityNeeded,0),this.totalPartsOwned=this.parts.reduce((e,i)=>e+i.quantityOwned,0),this.totalMinifigsNeeded=this.minifigs.reduce((e,i)=>e+i.quantityNeeded,0),this.totalMinifigsOwned=this.minifigs.reduce((e,i)=>e+i.quantityOwned,0),this.totalSparePartsNeeded=this.spareParts.reduce((e,i)=>e+i.quantityNeeded,0),this.totalSparePartsOwned=this.spareParts.reduce((e,i)=>e+i.quantityOwned,0);let n,t;this.globalSettings.includeSparePartsInProgress?(n=this.totalPartsNeeded+this.totalMinifigsNeeded+this.totalSparePartsNeeded,t=this.totalPartsOwned+this.totalMinifigsOwned+this.totalSparePartsOwned):(n=this.totalPartsNeeded+this.totalMinifigsNeeded,t=this.totalPartsOwned+this.totalMinifigsOwned),this.overallProgress=n>0?t/n*100:0,this.updateTotalMinifigPartsProgress()}filterParts(){if(!this.searchTerm){this.filteredParts=[...this.parts];return}let n=this.searchTerm.toLowerCase(),t=this.parts.filter(e=>e.part.name.toLowerCase().includes(n)||e.part.part_num.toLowerCase().includes(n)||e.color.name.toLowerCase().includes(n));this.filteredParts=this.sortParts(t)}updatePartQuantity(n,t){if(!this.userInventory)return;let e=this.spareParts.includes(n),i=this.getPartStorageKey(n.inventoryPart.part_num,n.inventoryPart.color_id,e),d=n.quantityOwned,m=Math.max(0,Math.min(t,n.quantityNeeded));if(m===d)return;n.quantityOwned=m;let p={};for(let[h,x]of Object.entries(this.userInventory.partsOwned))p[h]=typeof x=="number"?x:x?1:0;p[i]=m;let f=B(U({},this.userInventory),{partsOwned:p,lastUpdated:Date.now()});this.userInventory=f,this.storageService.updateUserInventory(f),this.updateCounts();let w={type:"part",key:i,previousQuantity:d,newQuantity:m,timestamp:Date.now(),description:`Changed ${n.part.name} quantity from ${d} to ${m}`};this.addUndoAction(w)}updateMinifigQuantity(n,t){if(!this.userInventory)return;let e=n.inventoryMinifig.fig_num,i=n.quantityOwned,d=Math.max(0,Math.min(t,n.quantityNeeded));if(d===i)return;n.quantityOwned=d;let m={};for(let[w,h]of Object.entries(this.userInventory.minifigsOwned))m[w]=typeof h=="number"?h:h?1:0;m[n.inventoryMinifig.fig_num]=d;let p=B(U({},this.userInventory),{minifigsOwned:m,lastUpdated:Date.now()});this.userInventory=p,this.storageService.updateUserInventory(p),this.updateCounts();let f={type:"minifig",key:e,previousQuantity:i,newQuantity:d,timestamp:Date.now(),description:`Changed ${n.minifig.name} quantity from ${i} to ${d}`};this.addUndoAction(f)}updateMinifigPartQuantity(n,t,e,i){if(!this.userInventory)return;let d=this.getMinifigPartStorageKey(n,t,e.inventoryPart.part_num,e.inventoryPart.color_id),m=e.quantityOwned,p=Math.max(0,Math.min(i,e.quantityNeeded));if(p===m)return;e.quantityOwned=p,this.userInventory.minifigPartsOwned||(this.userInventory.minifigPartsOwned={}),this.userInventory.minifigPartsOwned[d]=p;let f=this.minifigPartsCache.get(t);if(f){let x=f.find(C=>C.inventoryPart.part_num===e.inventoryPart.part_num&&C.inventoryPart.color_id===e.inventoryPart.color_id);x&&(x.quantityOwned=p)}this.checkAndUpdateMinifigCompletion(t);let w=B(U({},this.userInventory),{lastUpdated:Date.now()});this.userInventory=w,this.storageService.updateUserInventory(w),this.updateCounts();let h={type:"minifig-part",key:d,previousQuantity:m,newQuantity:p,timestamp:Date.now(),description:`Changed ${e.part.name} (${t}) quantity from ${m} to ${p}`};this.addUndoAction(h)}checkAndUpdateMinifigCompletion(n){if(!this.userInventory)return;let t=this.minifigs.find(p=>p.minifig.fig_num===n);if(!t)return;let e=this.getMinifigParts(n);if(!e||e.length===0)return;let i=e.every(p=>p.quantityOwned>=p.quantityNeeded),d=e.some(p=>p.quantityOwned<p.quantityNeeded),m;i?m=t.quantityNeeded:d&&t.quantityOwned===t.quantityNeeded?m=0:m=t.quantityOwned,t.quantityOwned!==m&&(t.quantityOwned=m,this.userInventory.minifigsOwned||(this.userInventory.minifigsOwned={}),this.userInventory.minifigsOwned[n]=m,console.log(`Auto-updated minifigure ${n} quantity to ${m} (all parts complete: ${i})`))}getPartImageUrl(n,t,e){return`https://cdn.rebrickable.com/media/thumbs/parts/elements/${e}.jpg/800x800p.jpg?`+Date.now()%1e6}getMinifigImageUrl(n){return`assets/images/placeholder.svg?fig=${n}`}markAllPartsOwned(n){if(!this.userInventory)return;let e=`Are you sure you want to ${n?"mark all parts as complete":"mark all parts as missing"}? This will update the quantities for all ${this.parts.length} parts in this set.`;if(!confirm(e))return;let i={};for(let[p,f]of Object.entries(this.userInventory.partsOwned))i[p]=typeof f=="number"?f:f?1:0;for(let p of this.parts){let f=this.getPartStorageKey(p.inventoryPart.part_num,p.inventoryPart.color_id,!1);i[f]=n?p.quantityNeeded:0,p.quantityOwned=i[f]}let d={};for(let[p,f]of Object.entries(this.userInventory.minifigsOwned))d[p]=typeof f=="number"?f:f?1:0;let m=B(U({},this.userInventory),{partsOwned:i,minifigsOwned:d,lastUpdated:Date.now()});this.storageService.updateUserInventory(m),this.userInventory=m,this.updateCounts()}markAllMinifigsOwned(n){if(!this.userInventory)return;let e=`Are you sure you want to ${n?"mark all minifigures as complete":"mark all minifigures as missing"}? This will update the quantities for all ${this.minifigs.length} minifigures and their individual parts in this set.`;if(!confirm(e))return;let i={};for(let[p,f]of Object.entries(this.userInventory.partsOwned))i[p]=typeof f=="number"?f:f?1:0;let d={};for(let[p,f]of Object.entries(this.userInventory.minifigsOwned))d[p]=typeof f=="number"?f:f?1:0;this.userInventory.minifigPartsOwned||(this.userInventory.minifigPartsOwned={});let m=[];for(let p of this.minifigs){d[p.inventoryMinifig.fig_num]=n?p.quantityNeeded:0,p.quantityOwned=d[p.inventoryMinifig.fig_num];let f=this.updateMinifigPartsAsync(p.minifig.fig_num,n);m.push(f)}Promise.all(m).then(()=>{let p=B(U({},this.userInventory),{partsOwned:i,minifigsOwned:d,minifigPartsOwned:this.userInventory.minifigPartsOwned,lastUpdated:Date.now()});this.storageService.updateUserInventory(p),this.userInventory=p,this.updateCounts()}).catch(p=>{console.error("Error updating minifigure parts:",p)})}updateMinifigPartsAsync(n,t){return lt(this,null,function*(){return new Promise((e,i)=>{let m=this.dataService.getCurrentInventories().find(S=>S.set_num===n);if(!m){e();return}let p=this.dataService.getCurrentParts(),f=this.dataService.getCurrentColors(),w=this.dataService.getCurrentElements(),h=new Map(p.map(S=>[S.part_num,S])),x=new Map(f.map(S=>[S.id,S])),C=new Map(w.map(S=>[`${S.part_num}_${S.color_id}`,S.element_id]));this.dataService.getInventoryPartsFromCache(m.id).subscribe({next:S=>{let k=[];for(let E of S){let N=h.get(E.part_num),F=x.get(E.color_id);if(N&&F){let M=C.get(`${E.part_num}_${E.color_id}`),L=this.getMinifigPartStorageKey(this.userInventory.set_num,n,E.part_num,E.color_id),A=t?E.quantity:0;this.userInventory.minifigPartsOwned[L]=A;let z={inventoryPart:E,part:N,color:F,imageUrl:E.img_url,quantityNeeded:E.quantity,quantityOwned:A,elementId:M};k.push(z)}}let V=this.sortMinifigParts(k);this.minifigPartsCache.set(n,V),e()},error:S=>{console.error(`Error loading parts for minifigure ${n}:`,S),i(S)}})})})}markAllSparePartsOwned(n){if(!this.userInventory)return;let e=`Are you sure you want to ${n?"mark all spare parts as complete":"mark all spare parts as missing"}? This will update the quantities for all ${this.spareParts.length} spare parts in this set.`;if(!confirm(e))return;let i={};for(let[p,f]of Object.entries(this.userInventory.partsOwned))i[p]=typeof f=="number"?f:f?1:0;for(let p of this.spareParts){let f=this.getPartStorageKey(p.inventoryPart.part_num,p.inventoryPart.color_id,!0);i[f]=n?p.quantityNeeded:0,p.quantityOwned=i[f]}let d={};for(let[p,f]of Object.entries(this.userInventory.minifigsOwned))d[p]=typeof f=="number"?f:f?1:0;let m=B(U({},this.userInventory),{partsOwned:i,minifigsOwned:d,lastUpdated:Date.now()});this.storageService.updateUserInventory(m),this.userInventory=m,this.updateCounts()}initializeDefaultSorting(){this.partsSortOptions=[{field:"completion",direction:"asc"},{field:"color",direction:"asc"},{field:"partNumber",direction:"asc"}],this.minifigsSortOptions=[{field:"completion",direction:"asc"},{field:"figNumber",direction:"asc"},{field:"figName",direction:"asc"}],this.sparePartsSortOptions=[{field:"completion",direction:"asc"},{field:"color",direction:"asc"},{field:"partNumber",direction:"asc"}]}loadSortPreferences(){this.userInventory?.sortPreferences&&(this.userInventory.sortPreferences.parts.length>0&&(this.partsSortOptions=[...this.userInventory.sortPreferences.parts]),this.userInventory.sortPreferences.minifigs.length>0&&(this.minifigsSortOptions=[...this.userInventory.sortPreferences.minifigs]),this.userInventory.sortPreferences.spareParts&&this.userInventory.sortPreferences.spareParts.length>0&&(this.sparePartsSortOptions=[...this.userInventory.sortPreferences.spareParts]))}loadViewPreferences(){this.userInventory?.viewPreferences&&(this.partsViewType=this.userInventory.viewPreferences.parts||"tiles",this.minifigsViewType=this.userInventory.viewPreferences.minifigs||"tiles",this.sparePartsViewType=this.userInventory.viewPreferences.spareParts||"tiles")}saveSortPreferences(){if(!this.userInventory)return;let n=B(U({},this.userInventory),{sortPreferences:{parts:[...this.partsSortOptions],minifigs:[...this.minifigsSortOptions],spareParts:[...this.sparePartsSortOptions]},lastUpdated:Date.now()});this.userInventory=n,this.storageService.updateUserInventory(n)}saveViewPreferences(){if(!this.userInventory)return;let n=B(U({},this.userInventory),{viewPreferences:{parts:this.partsViewType,minifigs:this.minifigsViewType,spareParts:this.sparePartsViewType},lastUpdated:Date.now()});this.userInventory=n,this.storageService.updateUserInventory(n)}applySorting(){this.parts=this.sortParts([...this.parts]),this.minifigs=this.sortMinifigs([...this.minifigs]),this.spareParts=this.sortSpareParts([...this.spareParts]),this.filterParts()}sortParts(n){try{return n.sort((t,e)=>{for(let i of this.partsSortOptions){let d=this.comparePartsByField(t,e,i.field);if(d!==0)return i.direction==="asc"?d:-d}return 0})}catch(t){return console.error("Error sorting parts:",t),n}}sortMinifigs(n){try{return n.sort((t,e)=>{for(let i of this.minifigsSortOptions){let d=this.compareMinifigsByField(t,e,i.field);if(d!==0)return i.direction==="asc"?d:-d}return 0})}catch(t){return console.error("Error sorting minifigs:",t),n}}sortSpareParts(n){try{return n.sort((t,e)=>{for(let i of this.sparePartsSortOptions){let d=this.compareSparePartsByField(t,e,i.field);if(d!==0)return i.direction==="asc"?d:-d}return 0})}catch(t){return console.error("Error sorting spare parts:",t),n}}comparePartsByField(n,t,e){switch(e){case"completion":let i=n.quantityOwned>=n.quantityNeeded,d=t.quantityOwned>=t.quantityNeeded;return i===d?0:i?1:-1;case"color":let m=String(n.color?.name||""),p=String(t.color?.name||"");return m.localeCompare(p);case"partNumber":let f=String(n.part?.part_num||""),w=String(t.part?.part_num||"");return f.localeCompare(w);case"partName":let h=String(n.part?.name||""),x=String(t.part?.name||"");return h.localeCompare(x);case"elementId":let C=String(n.elementId||""),S=String(t.elementId||"");return C.localeCompare(S);case"quantityMissing":let k=Math.max(0,n.quantityNeeded-n.quantityOwned),V=Math.max(0,t.quantityNeeded-t.quantityOwned);return k-V;case"quantityNeeded":return n.quantityNeeded-t.quantityNeeded;case"setNumber":let E=String(n.setNum||""),N=String(t.setNum||"");return E.localeCompare(N);case"setName":let F=String(n.setName||""),M=String(t.setName||"");return F.localeCompare(M);default:return 0}}compareMinifigsByField(n,t,e){switch(e){case"completion":let i=n.quantityOwned>=n.quantityNeeded,d=t.quantityOwned>=t.quantityNeeded;return i===d?0:i?1:-1;case"figNumber":let m=String(n.minifig?.fig_num||""),p=String(t.minifig?.fig_num||"");return m.localeCompare(p);case"figName":let f=String(n.minifig?.name||""),w=String(t.minifig?.name||"");return f.localeCompare(w);case"quantityMissing":let h=Math.max(0,n.quantityNeeded-n.quantityOwned),x=Math.max(0,t.quantityNeeded-t.quantityOwned);return h-x;case"quantityNeeded":return n.quantityNeeded-t.quantityNeeded;case"setNumber":let C=String(n.setNum||""),S=String(t.setNum||"");return C.localeCompare(S);case"setName":let k=String(n.setName||""),V=String(t.setName||"");return k.localeCompare(V);default:return 0}}compareSparePartsByField(n,t,e){switch(e){case"completion":let i=n.quantityOwned>=n.quantityNeeded,d=t.quantityOwned>=t.quantityNeeded;return i===d?0:i?1:-1;case"color":let m=String(n.color?.name||""),p=String(t.color?.name||"");return m.localeCompare(p);case"partNumber":let f=String(n.part?.part_num||""),w=String(t.part?.part_num||"");return f.localeCompare(w);case"partName":let h=String(n.part?.name||""),x=String(t.part?.name||"");return h.localeCompare(x);case"elementId":let C=String(n.elementId||""),S=String(t.elementId||"");return C.localeCompare(S);case"quantityMissing":let k=Math.max(0,n.quantityNeeded-n.quantityOwned),V=Math.max(0,t.quantityNeeded-t.quantityOwned);return k-V;case"quantityNeeded":return n.quantityNeeded-t.quantityNeeded;case"setNumber":let E=String(n.setNum||""),N=String(t.setNum||"");return E.localeCompare(N);case"setName":let F=String(n.setName||""),M=String(t.setName||"");return F.localeCompare(M);default:return 0}}addSortOption(n){let t=n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions;if(t.length<3){let e=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields,i=t.map(m=>m.field),d=e.find(m=>!i.includes(m.value));if(d){let m={field:d.value,direction:"asc"};n==="parts"?this.partsSortOptions.push(m):n==="minifigs"?this.minifigsSortOptions.push(m):this.sparePartsSortOptions.push(m)}}}removeSortOption(n,t){n==="parts"?this.partsSortOptions.splice(t,1):n==="minifigs"?this.minifigsSortOptions.splice(t,1):this.sparePartsSortOptions.splice(t,1)}updateSortOption(n,t,e,i){let d=n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions;d[t]&&(d[t]={field:e,direction:i})}applySortChanges(){this.applySorting(),this.saveSortPreferences(),this.closeSortOptions()}resetToDefaultSort(){this.initializeDefaultSorting(),this.applySorting(),this.saveSortPreferences()}getAvailableFields(n,t){let e=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields;if(this.isMissingPartsMode){let p=[{value:"setNumber",label:"Set Number"},{value:"setName",label:"Set Name"}];e=[...e,...p]}let i=n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions,d=i[t]?.field,m=i.map((p,f)=>f!==t?p.field:null).filter(p=>p!==null);return e.filter(p=>{let f=p.value;return!m.includes(f)||f===d})}getAllFieldsForDropdown(n){let t=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields;if(this.isMissingPartsMode){let e=[{value:"setNumber",label:"Set Number"},{value:"setName",label:"Set Name"}];t=[...t,...e]}return t}isFieldDisabled(n,t,e){return(n==="parts"?this.partsSortOptions:n==="minifigs"?this.minifigsSortOptions:this.sparePartsSortOptions).some((d,m)=>m!==e&&d.field===t)}getFieldLabel(n,t){let e=n==="parts"?this.partSortFields:n==="minifigs"?this.minifigSortFields:this.partSortFields;if(this.isMissingPartsMode){let d=[{value:"setNumber",label:"Set Number"},{value:"setName",label:"Set Name"}];e=[...e,...d]}let i=e.find(d=>d.value===t);return i?i.label:t}togglePartsView(){this.partsViewType=this.partsViewType==="tiles"?"list":"tiles",this.saveViewPreferences()}toggleMinifigsView(){this.minifigsViewType=this.minifigsViewType==="tiles"?"list":"tiles",this.saveViewPreferences()}toggleSparePartsView(){this.sparePartsViewType=this.sparePartsViewType==="tiles"?"list":"tiles",this.saveViewPreferences()}openImageOverlay(n,t){this.overlayImageUrl=n,this.overlayImageAlt=t,this.showImageOverlay=!0,document.body.style.overflow="hidden"}closeImageOverlay(){this.showImageOverlay=!1,this.overlayImageUrl="",this.overlayImageAlt="",document.body.style.overflow="auto"}onOverlayClick(n){n.target===n.currentTarget&&this.closeImageOverlay()}getImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-32 h-32";case"4x":return"w-64 h-64";default:return"w-16 h-16"}}getListImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-16 h-16";case"4x":return"w-32 h-32";default:return"w-8 h-8"}}shouldUseVerticalLayout(){return this.globalSettings.imagePreviewSize==="4x"}getMinifigPartImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-16 h-16";case"4x":return"w-24 h-24";default:return"w-12 h-12"}}getMinifigPartListImageSizeClasses(){switch(this.globalSettings.imagePreviewSize){case"2x":return"w-12 h-12";case"4x":return"w-16 h-16";default:return"w-8 h-8"}}getLargeImageUrl(n){return n.includes("https://cdn.rebrickable.com/media/")&&!n.includes("https://cdn.rebrickable.com/media/thumbs/")?n.replace("https://cdn.rebrickable.com/media/","https://cdn.rebrickable.com/media/thumbs/")+"/800x800p.jpg?"+Date.now():n}onImageError(n){let t=n.target;t.style.display="none"}trackByPartId(n,t){return`${t.part.part_num}_${t.color.id}_${t.inventoryId||"default"}`}trackByMinifigId(n,t){return`${t.minifig.fig_num}_${t.inventoryId||"default"}`}trackBySparePartId(n,t){return`${t.inventoryPart.part_num}_${t.inventoryPart.color_id}`}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}scrollToBottom(){window.scrollTo(0,document.body.scrollHeight)}switchToTab(n){this.activeTab=n,this.showSortOptions=!1,setTimeout(()=>{this.updateSortPanelVisibility()},0)}toggleSortOptions(){this.showSortOptions=!this.showSortOptions,setTimeout(()=>{this.updateSortPanelVisibility()},0)}closeSortOptions(){this.showSortOptions=!1,setTimeout(()=>{this.updateSortPanelVisibility()},0)}updateSortPanelVisibility(){this.showPartsSortOptions=this.showSortOptions&&this.activeTab==="parts",this.showSparePartsSortOptions=this.showSortOptions&&this.activeTab==="spare-parts",this.showMinifigsSortOptions=this.showSortOptions&&this.activeTab==="minifigs"}migrateSparePartsData(n,t){if(!n.partsOwned)return n;let e=!1,i=U({},n.partsOwned);if(t.forEach(d=>{if(d.is_spare){let m=`${d.part_num}_${d.color_id}`,p=this.getPartStorageKey(d.part_num,d.color_id,!0);m in i&&!(p in i)&&(i[p]=i[m],e=!0)}}),e){let d=B(U({},n),{partsOwned:i,lastUpdated:Date.now()});return this.storageService.updateUserInventory(d),d}return n}preloadAllMinifigParts(){if(!this.minifigs||this.minifigs.length===0)return;let n=this.dataService.getCurrentInventories();this.minifigs.forEach(t=>{let e=t.minifig.fig_num;if(this.minifigPartsCache.has(e))return;let i=n.find(d=>d.set_num===e);i&&this.loadMinifigPartsAsync(e,i.id)})}loadStandardInventoryData(){this.route.paramMap.pipe(H(n=>{let t=n.get("id");return t?this.storageService.getState().pipe(J(e=>(this.globalSettings=U({},e.globalSettings),e.userInventories.find(d=>d.id===t)||null))):R(null)}),H(n=>n?(this.userInventory=n,this.updateCounts(),this.applySorting(),this.filterParts(),this.updateCanUndo(),this.userInventory.minifigPartsOwned||(this.userInventory.minifigPartsOwned={}),this.loadMinifigPartsState(),this.dataService.isDataLoaded().pipe(dt(t=>t===!0),H(()=>this.loadInventoryData(n)))):(this.loading=!1,R(null)))).subscribe({next:n=>{n&&(this.parts=n.parts,this.spareParts=n.spareParts,this.minifigs=n.minifigs,this.filteredParts=this.parts,this.set=n.set,this.loadSortPreferences(),this.loadViewPreferences(),this.applySorting(),this.updateCounts(),this.preloadAllMinifigParts()),this.loading=!1},error:n=>{console.error("Error loading inventory details:",n),this.loading=!1}})}loadMissingPartsData(){this.storageService.getState().pipe(H(n=>(this.globalSettings=U({},n.globalSettings),this.userInventories=n.userInventories,this.userInventories.length===0?(this.loading=!1,R(null)):this.dataService.isDataLoaded().pipe(dt(t=>t===!0),H(()=>this.loadAllMissingItemsData()))))).subscribe({next:n=>{n&&(this.parts=n.parts,this.spareParts=n.spareParts,this.minifigs=n.minifigs,this.filteredParts=this.parts,this.loadDefaultPreferencesForMissingMode(),this.applySorting(),this.updateCounts(),this.loadMinifigPartsState(),this.preloadAllMinifigParts()),this.loading=!1},error:n=>{console.error("Error loading missing parts data:",n),this.loading=!1}})}loadInventoryData(n){let t=this.dataService.getCurrentInventories(),e=t.filter(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()),i=this.dataService.getCurrentInventories().find(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()&&Number(h.version)===Number(n.version));if(!i)return console.error("InventoryDetailComponent: No inventory found for",n.set_num,"version",n.version),R(null);this.inventory=i;let d=this.dataService.getCurrentSets().find(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()),m=this.dataService.getCurrentInventoryParts(),p=t.filter(h=>h.set_num&&h.set_num.trim()===n.set_num.trim()),f=i,w=m.filter(h=>h.inventory_id===i.id).length;return w===0&&(p.forEach(h=>{let x=m.filter(C=>C.inventory_id===h.id).length;x>w&&(w=x,f=h)}),f.id!==i.id&&(console.log(`Switching from version ${i.version} (${i.id}) to version ${f.version} (${f.id}) which has ${w} parts`),this.inventory=f)),rt({inventoryParts:this.dataService.getInventoryPartsFromCache(f.id),inventoryMinifigs:this.dataService.getInventoryMinifigsFromCache(f.id)}).pipe(J(h=>{let{inventoryParts:x,inventoryMinifigs:C}=h;n=this.migrateSparePartsData(n,x);let S=this.dataService.getCurrentParts(),k=this.dataService.getCurrentColors(),V=this.dataService.getCurrentElements(),E=this.dataService.getCurrentMinifigs(),N=new Map(S.map(b=>[b.part_num,b])),F=new Map(k.map(b=>[b.id,b])),M=new Map(V.map(b=>[`${b.part_num}_${b.color_id}`,b.element_id])),L=new Map(E.map(b=>[b.fig_num,b])),A=[],z=[];for(let b of x){let K=N.get(b.part_num),nt=F.get(b.color_id);if(K&&nt){let kt=this.getPartStorageKey(b.part_num,b.color_id,b.is_spare),Vt=n.partsOwned[kt]||0,Nt=M.get(`${b.part_num}_${b.color_id}`),_t={inventoryPart:b,part:K,color:nt,imageUrl:b.img_url,quantityNeeded:b.quantity,quantityOwned:Vt,elementId:Nt,setName:d?.name,setNum:d?.set_num,inventoryId:i.id.toString()};b.is_spare===!0?z.push(_t):A.push(_t)}}let Y=[];for(let b of C){let K=L.get(b.fig_num);if(K){let nt=n.minifigsOwned[b.fig_num]||0;Y.push({inventoryMinifig:b,minifig:K,imageUrl:K.img_url,quantityNeeded:b.quantity,quantityOwned:nt,setName:d?.name,setNum:d?.set_num,inventoryId:i.id.toString()})}}let it=new Set;if([...A,...z].forEach(b=>{it.add(b.color.id)}),d){let b=this.dataService.getCurrentThemes();this.theme=b.find(K=>K.id===d.theme_id)||null}return this.uniqueColorsCount=it.size,{parts:A,spareParts:z,minifigs:Y,set:d||null}}))}loadAllMissingItemsData(){let n=this.dataService.getCurrentInventories(),t=this.dataService.getCurrentParts(),e=this.dataService.getCurrentColors(),i=this.dataService.getCurrentElements(),d=this.dataService.getCurrentMinifigs(),m=new Map(t.map(x=>[x.part_num,x])),p=new Map(e.map(x=>[x.id,x])),f=new Map(i.map(x=>[`${x.part_num}_${x.color_id}`,x.element_id])),w=new Map(d.map(x=>[x.fig_num,x])),h=this.userInventories.map(x=>{let C=n.find(S=>S.set_num===x.set_num&&Number(S.version)===Number(x.version));return C?rt({inventoryParts:this.dataService.getInventoryPartsFromCache(C.id),inventoryMinifigs:this.dataService.getInventoryMinifigsFromCache(C.id)}).pipe(J(S=>{let{inventoryParts:k,inventoryMinifigs:V}=S,E=[],N=[];for(let M of k){let L=this.getPartStorageKey(M.part_num,M.color_id,M.is_spare),A=x.partsOwned[L]||0;if(A<M.quantity){let z=m.get(M.part_num),Y=p.get(M.color_id);if(z&&Y){let it=f.get(`${M.part_num}_${M.color_id}`),b={inventoryPart:M,part:z,color:Y,imageUrl:M.img_url,quantityNeeded:M.quantity,quantityOwned:A,elementId:it,setName:x.name,setNum:x.set_num,inventoryId:x.id};M.is_spare===!0?N.push(b):E.push(b)}}}let F=[];for(let M of V){let L=x.minifigsOwned[M.fig_num]||0;if(L<M.quantity){let A=w.get(M.fig_num);A&&F.push({inventoryMinifig:M,minifig:A,imageUrl:A.img_url,quantityNeeded:M.quantity,quantityOwned:L,setName:x.name,setNum:x.set_num,inventoryId:x.id})}}return{parts:E,spareParts:N,minifigs:F}})):R({parts:[],spareParts:[],minifigs:[]})});return rt(h).pipe(J(x=>{let C=[],S=[],k=[];return x.forEach(({parts:V,spareParts:E,minifigs:N})=>{C.push(...V),S.push(...E),k.push(...N)}),{parts:C,spareParts:S,minifigs:k,set:null}}))}loadDefaultPreferencesForMissingMode(){this.initializeDefaultSorting(),this.partsViewType="tiles",this.minifigsViewType="tiles",this.sparePartsViewType="tiles"}ngOnInit(){return lt(this,null,function*(){try{let n=this.route.snapshot,t=n.paramMap.get("id");this.isMissingPartsMode=n.url.some(e=>e.path==="missing-parts"),setTimeout(()=>{this.updateSortPanelVisibility()},0),this.isMissingPartsMode?yield this.loadMissingPartsData():t&&(yield this.loadStandardInventoryData()),this.setupKeyboardListeners()}catch(n){console.error("Error in ngOnInit:",n)}finally{this.loading=!1}})}setupKeyboardListeners(){document.addEventListener("keydown",this.handleKeyDown.bind(this))}ngOnDestroy(){document.removeEventListener("keydown",this.handleKeyDown.bind(this))}handleKeyDown(n){n.key==="z"&&(n.metaKey||n.ctrlKey)&&!n.shiftKey&&(n.preventDefault(),this.performUndo())}addUndoAction(n){this.userInventory&&(this.userInventory.undoHistory||(this.userInventory.undoHistory=[]),this.userInventory.undoHistory.unshift(n),this.userInventory.undoHistory.length>this.maxUndoHistory&&(this.userInventory.undoHistory=this.userInventory.undoHistory.slice(0,this.maxUndoHistory)),this.updateCanUndo(),this.saveUserInventory())}updateCanUndo(){this.canUndo=this.userInventory?.undoHistory&&this.userInventory.undoHistory.length>0||!1}performUndo(){if(!this.userInventory?.undoHistory||this.userInventory.undoHistory.length===0)return;let n=this.userInventory.undoHistory.shift();n&&(n.type==="part"?this.updatePartQuantityInternal(n.key,n.previousQuantity):n.type==="minifig"?this.updateMinifigQuantityInternal(n.key,n.previousQuantity):n.type==="minifig-part"&&this.updateMinifigPartQuantityInternal(n.key,n.previousQuantity),this.updateCanUndo(),this.saveUserInventory(),this.showUndoNotificationMessage(`Undone: ${n.description}`))}showUndoNotificationMessage(n){this.undoNotificationMessage=n,this.showUndoNotification=!0,setTimeout(()=>{this.showUndoNotification=!1},3e3)}saveUserInventory(){this.userInventory&&this.storageService.updateUserInventory(this.userInventory)}updatePartQuantityInternal(n,t){if(!this.userInventory)return;this.userInventory.partsOwned[n]=t;let e=this.parts.find(d=>this.getPartStorageKey(d.inventoryPart.part_num,d.inventoryPart.color_id,d.inventoryPart.is_spare)===n);e&&(e.quantityOwned=t);let i=this.spareParts.find(d=>this.getPartStorageKey(d.inventoryPart.part_num,d.inventoryPart.color_id,d.inventoryPart.is_spare)===n);i&&(i.quantityOwned=t),this.updateCounts(),this.filterParts()}updateMinifigQuantityInternal(n,t){if(!this.userInventory)return;this.userInventory.minifigsOwned[n]=t;let e=this.minifigs.find(i=>i.inventoryMinifig.fig_num===n);e&&(e.quantityOwned=t),this.updateCounts()}updateMinifigPartQuantityInternal(n,t){if(!this.userInventory)return;this.userInventory.minifigPartsOwned[n]=t;let e=n.split("_");if(e.length>=4){let i=e[1],d=e[2],m=Number(e[3]),p=this.minifigPartsCache.get(i);if(p){let f=p.find(w=>w.inventoryPart.part_num===d&&w.inventoryPart.color_id===m);f&&(f.quantityOwned=t,this.minifigPartsCache.set(i,this.sortMinifigParts([...p])))}}this.updateCounts()}static \u0275fac=function(t){return new(t||o)(Z(wt),Z(qt),Z(St),Z(vt))};static \u0275cmp=ct({type:o,selectors:[["app-inventory-detail"]],decls:18,vars:9,consts:[["noPartsFound",""],["noSpareParts",""],["noMinifigs",""],[2,"width","100%","max-width","none","display","block"],["class","flex items-center justify-center py-16 px-4 min-h-screen bg-gray-50",4,"ngIf"],["class","bg-white shadow-md rounded-lg p-6 max-w-4xl mx-auto my-8",4,"ngIf"],["class","bg-white py-8 w-full min-h-screen","style","min-width: 600px;",4,"ngIf"],["class","bg-white py-8 w-full min-h-screen","style","min-width: 600px; width: 100%; max-width: none;",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",3,"click",4,"ngIf"],[1,"fixed","bottom-6","right-6","flex","flex-col","space-y-3","z-40"],["title","Scroll to top",1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","duration-200","hover:scale-110",3,"click"],[1,"text-lg"],["title","Scroll to bottom",1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","duration-200","hover:scale-110",3,"click"],[1,"relative"],["class","w-12 h-12 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-100 disabled:hover:scale-100",3,"disabled","title","click",4,"ngIf"],["class","absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",4,"ngIf"],["class","fixed top-20 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",4,"ngIf"],[1,"flex","items-center","justify-center","py-16","px-4","min-h-screen","bg-gray-50"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto","mb-4"],["class","text-gray-600 mb-2",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-gray-400","mt-2"],[1,"text-gray-600","mb-2"],[1,"bg-white","shadow-md","rounded-lg","p-6","max-w-4xl","mx-auto","my-8"],[1,"text-2xl","font-bold","text-gray-800","mb-4"],[1,"text-gray-600","mb-6"],["routerLink","/sets",1,"bg-blue-600","text-white","px-4","py-2","rounded-md","hover:bg-blue-700","transition"],[1,"bg-white","py-8","w-full","min-h-screen",2,"min-width","600px"],[1,"px-1","sm:px-2","text-center","py-8"],[1,"text-3xl","font-bold","text-gray-800","mb-4"],[1,"text-lg","text-gray-600","mb-4"],[1,"bg-white","py-8","w-full","min-h-screen",2,"min-width","600px","width","100%","max-width","none"],[1,"px-1","sm:px-2"],["class","mb-6 flex flex-col md:flex-row md:items-center md:justify-between",4,"ngIf"],["class","mb-6",4,"ngIf"],[1,"border-b","border-gray-200","mb-6"],[1,"flex","space-x-8"],[1,"py-4","px-1","border-b-2","font-medium","text-sm","focus:outline-none",3,"click"],[4,"ngIf"],["class","ml-1 text-red-500",4,"ngIf"],[1,"mb-6","flex","flex-col","md:flex-row","md:items-center","md:justify-between"],[1,"flex","items-start","space-x-4"],["class","flex-shrink-0",4,"ngIf"],[1,"flex-1"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600","mt-1"],[1,"flex","flex-wrap","gap-4","mt-2","text-sm","text-gray-600"],[1,"text-gray-500","text-sm","mt-1"],[1,"mt-4"],[1,"mt-4","md:mt-0","flex","flex-col","md:flex-row","md:items-center","space-y-2","md:space-y-0","md:space-x-4"],["target","_blank","rel","noopener noreferrer",1,"text-green-600","hover:underline","flex","items-center",3,"href"],[1,"mr-1"],["routerLink","/sets",1,"text-blue-600","hover:underline"],[1,"flex-shrink-0"],[1,"w-24","h-24","bg-gray-100","rounded-lg","overflow-hidden","flex","items-center","justify-center","cursor-pointer",3,"click"],[1,"w-full","h-full","object-contain","hover:opacity-80","transition-opacity",3,"error","src","alt"],[1,"text-center","mt-1"],[1,"text-xs","text-gray-400"],["href","https://rebrickable.com","target","_blank","rel","noopener noreferrer",1,"text-blue-500","hover:text-blue-400"],[1,"flex","justify-between","text-sm","text-gray-600","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-3"],[1,"h-3","rounded-full","transition-all","duration-300"],[1,"space-y-3"],[1,"flex","justify-between","text-sm","text-gray-500","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"h-2","rounded-full","transition-all","duration-300"],[1,"mb-6"],[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between"],[1,"text-3xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600"],[1,"text-sm","text-gray-500","mt-2"],[1,"mt-4","md:mt-0"],[1,"ml-1","text-red-500"],[1,"flex","flex-col","md:flex-row","md:items-center","mb-6","space-y-4","md:space-y-0","md:space-x-4"],["type","text","placeholder","Search parts...",1,"px-4","py-2","border","rounded-md","w-full","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","space-x-2"],[1,"flex","border","rounded-md","overflow-hidden"],[1,"px-3","py-2","text-sm","transition",3,"click"],[1,"bg-gray-600","text-white","px-3","py-2","rounded-md","hover:bg-gray-700","transition","text-sm",3,"click"],[1,"bg-green-600","text-white","px-3","py-2","rounded-md","hover:bg-green-700","transition","text-sm",3,"click"],[1,"bg-red-600","text-white","px-3","py-2","rounded-md","hover:bg-red-700","transition","text-sm",3,"click"],["class","bg-gray-50 border rounded-lg p-4 mb-6",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"bg-gray-50","border","rounded-lg","p-4","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-medium","text-gray-800"],[1,"text-sm","text-blue-600","hover:underline",3,"click"],["class","flex items-center space-x-3",4,"ngFor","ngForOf"],["class","flex justify-start",4,"ngIf"],[1,"flex","justify-end","space-x-2","mt-4"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","text-sm",3,"click"],[1,"bg-blue-600","text-white","px-4","py-2","rounded","hover:bg-blue-700","transition","text-sm",3,"click"],[1,"flex","items-center","space-x-3"],[1,"text-sm","font-medium","text-gray-700","w-8"],[1,"flex-1","px-3","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm",3,"ngModelChange","ngModel"],[3,"value","disabled",4,"ngFor","ngForOf"],[1,"px-3","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm",3,"change","value"],["value","asc"],["value","desc"],["class","text-red-600 hover:text-red-800 text-sm px-2 py-1",3,"click",4,"ngIf"],[3,"value","disabled"],[1,"text-red-600","hover:text-red-800","text-sm","px-2","py-1",3,"click"],[1,"flex","justify-start"],[1,"text-blue-600","hover:text-blue-800","text-sm",3,"click"],["class","grid gap-2 sm:gap-3 md:gap-4","style","grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));",4,"ngIf"],["class","bg-white border rounded-lg overflow-hidden w-full",4,"ngIf"],[1,"grid","gap-2","sm:gap-3","md:gap-4",2,"grid-template-columns","repeat(auto-fill, minmax(240px, 1fr))"],["class","border rounded-lg overflow-hidden",3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border","rounded-lg","overflow-hidden"],[1,"p-4"],[3,"click"],[1,"w-full","h-full","object-contain","hover:opacity-80","transition-opacity",3,"src","alt"],[1,"font-medium","text-gray-800"],[1,"text-sm","text-gray-600"],["class","text-sm text-gray-600",4,"ngIf"],["class","text-sm text-blue-600 font-medium",4,"ngIf"],[1,"mb-3"],[1,"flex","items-center","space-x-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","items-center","space-x-1"],[1,"w-8","h-8","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-sm","font-bold",3,"click","disabled"],["type","number",1,"w-16","px-2","py-1","text-center","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm",3,"input","focus","value","min","max"],[1,"flex","items-center","justify-center","space-x-2","mt-2"],["title","Mark as complete",1,"w-8","h-6","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-8","h-6","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[1,"mt-3","text-center"],[1,"text-sm","font-medium"],[1,"text-sm","text-blue-600","font-medium"],[1,"bg-white","border","rounded-lg","overflow-hidden","w-full"],[1,"overflow-x-auto"],[1,"w-full","divide-y","divide-gray-200","table-auto"],[1,"bg-gray-50"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-48"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-28"],["class","px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider w-32",4,"ngIf"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-32"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-36"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-24"],[1,"bg-white","divide-y","divide-gray-200"],[3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"px-2","py-2","w-48"],[1,"flex","items-center"],[1,"min-w-0","flex-1"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-2","py-2","whitespace-nowrap","w-28"],[1,"text-sm","text-gray-900","truncate"],["class","px-2 py-2 whitespace-nowrap w-32",4,"ngIf"],[1,"px-2","py-2","whitespace-nowrap","w-32"],[1,"w-full","bg-gray-200","rounded-full","h-1.5","mb-1"],[1,"h-1.5","rounded-full","transition-all","duration-300"],[1,"text-sm","text-gray-500","text-center"],[1,"px-2","py-2","whitespace-nowrap","w-36"],[1,"flex","items-center","justify-center","space-x-1"],[1,"w-6","h-6","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-sm","font-bold","border","flex-shrink-0",3,"click","disabled"],["type","number",1,"w-10","px-1","py-0.5","text-center","border","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-sm","flex-shrink-0",3,"input","focus","value","min","max"],[1,"px-2","py-2","whitespace-nowrap","w-24","text-center"],["title","Mark as complete",1,"w-6","h-5","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-6","h-5","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[1,"text-center","py-8","bg-gray-50","rounded-lg"],[1,"text-lg","text-gray-600"],["class","mt-4 text-blue-600 hover:underline",3,"click",4,"ngIf"],[1,"mt-4","text-blue-600","hover:underline",3,"click"],[1,"text-sm","text-orange-600"],[1,"px-2","py-2","text-left","text-sm","font-medium","text-gray-500","uppercase","tracking-wider","w-20"],[1,"mt-4","text-center"],[1,"bg-blue-600","text-white","px-3","py-2","rounded-md","hover:bg-blue-700","transition","text-sm","flex","items-center","mx-auto",3,"click"],["class","mr-1",4,"ngIf"],["class","border-t border-gray-200 mt-2",4,"ngIf"],[1,"border-t","border-gray-200","mt-2"],[1,"p-4","bg-gray-50"],[1,"text-sm","font-medium","text-gray-800","mb-3"],[1,"grid","gap-2",2,"grid-template-columns","repeat(auto-fill, minmax(180px, 1fr))"],["class","border rounded-lg overflow-hidden bg-white",3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf"],[1,"border","rounded-lg","overflow-hidden","bg-white"],[1,"p-3"],[1,"flex","items-start","mb-3"],[1,"flex-1","min-w-0"],[1,"text-xs","font-medium","text-gray-800","truncate"],[1,"text-xs","text-gray-600","truncate"],[1,"mb-2"],[1,"flex","justify-between","text-xs","text-gray-600","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"w-6","h-6","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-xs","font-bold",3,"click","disabled"],["type","number",1,"w-12","px-1","py-0.5","text-center","border","rounded","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-xs",3,"input","focus","value","min","max"],[1,"mt-2","text-center"],[1,"text-xs","font-medium"],[1,"flex","items-center","justify-center","space-x-1","mt-2"],["title","Mark as complete",1,"w-6","h-4","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-6","h-4","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"px-2","py-2","whitespace-nowrap","w-24"],[1,"text-sm","text-gray-900"],[1,"bg-blue-600","text-white","px-2","py-1","rounded","text-xs","hover:bg-blue-700","transition","flex","items-center",3,"click"],["class","bg-gray-50",4,"ngIf"],[1,"px-2","py-4"],[1,"pl-6"],[1,"bg-white","border","rounded","overflow-hidden"],[1,"w-full","divide-y","divide-gray-200"],[1,"bg-gray-100"],[1,"px-2","py-2","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[3,"bg-green-50","bg-yellow-50","bg-red-50",4,"ngFor","ngForOf"],[1,"px-2","py-2"],[1,"text-xs","font-medium","text-gray-900","truncate"],[1,"text-xs","text-gray-500","truncate"],[1,"px-2","py-2","whitespace-nowrap"],[1,"text-xs","text-gray-900","truncate"],[1,"w-full","bg-gray-200","rounded-full","h-1","mb-1"],[1,"h-1","rounded-full","transition-all","duration-300"],[1,"text-xs","text-gray-500","text-center"],[1,"w-5","h-5","rounded-full","bg-gray-200","hover:bg-gray-300","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-xs","font-bold",3,"click","disabled"],["type","number",1,"w-8","px-1","py-0.5","text-center","border","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-xs",3,"input","focus","value","min","max"],[1,"px-2","py-2","whitespace-nowrap","text-center"],["title","Mark as complete",1,"w-5","h-4","rounded","bg-green-500","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],["title","Clear quantity",1,"w-5","h-4","rounded","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","justify-center","text-white","text-xs","font-bold",3,"click","disabled"],[1,"fixed","inset-0","bg-black","bg-opacity-75","flex","items-center","justify-center","z-50",3,"click"],[1,"relative","max-w-4xl","max-h-4xl","p-4"],[1,"absolute","top-2","right-2","text-white","hover:text-gray-300","text-2xl","font-bold","z-10","bg-black","bg-opacity-50","rounded-full","w-8","h-8","flex","items-center","justify-center",3,"click"],[1,"max-w-full","max-h-full","object-contain",2,"max-width","800px","max-height","800px",3,"src","alt"],[1,"absolute","bottom-2","left-2","right-2","bg-black","bg-opacity-75","text-white","text-xs","p-2","rounded"],["href","https://rebrickable.com","target","_blank","rel","noopener noreferrer",1,"text-blue-300","hover:text-blue-100","underline"],[1,"w-12","h-12","bg-orange-600","hover:bg-orange-700","disabled:bg-gray-400","disabled:cursor-not-allowed","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","duration-200","hover:scale-100","disabled:hover:scale-100",3,"click","disabled","title"],[1,"absolute","-top-1","-right-1","bg-red-500","text-white","text-xs","rounded-full","w-5","h-5","flex","items-center","justify-center","font-bold"],[1,"fixed","top-20","left-1/2","transform","-translate-x-1/2","bg-green-600","text-white","px-6","py-3","rounded-lg","shadow-lg","z-50","transition-all","duration-300"]],template:function(t,e){t&1&&(r(0,"div",3),y(1,Ft,9,2,"div",4)(2,At,7,0,"div",5)(3,Qt,8,0,"div",6)(4,jt,8,0,"div",6)(5,wi,21,32,"div",7)(6,bi,10,2,"div",8),r(7,"div",9)(8,"button",10),g("click",function(){return e.scrollToTop()}),r(9,"span",11),l(10,"\u2191"),a()(),r(11,"button",12),g("click",function(){return e.scrollToBottom()}),r(12,"span",11),l(13,"\u2193"),a()(),r(14,"div",13),y(15,Si,3,2,"button",14)(16,Ii,2,1,"span",15),a()(),y(17,Pi,6,1,"div",16),a()),t&2&&(s(),c("ngIf",e.loading),s(),c("ngIf",!e.loading&&!e.userInventory&&!e.isMissingPartsMode),s(),c("ngIf",!e.loading&&e.isMissingPartsMode&&e.userInventories.length===0),s(),c("ngIf",!e.loading&&e.isMissingPartsMode&&e.userInventories.length>0&&e.parts.length===0&&e.spareParts.length===0&&e.minifigs.length===0),s(),c("ngIf",!e.loading&&(!e.isMissingPartsMode&&e.userInventory||e.isMissingPartsMode&&e.userInventories.length>0&&(e.parts.length>0||e.spareParts.length>0||e.minifigs.length>0))),s(),c("ngIf",e.showImageOverlay),s(9),c("ngIf",!e.isMissingPartsMode),s(),c("ngIf",!e.isMissingPartsMode&&e.canUndo&&((e.userInventory==null||e.userInventory.undoHistory==null?null:e.userInventory.undoHistory.length)||0)>0),s(),c("ngIf",e.showUndoNotification))},dependencies:[ht,gt,ft,xt,yt,bt,Dt,Mt,Et,It,Ot,Pt,Ct],encapsulation:2})};export{Tt as InventoryDetailComponent};
